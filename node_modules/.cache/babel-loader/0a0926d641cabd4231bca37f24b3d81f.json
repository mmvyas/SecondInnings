{"ast":null,"code":"// Modified by Ilya Boyandin from the original version:\n// https://online.tableau.com/javascripts/api/tableau-2.0.0.js\n//\n//! tableau-2.0.0.js\n//\nvar tableauSoftware = {};\n\n(function () {\n  // (function() {\n  ////////////////////////////////////////////////////////////////////////////////\n  // Utility methods (generated via Script.IsNull, etc.)\n  ////////////////////////////////////////////////////////////////////////////////\n  var ss = {\n    version: '0.7.4.0',\n    isUndefined: function isUndefined(o) {\n      return o === undefined;\n    },\n    isNull: function isNull(o) {\n      return o === null;\n    },\n    isNullOrUndefined: function isNullOrUndefined(o) {\n      return o === null || o === undefined;\n    },\n    isValue: function isValue(o) {\n      return o !== null && o !== undefined;\n    }\n  }; // If the browser does not support Object.keys this alternative\n  // function returns the same list without using the keys method.\n  // This code was found in mscorlib.js (BUGZID:116352)\n\n  if (!Object.keys) {\n    Object.keys = function Object$keys(d) {\n      var keys = [];\n\n      for (var key in d) {\n        keys.push(key);\n      }\n\n      return keys;\n    };\n  } ////////////////////////////////////////////////////////////////////////////////\n  // Type System Implementation\n  ////////////////////////////////////////////////////////////////////////////////\n\n\n  var Type = Function;\n  var originalRegistrationFunctions = {\n    registerNamespace: {\n      isPrototype: false,\n      func: Type.registerNamespace\n    },\n    registerInterface: {\n      isPrototype: true,\n      func: Type.prototype.registerInterface\n    },\n    registerClass: {\n      isPrototype: true,\n      func: Type.prototype.registerClass\n    },\n    registerEnum: {\n      isPrototype: true,\n      func: Type.prototype.registerEnum\n    }\n  };\n  var tab = {};\n  var tabBootstrap = {};\n\n  Type.registerNamespace = function (name) {};\n\n  Type.prototype.registerInterface = function (name) {};\n\n  Type.prototype.registerEnum = function (name, flags) {\n    for (var field in this.prototype) {\n      this[field] = this.prototype[field];\n    }\n  };\n\n  Type.prototype.registerClass = function (name, baseType, interfaceType) {\n    var that = this;\n    this.prototype.constructor = this;\n    this.__baseType = baseType || Object;\n\n    if (baseType) {\n      this.__basePrototypePending = true;\n\n      this.__setupBase = function () {\n        Type$setupBase(that);\n      };\n\n      this.initializeBase = function (instance, args) {\n        Type$initializeBase(that, instance, args);\n      };\n\n      this.callBaseMethod = function (instance, name, args) {\n        Type$callBaseMethod(that, instance, name, args);\n      };\n    }\n  };\n\n  function Type$setupBase(that) {\n    if (that.__basePrototypePending) {\n      var baseType = that.__baseType;\n\n      if (baseType.__basePrototypePending) {\n        baseType.__setupBase();\n      }\n\n      for (var memberName in baseType.prototype) {\n        var memberValue = baseType.prototype[memberName];\n\n        if (!that.prototype[memberName]) {\n          that.prototype[memberName] = memberValue;\n        }\n      }\n\n      delete that.__basePrototypePending;\n      delete that.__setupBase;\n    }\n  }\n\n  function Type$initializeBase(that, instance, args) {\n    if (that.__basePrototypePending) {\n      that.__setupBase();\n    }\n\n    if (!args) {\n      that.__baseType.apply(instance);\n    } else {\n      that.__baseType.apply(instance, args);\n    }\n  }\n\n  function Type$callBaseMethod(that, instance, name, args) {\n    var baseMethod = that.__baseType.prototype[name];\n\n    if (!args) {\n      return baseMethod.apply(instance);\n    } else {\n      return baseMethod.apply(instance, args);\n    }\n  } // Restore the original functions on the Type (Function) object so that we\n  // don't pollute the global namespace.\n\n\n  function restoreTypeSystem() {\n    for (var regFuncName in originalRegistrationFunctions) {\n      if (!originalRegistrationFunctions.hasOwnProperty(regFuncName)) {\n        continue;\n      }\n\n      var original = originalRegistrationFunctions[regFuncName];\n      var typeOrPrototype = original.isPrototype ? Type.prototype : Type;\n\n      if (original.func) {\n        typeOrPrototype[regFuncName] = original.func;\n      } else {\n        delete typeOrPrototype[regFuncName];\n      }\n    }\n  } ////////////////////////////////////////////////////////////////////////////////\n  // Delegate\n  ////////////////////////////////////////////////////////////////////////////////\n\n\n  ss.Delegate = function Delegate$() {};\n\n  ss.Delegate.registerClass('Delegate');\n\n  ss.Delegate.empty = function () {};\n\n  ss.Delegate._contains = function Delegate$_contains(targets, object, method) {\n    for (var i = 0; i < targets.length; i += 2) {\n      if (targets[i] === object && targets[i + 1] === method) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  ss.Delegate._create = function Delegate$_create(targets) {\n    var delegate = function delegate() {\n      if (targets.length == 2) {\n        return targets[1].apply(targets[0], arguments);\n      } else {\n        var clone = targets.concat();\n\n        for (var i = 0; i < clone.length; i += 2) {\n          if (ss.Delegate._contains(targets, clone[i], clone[i + 1])) {\n            clone[i + 1].apply(clone[i], arguments);\n          }\n        }\n\n        return null;\n      }\n    };\n\n    delegate._targets = targets;\n    return delegate;\n  };\n\n  ss.Delegate.create = function Delegate$create(object, method) {\n    if (!object) {\n      return method;\n    }\n\n    return ss.Delegate._create([object, method]);\n  };\n\n  ss.Delegate.combine = function Delegate$combine(delegate1, delegate2) {\n    if (!delegate1) {\n      if (!delegate2._targets) {\n        return ss.Delegate.create(null, delegate2);\n      }\n\n      return delegate2;\n    }\n\n    if (!delegate2) {\n      if (!delegate1._targets) {\n        return ss.Delegate.create(null, delegate1);\n      }\n\n      return delegate1;\n    }\n\n    var targets1 = delegate1._targets ? delegate1._targets : [null, delegate1];\n    var targets2 = delegate2._targets ? delegate2._targets : [null, delegate2];\n    return ss.Delegate._create(targets1.concat(targets2));\n  };\n\n  ss.Delegate.remove = function Delegate$remove(delegate1, delegate2) {\n    if (!delegate1 || delegate1 === delegate2) {\n      return null;\n    }\n\n    if (!delegate2) {\n      return delegate1;\n    }\n\n    var targets = delegate1._targets;\n    var object = null;\n    var method;\n\n    if (delegate2._targets) {\n      object = delegate2._targets[0];\n      method = delegate2._targets[1];\n    } else {\n      method = delegate2;\n    }\n\n    for (var i = 0; i < targets.length; i += 2) {\n      if (targets[i] === object && targets[i + 1] === method) {\n        if (targets.length == 2) {\n          return null;\n        }\n\n        targets.splice(i, 2);\n        return ss.Delegate._create(targets);\n      }\n    }\n\n    return delegate1;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // IEnumerator\n\n\n  ss.IEnumerator = function IEnumerator$() {};\n\n  ss.IEnumerator.prototype = {\n    get_current: null,\n    moveNext: null,\n    reset: null\n  };\n\n  ss.IEnumerator.getEnumerator = function ss_IEnumerator$getEnumerator(enumerable) {\n    if (enumerable) {\n      return enumerable.getEnumerator ? enumerable.getEnumerator() : new ss.ArrayEnumerator(enumerable);\n    }\n\n    return null;\n  }; // ss.IEnumerator.registerInterface('IEnumerator');\n  ////////////////////////////////////////////////////////////////////////////////\n  // IEnumerable\n\n\n  ss.IEnumerable = function IEnumerable$() {};\n\n  ss.IEnumerable.prototype = {\n    getEnumerator: null\n  }; // ss.IEnumerable.registerInterface('IEnumerable');\n  ////////////////////////////////////////////////////////////////////////////////\n  // ArrayEnumerator\n\n  ss.ArrayEnumerator = function ArrayEnumerator$(array) {\n    this._array = array;\n    this._index = -1;\n    this.current = null;\n  };\n\n  ss.ArrayEnumerator.prototype = {\n    moveNext: function ArrayEnumerator$moveNext() {\n      this._index++;\n      this.current = this._array[this._index];\n      return this._index < this._array.length;\n    },\n    reset: function ArrayEnumerator$reset() {\n      this._index = -1;\n      this.current = null;\n    }\n  }; // ss.ArrayEnumerator.registerClass('ArrayEnumerator', null, ss.IEnumerator);\n  ////////////////////////////////////////////////////////////////////////////////\n  // IDisposable\n\n  ss.IDisposable = function IDisposable$() {};\n\n  ss.IDisposable.prototype = {\n    dispose: null\n  }; // ss.IDisposable.registerInterface('IDisposable');\n  ////////////////////////////////////////////////////////////////////////////////\n  // StringBuilder\n\n  ss.StringBuilder = function StringBuilder$(s) {\n    this._parts = !ss.isNullOrUndefined(s) ? [s] : [];\n    this.isEmpty = this._parts.length == 0;\n  };\n\n  ss.StringBuilder.prototype = {\n    append: function StringBuilder$append(s) {\n      if (!ss.isNullOrUndefined(s)) {\n        //this._parts.add(s);\n        this._parts.push(s);\n\n        this.isEmpty = false;\n      }\n\n      return this;\n    },\n    appendLine: function StringBuilder$appendLine(s) {\n      this.append(s);\n      this.append('\\r\\n');\n      this.isEmpty = false;\n      return this;\n    },\n    clear: function StringBuilder$clear() {\n      this._parts = [];\n      this.isEmpty = true;\n    },\n    toString: function StringBuilder$toString(s) {\n      return this._parts.join(s || '');\n    }\n  };\n  ss.StringBuilder.registerClass('StringBuilder'); ////////////////////////////////////////////////////////////////////////////////\n  // EventArgs\n\n  ss.EventArgs = function EventArgs$() {};\n\n  ss.EventArgs.registerClass('EventArgs');\n  ss.EventArgs.Empty = new ss.EventArgs(); ////////////////////////////////////////////////////////////////////////////////\n  // CancelEventArgs\n\n  ss.CancelEventArgs = function CancelEventArgs$() {\n    ss.CancelEventArgs.initializeBase(this);\n    this.cancel = false;\n  };\n\n  ss.CancelEventArgs.registerClass('CancelEventArgs', ss.EventArgs); ////////////////////////////////////////////////////////////////////////////////\n  // Tuple\n\n  ss.Tuple = function (first, second, third) {\n    this.first = first;\n    this.second = second;\n\n    if (arguments.length == 3) {\n      this.third = third;\n    }\n  };\n\n  ss.Tuple.registerClass('Tuple'); //})();\n  //! tabcoreslim.debug.js\n  //\n  // (function() {\n\n  Type.registerNamespace('tab'); ////////////////////////////////////////////////////////////////////////////////\n  // tab.EscapingUtil\n\n  tab.EscapingUtil = function tab_EscapingUtil() {};\n\n  tab.EscapingUtil.escapeHtml = function tab_EscapingUtil$escapeHtml(html) {\n    var escaped = html || '';\n    escaped = escaped.replace(new RegExp('&', 'g'), '&amp;');\n    escaped = escaped.replace(new RegExp('<', 'g'), '&lt;');\n    escaped = escaped.replace(new RegExp('>', 'g'), '&gt;');\n    escaped = escaped.replace(new RegExp('\"', 'g'), '&quot;');\n    escaped = escaped.replace(new RegExp(\"'\", 'g'), '&#39;');\n    escaped = escaped.replace(new RegExp('/', 'g'), '&#47;');\n    return escaped;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.WindowHelper\n\n\n  tab.WindowHelper = function tab_WindowHelper(window) {\n    this._window = window;\n  };\n\n  tab.WindowHelper.get_windowSelf = function tab_WindowHelper$get_windowSelf() {\n    return window.self;\n  };\n\n  tab.WindowHelper.close = function tab_WindowHelper$close(window) {\n    window.close();\n  };\n\n  tab.WindowHelper.getOpener = function tab_WindowHelper$getOpener(window) {\n    return window.opener;\n  };\n\n  tab.WindowHelper.getLocation = function tab_WindowHelper$getLocation(window) {\n    return window.location;\n  };\n\n  tab.WindowHelper.getPathAndSearch = function tab_WindowHelper$getPathAndSearch(window) {\n    return window.location.pathname + window.location.search;\n  };\n\n  tab.WindowHelper.setLocationHref = function tab_WindowHelper$setLocationHref(window, href) {\n    window.location.href = href;\n  };\n\n  tab.WindowHelper.locationReplace = function tab_WindowHelper$locationReplace(window, url) {\n    window.location.replace(url);\n  };\n\n  tab.WindowHelper.open = function tab_WindowHelper$open(href, target, options) {\n    return window.open(href, target, options);\n  };\n\n  tab.WindowHelper.reload = function tab_WindowHelper$reload(w, foreGet) {\n    w.location.reload(foreGet);\n  };\n\n  tab.WindowHelper.requestAnimationFrame = function tab_WindowHelper$requestAnimationFrame(action) {\n    return tab.WindowHelper._requestAnimationFrameFunc(action);\n  };\n\n  tab.WindowHelper.cancelAnimationFrame = function tab_WindowHelper$cancelAnimationFrame(animationId) {\n    if (ss.isValue(animationId)) {\n      tab.WindowHelper._cancelAnimationFrameFunc(animationId);\n    }\n  };\n\n  tab.WindowHelper._setDefaultRequestAnimationFrameImpl = function tab_WindowHelper$_setDefaultRequestAnimationFrameImpl() {\n    var lastTime = 0;\n\n    tab.WindowHelper._requestAnimationFrameFunc = function (callback) {\n      var curTime = new Date().getTime();\n      var timeToCall = Math.max(0, 16 - (curTime - lastTime));\n      lastTime = curTime + timeToCall;\n      var id = window.setTimeout(function () {\n        callback();\n      }, timeToCall);\n      return id;\n    };\n  };\n\n  tab.WindowHelper.prototype = {\n    _window: null,\n    get_pageXOffset: function tab_WindowHelper$get_pageXOffset() {\n      return tab.WindowHelper._pageXOffsetFunc(this._window);\n    },\n    get_pageYOffset: function tab_WindowHelper$get_pageYOffset() {\n      return tab.WindowHelper._pageYOffsetFunc(this._window);\n    },\n    get_clientWidth: function tab_WindowHelper$get_clientWidth() {\n      return tab.WindowHelper._clientWidthFunc(this._window);\n    },\n    get_clientHeight: function tab_WindowHelper$get_clientHeight() {\n      return tab.WindowHelper._clientHeightFunc(this._window);\n    },\n    get_innerWidth: function tab_WindowHelper$get_innerWidth() {\n      return tab.WindowHelper._innerWidthFunc(this._window);\n    },\n    get_outerWidth: function tab_WindowHelper$get_outerWidth() {\n      return tab.WindowHelper._outerWidthFunc(this._window);\n    },\n    get_innerHeight: function tab_WindowHelper$get_innerHeight() {\n      return tab.WindowHelper._innerHeightFunc(this._window);\n    },\n    get_outerHeight: function tab_WindowHelper$get_outerHeight() {\n      return tab.WindowHelper._outerHeightFunc(this._window);\n    },\n    get_screenLeft: function tab_WindowHelper$get_screenLeft() {\n      return tab.WindowHelper._screenLeftFunc(this._window);\n    },\n    get_screenTop: function tab_WindowHelper$get_screenTop() {\n      return tab.WindowHelper._screenTopFunc(this._window);\n    }\n  };\n  tab.EscapingUtil.registerClass('tab.EscapingUtil');\n  tab.WindowHelper.registerClass('tab.WindowHelper');\n  tab.WindowHelper._innerWidthFunc = null;\n  tab.WindowHelper._innerHeightFunc = null;\n  tab.WindowHelper._clientWidthFunc = null;\n  tab.WindowHelper._clientHeightFunc = null;\n  tab.WindowHelper._pageXOffsetFunc = null;\n  tab.WindowHelper._pageYOffsetFunc = null;\n  tab.WindowHelper._screenLeftFunc = null;\n  tab.WindowHelper._screenTopFunc = null;\n  tab.WindowHelper._outerWidthFunc = null;\n  tab.WindowHelper._outerHeightFunc = null;\n  tab.WindowHelper._requestAnimationFrameFunc = null;\n  tab.WindowHelper._cancelAnimationFrameFunc = null;\n\n  (function () {\n    if ('innerWidth' in window) {\n      tab.WindowHelper._innerWidthFunc = function (w) {\n        return w.innerWidth;\n      };\n    } else {\n      tab.WindowHelper._innerWidthFunc = function (w) {\n        return w.document.documentElement.offsetWidth;\n      };\n    }\n\n    if ('outerWidth' in window) {\n      tab.WindowHelper._outerWidthFunc = function (w) {\n        return w.outerWidth;\n      };\n    } else {\n      tab.WindowHelper._outerWidthFunc = tab.WindowHelper._innerWidthFunc;\n    }\n\n    if ('innerHeight' in window) {\n      tab.WindowHelper._innerHeightFunc = function (w) {\n        return w.innerHeight;\n      };\n    } else {\n      tab.WindowHelper._innerHeightFunc = function (w) {\n        return w.document.documentElement.offsetHeight;\n      };\n    }\n\n    if ('outerHeight' in window) {\n      tab.WindowHelper._outerHeightFunc = function (w) {\n        return w.outerHeight;\n      };\n    } else {\n      tab.WindowHelper._outerHeightFunc = tab.WindowHelper._innerHeightFunc;\n    }\n\n    if ('clientWidth' in window) {\n      tab.WindowHelper._clientWidthFunc = function (w) {\n        return w.clientWidth;\n      };\n    } else {\n      tab.WindowHelper._clientWidthFunc = function (w) {\n        return w.document.documentElement.clientWidth;\n      };\n    }\n\n    if ('clientHeight' in window) {\n      tab.WindowHelper._clientHeightFunc = function (w) {\n        return w.clientHeight;\n      };\n    } else {\n      tab.WindowHelper._clientHeightFunc = function (w) {\n        return w.document.documentElement.clientHeight;\n      };\n    }\n\n    if (ss.isValue(window.self.pageXOffset)) {\n      tab.WindowHelper._pageXOffsetFunc = function (w) {\n        return w.pageXOffset;\n      };\n    } else {\n      tab.WindowHelper._pageXOffsetFunc = function (w) {\n        return w.document.documentElement.scrollLeft;\n      };\n    }\n\n    if (ss.isValue(window.self.pageYOffset)) {\n      tab.WindowHelper._pageYOffsetFunc = function (w) {\n        return w.pageYOffset;\n      };\n    } else {\n      tab.WindowHelper._pageYOffsetFunc = function (w) {\n        return w.document.documentElement.scrollTop;\n      };\n    }\n\n    if ('screenLeft' in window) {\n      tab.WindowHelper._screenLeftFunc = function (w) {\n        return w.screenLeft;\n      };\n    } else {\n      tab.WindowHelper._screenLeftFunc = function (w) {\n        return w.screenX;\n      };\n    }\n\n    if ('screenTop' in window) {\n      tab.WindowHelper._screenTopFunc = function (w) {\n        return w.screenTop;\n      };\n    } else {\n      tab.WindowHelper._screenTopFunc = function (w) {\n        return w.screenY;\n      };\n    }\n\n    var DefaultRequestName = 'requestAnimationFrame';\n    var DefaultCancelName = 'cancelAnimationFrame';\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    var requestFuncName = null;\n    var cancelFuncName = null;\n\n    if (DefaultRequestName in window) {\n      requestFuncName = DefaultRequestName;\n    }\n\n    if (DefaultCancelName in window) {\n      cancelFuncName = DefaultCancelName;\n    }\n\n    for (var ii = 0; ii < vendors.length && (requestFuncName == null || cancelFuncName == null); ++ii) {\n      var vendor = vendors[ii];\n      var funcName = vendor + 'RequestAnimationFrame';\n\n      if (requestFuncName == null && funcName in window) {\n        requestFuncName = funcName;\n      }\n\n      if (cancelFuncName == null) {\n        funcName = vendor + 'CancelAnimationFrame';\n\n        if (funcName in window) {\n          cancelFuncName = funcName;\n        }\n\n        funcName = vendor + 'CancelRequestAnimationFrame';\n\n        if (funcName in window) {\n          cancelFuncName = funcName;\n        }\n      }\n    }\n\n    if (requestFuncName != null) {\n      tab.WindowHelper._requestAnimationFrameFunc = function (callback) {\n        return window[requestFuncName](callback);\n      };\n    } else {\n      tab.WindowHelper._setDefaultRequestAnimationFrameImpl();\n    }\n\n    if (cancelFuncName != null) {\n      tab.WindowHelper._cancelAnimationFrameFunc = function (animationId) {\n        window[cancelFuncName](animationId);\n      };\n    } else {\n      tab.WindowHelper._cancelAnimationFrameFunc = function (id) {\n        window.clearTimeout(id);\n      };\n    }\n  })(); // }());\n\n\n  Type.registerNamespace('tab'); ////////////////////////////////////////////////////////////////////////////////\n  // tab._SheetInfoImpl\n\n  tab.$create__SheetInfoImpl = function tab__SheetInfoImpl(name, sheetType, index, size, workbook, url, isActive, isHidden, zoneId) {\n    var $o = {};\n    $o.name = name;\n    $o.sheetType = sheetType;\n    $o.index = index;\n    $o.size = size;\n    $o.workbook = workbook;\n    $o.url = url;\n    $o.isActive = isActive;\n    $o.isHidden = isHidden;\n    $o.zoneId = zoneId;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._dashboardZoneInfo\n\n\n  tab.$create__dashboardZoneInfo = function tab__dashboardZoneInfo(name, objectType, position, size, zoneId) {\n    var $o = {};\n    $o._name = name;\n    $o._objectType = objectType;\n    $o._position = position;\n    $o._size = size;\n    $o._zoneId = zoneId;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._StoryPointInfoImpl\n\n\n  tab.$create__StoryPointInfoImpl = function tab__StoryPointInfoImpl(caption, index, storyPointId, isActive, isUpdated, parentStoryImpl) {\n    var $o = {};\n    $o.caption = caption;\n    $o.index = index;\n    $o.storyPointId = storyPointId;\n    $o.isActive = isActive;\n    $o.isUpdated = isUpdated;\n    $o.parentStoryImpl = parentStoryImpl;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._ApiCommand\n\n\n  tab._ApiCommand = function tab__ApiCommand(name, sourceId, handlerId, parameters) {\n    this._name = name;\n    this._sourceId = sourceId;\n    this._handlerId = handlerId;\n    this._parameters = parameters;\n  };\n\n  tab._ApiCommand.parse = function tab__ApiCommand$parse(serialized) {\n    var name;\n    var index = serialized.indexOf(',');\n\n    if (index < 0) {\n      name = serialized;\n      return new tab._ApiCommand(name, null, null, null);\n    }\n\n    name = serialized.substr(0, index);\n    var sourceId;\n    var secondPart = serialized.substr(index + 1);\n    index = secondPart.indexOf(',');\n\n    if (index < 0) {\n      sourceId = secondPart;\n      return new tab._ApiCommand(name, sourceId, null, null);\n    }\n\n    sourceId = secondPart.substr(0, index);\n    var handlerId;\n    var thirdPart = secondPart.substr(index + 1);\n    index = thirdPart.indexOf(',');\n\n    if (index < 0) {\n      handlerId = thirdPart;\n      return new tab._ApiCommand(name, sourceId, handlerId, null);\n    }\n\n    handlerId = thirdPart.substr(0, index);\n    var parameters = thirdPart.substr(index + 1);\n    tab._ApiCommand.lastResponseMessage = serialized;\n\n    if (name === 'api.GetClientInfoCommand') {\n      tab._ApiCommand.lastClientInfoResponseMessage = serialized;\n    }\n\n    return new tab._ApiCommand(name, sourceId, handlerId, parameters);\n  };\n\n  tab._ApiCommand.prototype = {\n    _name: null,\n    _handlerId: null,\n    _sourceId: null,\n    _parameters: null,\n    get_name: function tab__ApiCommand$get_name() {\n      return this._name;\n    },\n    get_handlerId: function tab__ApiCommand$get_handlerId() {\n      return this._handlerId;\n    },\n    get_sourceId: function tab__ApiCommand$get_sourceId() {\n      return this._sourceId;\n    },\n    get_parameters: function tab__ApiCommand$get_parameters() {\n      return this._parameters;\n    },\n    get_isApiCommandName: function tab__ApiCommand$get_isApiCommandName() {\n      return !this.get_rawName().indexOf('api.', 0);\n    },\n    get_rawName: function tab__ApiCommand$get_rawName() {\n      return this._name;\n    },\n    serialize: function tab__ApiCommand$serialize() {\n      var message = [];\n      message.push(this._name);\n      message.push(this._sourceId);\n      message.push(this._handlerId);\n\n      if (ss.isValue(this._parameters)) {\n        message.push(this._parameters);\n      }\n\n      var serializedMessage = message.join(',');\n      tab._ApiCommand.lastRequestMessage = serializedMessage;\n      return serializedMessage;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._ApiServerResultParser\n\n  };\n\n  tab._ApiServerResultParser = function tab__ApiServerResultParser(serverResult) {\n    var param = JSON.parse(serverResult);\n    this._commandResult = param['api.commandResult'];\n    this._commandData = param['api.commandData'];\n  };\n\n  tab._ApiServerResultParser.prototype = {\n    _commandResult: null,\n    _commandData: null,\n    get_result: function tab__ApiServerResultParser$get_result() {\n      return this._commandResult;\n    },\n    get_data: function tab__ApiServerResultParser$get_data() {\n      return this._commandData;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._ApiServerNotification\n\n  };\n\n  tab._ApiServerNotification = function tab__ApiServerNotification(workbookName, worksheetName, data) {\n    this._workbookName = workbookName;\n    this._worksheetName = worksheetName;\n    this._data = data;\n  };\n\n  tab._ApiServerNotification.deserialize = function tab__ApiServerNotification$deserialize(json) {\n    var param = JSON.parse(json);\n    var workbookName = param['api.workbookName'];\n    var worksheetName = param['api.worksheetName'];\n    var data = param['api.commandData'];\n    return new tab._ApiServerNotification(workbookName, worksheetName, data);\n  };\n\n  tab._ApiServerNotification.prototype = {\n    _workbookName: null,\n    _worksheetName: null,\n    _data: null,\n    get_workbookName: function tab__ApiServerNotification$get_workbookName() {\n      return this._workbookName;\n    },\n    get_worksheetName: function tab__ApiServerNotification$get_worksheetName() {\n      return this._worksheetName;\n    },\n    get_data: function tab__ApiServerNotification$get_data() {\n      return this._data;\n    },\n    serialize: function tab__ApiServerNotification$serialize() {\n      var serialized = {};\n      serialized['api.workbookName'] = this._workbookName;\n      serialized['api.worksheetName'] = this._worksheetName;\n      serialized['api.commandData'] = this._data;\n      return JSON.stringify(serialized);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._CommandReturnHandler\n\n  };\n\n  tab._CommandReturnHandler = function tab__CommandReturnHandler(commandName, successCallbackTiming, successCallback, errorCallback) {\n    this._commandName = commandName;\n    this._successCallback = successCallback;\n    this._successCallbackTiming = successCallbackTiming;\n    this._errorCallback = errorCallback;\n  };\n\n  tab._CommandReturnHandler.prototype = {\n    _commandName: null,\n    _successCallbackTiming: 0,\n    _successCallback: null,\n    _errorCallback: null,\n    get_commandName: function tab__CommandReturnHandler$get_commandName() {\n      return this._commandName;\n    },\n    get_successCallback: function tab__CommandReturnHandler$get_successCallback() {\n      return this._successCallback;\n    },\n    get_successCallbackTiming: function tab__CommandReturnHandler$get_successCallbackTiming() {\n      return this._successCallbackTiming;\n    },\n    get_errorCallback: function tab__CommandReturnHandler$get_errorCallback() {\n      return this._errorCallback;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._crossDomainMessageRouter\n\n  };\n\n  tab._crossDomainMessageRouter = function tab__crossDomainMessageRouter() {\n    this._handlers = {};\n    this._commandCallbacks = {};\n    this._customViewLoadCallbacks = {};\n    this._commandReturnAfterStateReadyQueues = {};\n\n    if (tab._Utility.hasWindowAddEventListener()) {\n      window.addEventListener('message', this._getHandleCrossDomainMessageDelegate(), false);\n    } else if (tab._Utility.hasDocumentAttachEvent()) {\n      document.attachEvent('onmessage', this._getHandleCrossDomainMessageDelegate());\n      window.attachEvent('onmessage', this._getHandleCrossDomainMessageDelegate());\n    } else {\n      window.onmessage = this._getHandleCrossDomainMessageDelegate();\n    }\n\n    this._nextHandlerId = this._nextCommandId = 0;\n  };\n\n  tab._crossDomainMessageRouter.prototype = {\n    _nextHandlerId: 0,\n    _nextCommandId: 0,\n    registerHandler: function tab__crossDomainMessageRouter$registerHandler(handler) {\n      var uniqueId = 'handler' + this._nextHandlerId;\n\n      if (ss.isValue(handler.get_handlerId()) || ss.isValue(this._handlers[handler.get_handlerId()])) {\n        throw tab._TableauException.createInternalError(\"Handler '\" + handler.get_handlerId() + \"' is already registered.\");\n      }\n\n      this._nextHandlerId++;\n      handler.set_handlerId(uniqueId);\n      this._handlers[uniqueId] = handler;\n      handler.add_customViewsListLoad(ss.Delegate.create(this, this._handleCustomViewsListLoad));\n      handler.add_stateReadyForQuery(ss.Delegate.create(this, this._handleStateReadyForQuery));\n    },\n    unregisterHandler: function tab__crossDomainMessageRouter$unregisterHandler(handler) {\n      if (ss.isValue(handler.get_handlerId()) || ss.isValue(this._handlers[handler.get_handlerId()])) {\n        delete this._handlers[handler.get_handlerId()];\n        handler.remove_customViewsListLoad(ss.Delegate.create(this, this._handleCustomViewsListLoad));\n        handler.remove_stateReadyForQuery(ss.Delegate.create(this, this._handleStateReadyForQuery));\n      }\n    },\n    sendCommand: function tab__crossDomainMessageRouter$sendCommand(source, commandParameters, returnHandler) {\n      var iframe = source.get_iframe();\n      var handlerId = source.get_handlerId();\n\n      if (!tab._Utility.hasWindowPostMessage() || ss.isNullOrUndefined(iframe) || ss.isNullOrUndefined(iframe.contentWindow)) {\n        return;\n      }\n\n      var sourceId = 'cmd' + this._nextCommandId;\n      this._nextCommandId++;\n      var callbackMap = this._commandCallbacks[handlerId];\n\n      if (ss.isNullOrUndefined(callbackMap)) {\n        callbackMap = {};\n        this._commandCallbacks[handlerId] = callbackMap;\n      }\n\n      callbackMap[sourceId] = returnHandler;\n      var commandName = returnHandler.get_commandName();\n\n      if (commandName === 'api.ShowCustomViewCommand') {\n        var customViewCallbackMap = this._customViewLoadCallbacks[handlerId];\n\n        if (ss.isNullOrUndefined(customViewCallbackMap)) {\n          customViewCallbackMap = {};\n          this._customViewLoadCallbacks[handlerId] = customViewCallbackMap;\n        }\n\n        customViewCallbackMap[sourceId] = returnHandler;\n      }\n\n      var serializedParams = null;\n\n      if (ss.isValue(commandParameters)) {\n        serializedParams = tab.JsonUtil.toJson(commandParameters, false, '');\n      }\n\n      var command = new tab._ApiCommand(commandName, sourceId, handlerId, serializedParams);\n      var message = command.serialize();\n\n      if (tab._Utility.isPostMessageSynchronous()) {\n        window.setTimeout(function () {\n          iframe.contentWindow.postMessage(message, source.get_serverRoot());\n        }, 0);\n      } else {\n        iframe.contentWindow.postMessage(message, source.get_serverRoot());\n      }\n    },\n    _handleCustomViewsListLoad: function tab__crossDomainMessageRouter$_handleCustomViewsListLoad(source) {\n      var handlerId = source.get_handlerId();\n      var customViewCallbackMap = this._customViewLoadCallbacks[handlerId];\n\n      if (ss.isNullOrUndefined(customViewCallbackMap)) {\n        return;\n      }\n\n      var $dict1 = customViewCallbackMap;\n\n      for (var $key2 in $dict1) {\n        var customViewCallback = {\n          key: $key2,\n          value: $dict1[$key2]\n        };\n        var returnHandler = customViewCallback.value;\n\n        if (ss.isValue(returnHandler.get_successCallback())) {\n          returnHandler.get_successCallback()(null);\n        }\n      }\n\n      delete this._customViewLoadCallbacks[handlerId];\n    },\n    _handleStateReadyForQuery: function tab__crossDomainMessageRouter$_handleStateReadyForQuery(source) {\n      var queue = this._commandReturnAfterStateReadyQueues[source.get_handlerId()];\n\n      if (tab._Utility.isNullOrEmpty(queue)) {\n        return;\n      }\n\n      while (queue.length > 0) {\n        var successCallback = queue.pop();\n\n        if (ss.isValue(successCallback)) {\n          successCallback();\n        }\n      }\n    },\n    _getHandleCrossDomainMessageDelegate: function tab__crossDomainMessageRouter$_getHandleCrossDomainMessageDelegate() {\n      return ss.Delegate.create(this, function (e) {\n        this._handleCrossDomainMessage(e);\n      });\n    },\n    _handleCrossDomainMessage: function tab__crossDomainMessageRouter$_handleCrossDomainMessage(e) {\n      if (ss.isNullOrUndefined(e.data)) {\n        return;\n      }\n\n      var command = tab._ApiCommand.parse(e.data);\n\n      var rawName = command.get_rawName();\n      var handlerId = command.get_handlerId();\n      var handler = this._handlers[handlerId];\n\n      if (ss.isNullOrUndefined(handler) || handler.get_handlerId() !== command.get_handlerId()) {\n        handler = new tab._doNothingCrossDomainHandler();\n      }\n\n      if (command.get_isApiCommandName()) {\n        if (command.get_sourceId() === 'xdomainSourceId') {\n          handler.handleEventNotification(command.get_name(), command.get_parameters());\n\n          if (command.get_name() === 'api.FirstVizSizeKnownEvent') {\n            e.source.postMessage('tableau.bootstrap', '*');\n          }\n        } else {\n          this._handleCrossDomainResponse(command);\n        }\n      } else {\n        this._handleLegacyNotifications(rawName, e, handler);\n      }\n    },\n    _handleCrossDomainResponse: function tab__crossDomainMessageRouter$_handleCrossDomainResponse(command) {\n      var commandCallbackMap = this._commandCallbacks[command.get_handlerId()];\n\n      var returnHandler = ss.isValue(commandCallbackMap) ? commandCallbackMap[command.get_sourceId()] : null;\n\n      if (ss.isNullOrUndefined(returnHandler)) {\n        return;\n      }\n\n      delete commandCallbackMap[command.get_sourceId()];\n\n      if (command.get_name() !== returnHandler.get_commandName()) {\n        return;\n      }\n\n      var crossDomainResult = new tab._ApiServerResultParser(command.get_parameters());\n      var commandResult = crossDomainResult.get_data();\n\n      if (crossDomainResult.get_result() === 'api.success') {\n        switch (returnHandler.get_successCallbackTiming()) {\n          case 0:\n            if (ss.isValue(returnHandler.get_successCallback())) {\n              returnHandler.get_successCallback()(commandResult);\n            }\n\n            break;\n\n          case 1:\n            var postponedCallback = function postponedCallback() {\n              if (ss.isValue(returnHandler.get_successCallback())) {\n                returnHandler.get_successCallback()(commandResult);\n              }\n            };\n\n            var queue = this._commandReturnAfterStateReadyQueues[command.get_handlerId()];\n\n            if (ss.isNullOrUndefined(queue)) {\n              queue = [];\n              this._commandReturnAfterStateReadyQueues[command.get_handlerId()] = queue;\n            }\n\n            queue.push(postponedCallback);\n            break;\n\n          default:\n            throw tab._TableauException.createInternalError('Unknown timing value: ' + returnHandler.get_successCallbackTiming());\n        }\n      } else if (ss.isValue(returnHandler.get_errorCallback())) {\n        var remoteError = crossDomainResult.get_result() === 'api.remotefailed';\n        returnHandler.get_errorCallback()(remoteError, commandResult);\n      }\n    },\n    _handleLegacyNotifications: function tab__crossDomainMessageRouter$_handleLegacyNotifications(messageName, e, handler) {\n      if (messageName === 'layoutInfoReq') {\n        tab._VizManagerImpl._sendVizOffsets();\n\n        this._postLayoutInfo(e.source);\n      } else if (messageName === 'tableau.completed' || messageName === 'completed') {\n        handler.handleVizLoad();\n      }\n    },\n    _postLayoutInfo: function tab__crossDomainMessageRouter$_postLayoutInfo(source) {\n      if (!tab._Utility.hasWindowPostMessage()) {\n        return;\n      }\n\n      var win = new tab.WindowHelper(window.self);\n      var width = ss.isValue(win.get_innerWidth()) ? win.get_innerWidth() : document.documentElement.offsetWidth;\n      var height = ss.isValue(win.get_innerHeight()) ? win.get_innerHeight() : document.documentElement.offsetHeight;\n      var left = ss.isValue(win.get_pageXOffset()) ? win.get_pageXOffset() : document.documentElement.scrollLeft;\n      var top = ss.isValue(win.get_pageYOffset()) ? win.get_pageYOffset() : document.documentElement.scrollTop;\n      var msgArr = [];\n      msgArr.push('layoutInfoResp');\n      msgArr.push(left);\n      msgArr.push(top);\n      msgArr.push(width);\n      msgArr.push(height);\n      source.postMessage(msgArr.join(','), '*');\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._doNothingCrossDomainHandler\n\n  };\n\n  tab._doNothingCrossDomainHandler = function tab__doNothingCrossDomainHandler() {};\n\n  tab._doNothingCrossDomainHandler.prototype = {\n    _handlerId: null,\n    add_customViewsListLoad: function tab__doNothingCrossDomainHandler$add_customViewsListLoad(value) {\n      this.__customViewsListLoad = ss.Delegate.combine(this.__customViewsListLoad, value);\n    },\n    remove_customViewsListLoad: function tab__doNothingCrossDomainHandler$remove_customViewsListLoad(value) {\n      this.__customViewsListLoad = ss.Delegate.remove(this.__customViewsListLoad, value);\n    },\n    __customViewsListLoad: null,\n    add_stateReadyForQuery: function tab__doNothingCrossDomainHandler$add_stateReadyForQuery(value) {\n      this.__stateReadyForQuery = ss.Delegate.combine(this.__stateReadyForQuery, value);\n    },\n    remove_stateReadyForQuery: function tab__doNothingCrossDomainHandler$remove_stateReadyForQuery(value) {\n      this.__stateReadyForQuery = ss.Delegate.remove(this.__stateReadyForQuery, value);\n    },\n    __stateReadyForQuery: null,\n    get_iframe: function tab__doNothingCrossDomainHandler$get_iframe() {\n      return null;\n    },\n    get_handlerId: function tab__doNothingCrossDomainHandler$get_handlerId() {\n      return this._handlerId;\n    },\n    set_handlerId: function tab__doNothingCrossDomainHandler$set_handlerId(value) {\n      this._handlerId = value;\n      return value;\n    },\n    get_serverRoot: function tab__doNothingCrossDomainHandler$get_serverRoot() {\n      return '*';\n    },\n    handleVizLoad: function tab__doNothingCrossDomainHandler$handleVizLoad() {},\n    handleEventNotification: function tab__doNothingCrossDomainHandler$handleEventNotification(eventName, parameters) {},\n    _silenceTheCompilerWarning: function tab__doNothingCrossDomainHandler$_silenceTheCompilerWarning() {\n      this.__customViewsListLoad(null);\n\n      this.__stateReadyForQuery(null);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.CrossDomainMessagingOptions\n\n  };\n\n  tab.CrossDomainMessagingOptions = function tab_CrossDomainMessagingOptions(router, handler) {\n    tab._Param.verifyValue(router, 'router');\n\n    tab._Param.verifyValue(handler, 'handler');\n\n    this._router = router;\n    this._handler = handler;\n  };\n\n  tab.CrossDomainMessagingOptions.prototype = {\n    _router: null,\n    _handler: null,\n    get_router: function tab_CrossDomainMessagingOptions$get_router() {\n      return this._router;\n    },\n    get_handler: function tab_CrossDomainMessagingOptions$get_handler() {\n      return this._handler;\n    },\n    sendCommand: function tab_CrossDomainMessagingOptions$sendCommand(commandParameters, returnHandler) {\n      this._router.sendCommand(this._handler, commandParameters, returnHandler);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._enums\n\n  };\n\n  tab._enums = function tab__enums() {};\n\n  tab._enums._normalizePeriodType = function tab__enums$_normalizePeriodType(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.PeriodType, true);\n  };\n\n  tab._enums._normalizeDateRangeType = function tab__enums$_normalizeDateRangeType(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.DateRangeType, true);\n  };\n\n  tab._enums._normalizeFilterUpdateType = function tab__enums$_normalizeFilterUpdateType(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.FilterUpdateType, true);\n  };\n\n  tab._enums._normalizeSelectionUpdateType = function tab__enums$_normalizeSelectionUpdateType(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.SelectionUpdateType, true);\n  };\n\n  tab._enums._isSelectionUpdateType = function tab__enums$_isSelectionUpdateType(rawValue) {\n    var rawString = ss.isValue(rawValue) ? rawValue.toString() : '';\n    return tab._enums._normalizeEnum(rawString, '', tableauSoftware.SelectionUpdateType, false) != null;\n  };\n\n  tab._enums._normalizeNullOption = function tab__enums$_normalizeNullOption(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.NullOption, true);\n  };\n\n  tab._enums._normalizeSheetSizeBehavior = function tab__enums$_normalizeSheetSizeBehavior(rawValue, paramName) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, paramName, tableauSoftware.SheetSizeBehavior, true);\n  };\n\n  tab._enums._normalizeTableauEventName = function tab__enums$_normalizeTableauEventName(rawValue) {\n    var rawString = ss.isValue(rawValue) ? rawValue : '';\n    return tab._enums._normalizeEnum(rawString, '', tableauSoftware.TableauEventName, false);\n  };\n\n  tab._enums._normalizeEnum = function tab__enums$_normalizeEnum(rawValue, paramName, enumObject, throwOnInvalid) {\n    if (ss.isValue(rawValue)) {\n      var lookup = rawValue.toString().toUpperCase();\n      var $dict1 = enumObject;\n\n      for (var $key2 in $dict1) {\n        var entry = {\n          key: $key2,\n          value: $dict1[$key2]\n        };\n        var compareValue = entry.value.toString().toUpperCase();\n\n        if (lookup === compareValue) {\n          return entry.value;\n        }\n      }\n    }\n\n    if (throwOnInvalid) {\n      throw tab._TableauException.createInvalidParameter(paramName);\n    }\n\n    return null;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._ApiBootstrap\n\n\n  tab._ApiBootstrap = function tab__ApiBootstrap() {};\n\n  tab._ApiBootstrap.initialize = function tab__ApiBootstrap$initialize() {\n    tab._ApiObjectRegistry.registerCrossDomainMessageRouter(function () {\n      return new tab._crossDomainMessageRouter();\n    });\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._ApiObjectRegistry\n\n\n  tab._ApiObjectRegistry = function tab__ApiObjectRegistry() {};\n\n  tab._ApiObjectRegistry.registerCrossDomainMessageRouter = function tab__ApiObjectRegistry$registerCrossDomainMessageRouter(objectCreationFunc) {\n    return tab._ApiObjectRegistry._registerType('ICrossDomainMessageRouter', objectCreationFunc);\n  };\n\n  tab._ApiObjectRegistry.getCrossDomainMessageRouter = function tab__ApiObjectRegistry$getCrossDomainMessageRouter() {\n    return tab._ApiObjectRegistry._getSingleton('ICrossDomainMessageRouter');\n  };\n\n  tab._ApiObjectRegistry.disposeCrossDomainMessageRouter = function tab__ApiObjectRegistry$disposeCrossDomainMessageRouter() {\n    tab._ApiObjectRegistry._clearSingletonInstance('ICrossDomainMessageRouter');\n  };\n\n  tab._ApiObjectRegistry._registerType = function tab__ApiObjectRegistry$_registerType(interfaceTypeName, objectCreationFunc) {\n    if (ss.isNullOrUndefined(tab._ApiObjectRegistry._creationRegistry)) {\n      tab._ApiObjectRegistry._creationRegistry = {};\n    }\n\n    var previousType = tab._ApiObjectRegistry._creationRegistry[interfaceTypeName];\n    tab._ApiObjectRegistry._creationRegistry[interfaceTypeName] = objectCreationFunc;\n    return previousType;\n  };\n\n  tab._ApiObjectRegistry._createType = function tab__ApiObjectRegistry$_createType(interfaceTypeName) {\n    if (ss.isNullOrUndefined(tab._ApiObjectRegistry._creationRegistry)) {\n      throw tab._TableauException.createInternalError('No types registered');\n    }\n\n    var creationFunc = tab._ApiObjectRegistry._creationRegistry[interfaceTypeName];\n\n    if (ss.isNullOrUndefined(creationFunc)) {\n      throw tab._TableauException.createInternalError(\"No creation function has been registered for interface type '\" + interfaceTypeName + \"'.\");\n    }\n\n    var instance = creationFunc();\n    return instance;\n  };\n\n  tab._ApiObjectRegistry._getSingleton = function tab__ApiObjectRegistry$_getSingleton(interfaceTypeName) {\n    if (ss.isNullOrUndefined(tab._ApiObjectRegistry._singletonInstanceRegistry)) {\n      tab._ApiObjectRegistry._singletonInstanceRegistry = {};\n    }\n\n    var instance = tab._ApiObjectRegistry._singletonInstanceRegistry[interfaceTypeName];\n\n    if (ss.isNullOrUndefined(instance)) {\n      instance = tab._ApiObjectRegistry._createType(interfaceTypeName);\n      tab._ApiObjectRegistry._singletonInstanceRegistry[interfaceTypeName] = instance;\n    }\n\n    return instance;\n  };\n\n  tab._ApiObjectRegistry._clearSingletonInstance = function tab__ApiObjectRegistry$_clearSingletonInstance(interfaceTypeName) {\n    if (ss.isNullOrUndefined(tab._ApiObjectRegistry._singletonInstanceRegistry)) {\n      return null;\n    }\n\n    var instance = tab._ApiObjectRegistry._singletonInstanceRegistry[interfaceTypeName];\n    delete tab._ApiObjectRegistry._singletonInstanceRegistry[interfaceTypeName];\n    return instance;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._CustomViewImpl\n\n\n  tab._CustomViewImpl = function tab__CustomViewImpl(workbookImpl, name, messagingOptions) {\n    this._workbookImpl = workbookImpl;\n    this._name = name;\n    this._messagingOptions = messagingOptions;\n    this._isPublic = false;\n    this._isDefault = false;\n    this._isStale = false;\n  };\n\n  tab._CustomViewImpl._getAsync = function tab__CustomViewImpl$_getAsync(eventContext) {\n    var deferred = new tab._Deferred();\n    deferred.resolve(eventContext.get__customViewImpl().get__customView());\n    return deferred.get_promise();\n  };\n\n  tab._CustomViewImpl._createNew = function tab__CustomViewImpl$_createNew(workbookImpl, messagingOptions, apiPresModel, defaultId) {\n    var cv = new tab._CustomViewImpl(workbookImpl, apiPresModel.name, messagingOptions);\n    cv._isPublic = apiPresModel.isPublic;\n    cv._url = apiPresModel.url;\n    cv._ownerName = apiPresModel.owner.friendlyName;\n    cv._isDefault = ss.isValue(defaultId) && defaultId === apiPresModel.id;\n    cv._presModel = apiPresModel;\n    return cv;\n  };\n\n  tab._CustomViewImpl._saveNewAsync = function tab__CustomViewImpl$_saveNewAsync(workbookImpl, messagingOptions, name) {\n    var deferred = new tab._Deferred();\n    var param = {};\n    param['api.customViewName'] = name;\n\n    var returnHandler = tab._CustomViewImpl._createCustomViewCommandReturnHandler('api.SaveNewCustomViewCommand', deferred, function (result) {\n      tab._CustomViewImpl._processCustomViewUpdate(workbookImpl, messagingOptions, result, true);\n\n      var newView = null;\n\n      if (ss.isValue(workbookImpl.get__updatedCustomViews())) {\n        newView = workbookImpl.get__updatedCustomViews().get_item(0);\n      }\n\n      deferred.resolve(newView);\n    });\n\n    messagingOptions.sendCommand(param, returnHandler);\n    return deferred.get_promise();\n  };\n\n  tab._CustomViewImpl._showCustomViewAsync = function tab__CustomViewImpl$_showCustomViewAsync(workbookImpl, messagingOptions, serverCustomizedView) {\n    var deferred = new tab._Deferred();\n    var param = {};\n\n    if (ss.isValue(serverCustomizedView)) {\n      param['api.customViewParam'] = serverCustomizedView;\n    }\n\n    var returnHandler = tab._CustomViewImpl._createCustomViewCommandReturnHandler('api.ShowCustomViewCommand', deferred, function (result) {\n      var cv = workbookImpl.get_activeCustomView();\n      deferred.resolve(cv);\n    });\n\n    messagingOptions.sendCommand(param, returnHandler);\n    return deferred.get_promise();\n  };\n\n  tab._CustomViewImpl._makeCurrentCustomViewDefaultAsync = function tab__CustomViewImpl$_makeCurrentCustomViewDefaultAsync(workbookImpl, messagingOptions) {\n    var deferred = new tab._Deferred();\n    var param = {};\n\n    var returnHandler = tab._CustomViewImpl._createCustomViewCommandReturnHandler('api.MakeCurrentCustomViewDefaultCommand', deferred, function (result) {\n      var cv = workbookImpl.get_activeCustomView();\n      deferred.resolve(cv);\n    });\n\n    messagingOptions.sendCommand(param, returnHandler);\n    return deferred.get_promise();\n  };\n\n  tab._CustomViewImpl._getCustomViewsAsync = function tab__CustomViewImpl$_getCustomViewsAsync(workbookImpl, messagingOptions) {\n    var deferred = new tab._Deferred();\n    var returnHandler = new tab._CommandReturnHandler('api.FetchCustomViewsCommand', 0, function (result) {\n      tab._CustomViewImpl._processCustomViews(workbookImpl, messagingOptions, result);\n\n      deferred.resolve(workbookImpl.get__customViews()._toApiCollection());\n    }, function (remoteError, message) {\n      deferred.reject(tab._TableauException.create('serverError', message));\n    });\n    messagingOptions.sendCommand(null, returnHandler);\n    return deferred.get_promise();\n  };\n\n  tab._CustomViewImpl._processCustomViews = function tab__CustomViewImpl$_processCustomViews(workbookImpl, messagingOptions, info) {\n    tab._CustomViewImpl._processCustomViewUpdate(workbookImpl, messagingOptions, info, false);\n  };\n\n  tab._CustomViewImpl._processCustomViewUpdate = function tab__CustomViewImpl$_processCustomViewUpdate(workbookImpl, messagingOptions, info, doUpdateList) {\n    if (doUpdateList) {\n      workbookImpl.set__updatedCustomViews(new tab._Collection());\n    }\n\n    workbookImpl.set__currentCustomView(null);\n    var currentViewName = null;\n\n    if (ss.isValue(info.currentView)) {\n      currentViewName = info.currentView.name;\n    }\n\n    var defaultId = info.defaultCustomViewId;\n\n    if (doUpdateList && ss.isValue(info.newView)) {\n      var newViewImpl = tab._CustomViewImpl._createNew(workbookImpl, messagingOptions, info.newView, defaultId);\n\n      workbookImpl.get__updatedCustomViews()._add(newViewImpl.get__name(), newViewImpl.get__customView());\n    }\n\n    workbookImpl.set__removedCustomViews(workbookImpl.get__customViews());\n    workbookImpl.set__customViews(new tab._Collection());\n\n    if (ss.isValue(info.customViews)) {\n      var list = info.customViews;\n\n      if (list.length > 0) {\n        for (var i = 0; i < list.length; i++) {\n          var customViewImpl = tab._CustomViewImpl._createNew(workbookImpl, messagingOptions, list[i], defaultId);\n\n          workbookImpl.get__customViews()._add(customViewImpl.get__name(), customViewImpl.get__customView());\n\n          if (workbookImpl.get__removedCustomViews()._has(customViewImpl.get__name())) {\n            workbookImpl.get__removedCustomViews()._remove(customViewImpl.get__name());\n          } else if (doUpdateList) {\n            if (!workbookImpl.get__updatedCustomViews()._has(customViewImpl.get__name())) {\n              workbookImpl.get__updatedCustomViews()._add(customViewImpl.get__name(), customViewImpl.get__customView());\n            }\n          }\n\n          if (ss.isValue(currentViewName) && customViewImpl.get__name() === currentViewName) {\n            workbookImpl.set__currentCustomView(customViewImpl.get__customView());\n          }\n        }\n      }\n    }\n  };\n\n  tab._CustomViewImpl._createCustomViewCommandReturnHandler = function tab__CustomViewImpl$_createCustomViewCommandReturnHandler(commandName, deferred, successCallback) {\n    var errorCallback = function errorCallback(remoteError, message) {\n      deferred.reject(tab._TableauException.create('serverError', message));\n    };\n\n    return new tab._CommandReturnHandler(commandName, 0, successCallback, errorCallback);\n  };\n\n  tab._CustomViewImpl.prototype = {\n    _customView: null,\n    _presModel: null,\n    _workbookImpl: null,\n    _messagingOptions: null,\n    _name: null,\n    _ownerName: null,\n    _url: null,\n    _isPublic: false,\n    _isDefault: false,\n    _isStale: false,\n    get__customView: function tab__CustomViewImpl$get__customView() {\n      if (this._customView == null) {\n        this._customView = new tableauSoftware.CustomView(this);\n      }\n\n      return this._customView;\n    },\n    get__workbook: function tab__CustomViewImpl$get__workbook() {\n      return this._workbookImpl.get_workbook();\n    },\n    get__url: function tab__CustomViewImpl$get__url() {\n      return this._url;\n    },\n    get__name: function tab__CustomViewImpl$get__name() {\n      return this._name;\n    },\n    set__name: function tab__CustomViewImpl$set__name(value) {\n      if (this._isStale) {\n        throw tab._TableauException.create('staleDataReference', 'Stale data');\n      }\n\n      this._name = value;\n      return value;\n    },\n    get__ownerName: function tab__CustomViewImpl$get__ownerName() {\n      return this._ownerName;\n    },\n    get__advertised: function tab__CustomViewImpl$get__advertised() {\n      return this._isPublic;\n    },\n    set__advertised: function tab__CustomViewImpl$set__advertised(value) {\n      if (this._isStale) {\n        throw tab._TableauException.create('staleDataReference', 'Stale data');\n      }\n\n      this._isPublic = value;\n      return value;\n    },\n    get__isDefault: function tab__CustomViewImpl$get__isDefault() {\n      return this._isDefault;\n    },\n    saveAsync: function tab__CustomViewImpl$saveAsync() {\n      if (this._isStale || ss.isNullOrUndefined(this._presModel)) {\n        throw tab._TableauException.create('staleDataReference', 'Stale data');\n      }\n\n      this._presModel.isPublic = this._isPublic;\n      this._presModel.name = this._name;\n      var deferred = new tab._Deferred();\n      var param = {};\n      param['api.customViewParam'] = this._presModel;\n\n      var returnHandler = tab._CustomViewImpl._createCustomViewCommandReturnHandler('api.UpdateCustomViewCommand', deferred, ss.Delegate.create(this, function (result) {\n        tab._CustomViewImpl._processCustomViewUpdate(this._workbookImpl, this._messagingOptions, result, true);\n\n        deferred.resolve(this.get__customView());\n      }));\n\n      this._messagingOptions.sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _removeAsync: function tab__CustomViewImpl$_removeAsync() {\n      var deferred = new tab._Deferred();\n      var param = {};\n      param['api.customViewParam'] = this._presModel;\n\n      var returnHandler = tab._CustomViewImpl._createCustomViewCommandReturnHandler('api.RemoveCustomViewCommand', deferred, ss.Delegate.create(this, function (result) {\n        this._isStale = true;\n\n        tab._CustomViewImpl._processCustomViews(this._workbookImpl, this._messagingOptions, result);\n\n        deferred.resolve(this.get__customView());\n      }));\n\n      this._messagingOptions.sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _showAsync: function tab__CustomViewImpl$_showAsync() {\n      if (this._isStale || ss.isNullOrUndefined(this._presModel)) {\n        throw tab._TableauException.create('staleDataReference', 'Stale data');\n      }\n\n      return tab._CustomViewImpl._showCustomViewAsync(this._workbookImpl, this._messagingOptions, this._presModel);\n    },\n    _isDifferent: function tab__CustomViewImpl$_isDifferent(other) {\n      return this._ownerName !== other._ownerName || this._url !== other._url || this._isPublic !== other._isPublic || this._isDefault !== other._isDefault;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._DashboardImpl\n\n  };\n\n  tab._DashboardImpl = function tab__DashboardImpl(sheetInfoImpl, workbookImpl, messagingOptions) {\n    this._worksheets$1 = new tab._Collection();\n    this._dashboardObjects$1 = new tab._Collection();\n\n    tab._DashboardImpl.initializeBase(this, [sheetInfoImpl, workbookImpl, messagingOptions]);\n  };\n\n  tab._DashboardImpl.prototype = {\n    _dashboard$1: null,\n    get_sheet: function tab__DashboardImpl$get_sheet() {\n      return this.get_dashboard();\n    },\n    get_dashboard: function tab__DashboardImpl$get_dashboard() {\n      if (this._dashboard$1 == null) {\n        this._dashboard$1 = new tableauSoftware.Dashboard(this);\n      }\n\n      return this._dashboard$1;\n    },\n    get_worksheets: function tab__DashboardImpl$get_worksheets() {\n      return this._worksheets$1;\n    },\n    get_objects: function tab__DashboardImpl$get_objects() {\n      return this._dashboardObjects$1;\n    },\n    _addObjects: function tab__DashboardImpl$_addObjects(zones, findSheetFunc) {\n      this._dashboardObjects$1 = new tab._Collection();\n      this._worksheets$1 = new tab._Collection();\n\n      for (var i = 0; i < zones.length; i++) {\n        var zone = zones[i];\n        var worksheet = null;\n\n        if (zones[i]._objectType === 'worksheet') {\n          var name = zone._name;\n\n          if (ss.isNullOrUndefined(name)) {\n            continue;\n          }\n\n          var index = this._worksheets$1.get__length();\n\n          var size = tab.SheetSizeFactory.createAutomatic();\n          var isActive = false;\n          var publishedSheetInfo = findSheetFunc(name);\n          var isHidden = ss.isNullOrUndefined(publishedSheetInfo);\n          var url = isHidden ? '' : publishedSheetInfo.getUrl();\n          var sheetInfoImpl = tab.$create__SheetInfoImpl(name, 'worksheet', index, size, this.get_workbook(), url, isActive, isHidden, zone._zoneId);\n          var worksheetImpl = new tab._WorksheetImpl(sheetInfoImpl, this.get_workbookImpl(), this.get_messagingOptions(), this);\n          worksheet = worksheetImpl.get_worksheet();\n\n          this._worksheets$1._add(name, worksheetImpl.get_worksheet());\n        }\n\n        var obj = new tableauSoftware.DashboardObject(zone, this.get_dashboard(), worksheet);\n\n        this._dashboardObjects$1._add(i.toString(), obj);\n      }\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._DataSourceImpl\n\n  };\n\n  tab._DataSourceImpl = function tab__DataSourceImpl(name, isPrimary) {\n    this._fields = new tab._Collection();\n\n    tab._Param.verifyString(name, 'name');\n\n    this._name = name;\n    this._isPrimary = isPrimary;\n  };\n\n  tab._DataSourceImpl.processDataSource = function tab__DataSourceImpl$processDataSource(dataSourcePm) {\n    var dataSourceImpl = new tab._DataSourceImpl(dataSourcePm.name, dataSourcePm.isPrimary);\n    var fields = dataSourcePm.fields || new Array(0);\n    var $enum1 = ss.IEnumerator.getEnumerator(fields);\n\n    while ($enum1.moveNext()) {\n      var fieldPm = $enum1.current;\n      var field = new tableauSoftware.Field(dataSourceImpl.get_dataSource(), fieldPm.name, fieldPm.role, fieldPm.aggregation);\n      dataSourceImpl.addField(field);\n    }\n\n    return dataSourceImpl;\n  };\n\n  tab._DataSourceImpl.processDataSourcesForWorksheet = function tab__DataSourceImpl$processDataSourcesForWorksheet(pm) {\n    var dataSources = new tab._Collection();\n    var primaryDataSourceImpl = null;\n    var $enum1 = ss.IEnumerator.getEnumerator(pm.dataSources);\n\n    while ($enum1.moveNext()) {\n      var dataSourcePm = $enum1.current;\n\n      var dataSourceImpl = tab._DataSourceImpl.processDataSource(dataSourcePm);\n\n      if (dataSourcePm.isPrimary) {\n        primaryDataSourceImpl = dataSourceImpl;\n      } else {\n        dataSources._add(dataSourcePm.name, dataSourceImpl.get_dataSource());\n      }\n    }\n\n    if (ss.isValue(primaryDataSourceImpl)) {\n      dataSources._addToFirst(primaryDataSourceImpl.get_name(), primaryDataSourceImpl.get_dataSource());\n    }\n\n    return dataSources;\n  };\n\n  tab._DataSourceImpl.prototype = {\n    _name: null,\n    _isPrimary: false,\n    _dataSource: null,\n    get_dataSource: function tab__DataSourceImpl$get_dataSource() {\n      if (this._dataSource == null) {\n        this._dataSource = new tableauSoftware.DataSource(this);\n      }\n\n      return this._dataSource;\n    },\n    get_name: function tab__DataSourceImpl$get_name() {\n      return this._name;\n    },\n    get_fields: function tab__DataSourceImpl$get_fields() {\n      return this._fields;\n    },\n    get_isPrimary: function tab__DataSourceImpl$get_isPrimary() {\n      return this._isPrimary;\n    },\n    addField: function tab__DataSourceImpl$addField(field) {\n      this._fields._add(field.getName(), field);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._deferredUtil\n\n  };\n\n  tab._deferredUtil = function tab__deferredUtil() {};\n\n  tab._deferredUtil.coerceToTrustedPromise = function tab__deferredUtil$coerceToTrustedPromise(promiseOrValue) {\n    var promise;\n\n    if (promiseOrValue instanceof tableauSoftware.Promise) {\n      promise = promiseOrValue;\n    } else {\n      if (ss.isValue(promiseOrValue) && typeof promiseOrValue.valueOf === 'function') {\n        promiseOrValue = promiseOrValue.valueOf();\n      }\n\n      if (tab._deferredUtil.isPromise(promiseOrValue)) {\n        var deferred = new tab._DeferredImpl();\n        promiseOrValue.then(ss.Delegate.create(deferred, deferred.resolve), ss.Delegate.create(deferred, deferred.reject));\n        promise = deferred.get_promise();\n      } else {\n        promise = tab._deferredUtil.resolved(promiseOrValue);\n      }\n    }\n\n    return promise;\n  };\n\n  tab._deferredUtil.reject = function tab__deferredUtil$reject(promiseOrValue) {\n    return tab._deferredUtil.coerceToTrustedPromise(promiseOrValue).then(function (value) {\n      return tab._deferredUtil.rejected(value);\n    }, null);\n  };\n\n  tab._deferredUtil.resolved = function tab__deferredUtil$resolved(value) {\n    var p = new tab._PromiseImpl(function (callback, errback) {\n      try {\n        return tab._deferredUtil.coerceToTrustedPromise(ss.isValue(callback) ? callback(value) : value);\n      } catch (e) {\n        return tab._deferredUtil.rejected(e);\n      }\n    });\n    return p;\n  };\n\n  tab._deferredUtil.rejected = function tab__deferredUtil$rejected(reason) {\n    var p = new tab._PromiseImpl(function (callback, errback) {\n      try {\n        return ss.isValue(errback) ? tab._deferredUtil.coerceToTrustedPromise(errback(reason)) : tab._deferredUtil.rejected(reason);\n      } catch (e) {\n        return tab._deferredUtil.rejected(e);\n      }\n    });\n    return p;\n  };\n\n  tab._deferredUtil.isPromise = function tab__deferredUtil$isPromise(promiseOrValue) {\n    return ss.isValue(promiseOrValue) && typeof promiseOrValue.then === 'function';\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._CollectionImpl\n\n\n  tab._CollectionImpl = function tab__CollectionImpl() {\n    this._items = [];\n    this._itemMap = {};\n  };\n\n  tab._CollectionImpl.prototype = {\n    get__length: function tab__CollectionImpl$get__length() {\n      return this._items.length;\n    },\n    get__rawArray: function tab__CollectionImpl$get__rawArray() {\n      return this._items;\n    },\n    _get: function tab__CollectionImpl$_get(key) {\n      var validKey = this._ensureValidKey(key);\n\n      if (ss.isValue(this._itemMap[validKey])) {\n        return this._itemMap[validKey];\n      }\n\n      return undefined;\n    },\n    _has: function tab__CollectionImpl$_has(key) {\n      return ss.isValue(this._get(key));\n    },\n    _add: function tab__CollectionImpl$_add(key, item) {\n      this._verifyKeyAndItemParameters(key, item);\n\n      var validKey = this._ensureValidKey(key);\n\n      this._items.push(item);\n\n      this._itemMap[validKey] = item;\n    },\n    _addToFirst: function tab__CollectionImpl$_addToFirst(key, item) {\n      this._verifyKeyAndItemParameters(key, item);\n\n      var validKey = this._ensureValidKey(key);\n\n      this._items.unshift(item);\n\n      this._itemMap[validKey] = item;\n    },\n    _remove: function tab__CollectionImpl$_remove(key) {\n      var validKey = this._ensureValidKey(key);\n\n      if (ss.isValue(this._itemMap[validKey])) {\n        var item = this._itemMap[validKey];\n        delete this._itemMap[validKey];\n\n        for (var index = 0; index < this._items.length; index++) {\n          if (this._items[index] === item) {\n            this._items.splice(index, 1);\n\n            break;\n          }\n        }\n      }\n    },\n    _toApiCollection: function tab__CollectionImpl$_toApiCollection() {\n      var clone = this._items.concat();\n\n      clone.get = ss.Delegate.create(this, function (key) {\n        return this._get(key);\n      });\n      clone.has = ss.Delegate.create(this, function (key) {\n        return this._has(key);\n      });\n      return clone;\n    },\n    _verifyUniqueKeyParameter: function tab__CollectionImpl$_verifyUniqueKeyParameter(key) {\n      if (tab._Utility.isNullOrEmpty(key)) {\n        throw new Error('Null key');\n      }\n\n      if (this._has(key)) {\n        throw new Error(\"Duplicate key '\" + key + \"'\");\n      }\n    },\n    _verifyKeyAndItemParameters: function tab__CollectionImpl$_verifyKeyAndItemParameters(key, item) {\n      this._verifyUniqueKeyParameter(key);\n\n      if (ss.isNullOrUndefined(item)) {\n        throw new Error('Null item');\n      }\n    },\n    _ensureValidKey: function tab__CollectionImpl$_ensureValidKey(key) {\n      return '_' + key;\n    },\n    get_item: function tab__CollectionImpl$get_item(index) {\n      return this._items[index];\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._DeferredImpl\n\n  };\n\n  tab._DeferredImpl = function tab__DeferredImpl() {\n    this._listeners = [];\n    this._promise = new tab._PromiseImpl(ss.Delegate.create(this, this.then));\n    this._thenFunc = ss.Delegate.create(this, this._preResolutionThen);\n    this._resolveFunc = ss.Delegate.create(this, this._transitionToFulfilled);\n  };\n\n  tab._DeferredImpl.prototype = {\n    _promise: null,\n    _thenFunc: null,\n    _resolveFunc: null,\n    get_promise: function tab__DeferredImpl$get_promise() {\n      return this._promise;\n    },\n    all: function tab__DeferredImpl$all(promisesOrValues) {\n      var allDone = new tab._DeferredImpl();\n      var length = promisesOrValues.length;\n      var toResolve = length;\n      var results = [];\n\n      if (!length) {\n        allDone.resolve(results);\n        return allDone.get_promise();\n      }\n\n      var resolveOne = function resolveOne(promiseOrValue, index) {\n        var promise = tab._deferredUtil.coerceToTrustedPromise(promiseOrValue);\n\n        promise.then(function (returnValue) {\n          results[index] = returnValue;\n          toResolve--;\n\n          if (!toResolve) {\n            allDone.resolve(results);\n          }\n\n          return null;\n        }, function (e) {\n          allDone.reject(e);\n          return null;\n        });\n      };\n\n      for (var i = 0; i < length; i++) {\n        resolveOne(promisesOrValues[i], i);\n      }\n\n      return allDone.get_promise();\n    },\n    then: function tab__DeferredImpl$then(callback, errback) {\n      return this._thenFunc(callback, errback);\n    },\n    resolve: function tab__DeferredImpl$resolve(promiseOrValue) {\n      return this._resolveFunc(promiseOrValue);\n    },\n    reject: function tab__DeferredImpl$reject(e) {\n      return this._resolveFunc(tab._deferredUtil.rejected(e));\n    },\n    _preResolutionThen: function tab__DeferredImpl$_preResolutionThen(callback, errback) {\n      var deferred = new tab._DeferredImpl();\n\n      this._listeners.push(function (promise) {\n        promise.then(callback, errback).then(ss.Delegate.create(deferred, deferred.resolve), ss.Delegate.create(deferred, deferred.reject));\n      });\n\n      return deferred.get_promise();\n    },\n    _transitionToFulfilled: function tab__DeferredImpl$_transitionToFulfilled(completed) {\n      var completedPromise = tab._deferredUtil.coerceToTrustedPromise(completed);\n\n      this._thenFunc = completedPromise.then;\n      this._resolveFunc = tab._deferredUtil.coerceToTrustedPromise;\n\n      for (var i = 0; i < this._listeners.length; i++) {\n        var listener = this._listeners[i];\n        listener(completedPromise);\n      }\n\n      this._listeners = null;\n      return completedPromise;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._PromiseImpl\n\n  };\n\n  tab._PromiseImpl = function tab__PromiseImpl(thenFunc) {\n    this.then = thenFunc;\n  };\n\n  tab._PromiseImpl.prototype = {\n    then: null,\n    always: function tab__PromiseImpl$always(callback) {\n      return this.then(callback, callback);\n    },\n    otherwise: function tab__PromiseImpl$otherwise(errback) {\n      return this.then(null, errback);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._markImpl\n\n  };\n\n  tab._markImpl = function tab__markImpl(tupleIdOrPairs) {\n    this._collection = new tab._Collection();\n\n    if (tab._jQueryShim.isArray(tupleIdOrPairs)) {\n      var pairArr = tupleIdOrPairs;\n\n      for (var i = 0; i < pairArr.length; i++) {\n        var pair = pairArr[i];\n\n        if (!ss.isValue(pair.fieldName)) {\n          throw tab._TableauException.createInvalidParameter('pair.fieldName');\n        }\n\n        if (!ss.isValue(pair.value)) {\n          throw tab._TableauException.createInvalidParameter('pair.value');\n        }\n\n        var p = new tableauSoftware.Pair(pair.fieldName, pair.value);\n\n        this._collection._add(p.fieldName, p);\n      }\n    } else {\n      this._tupleId = tupleIdOrPairs;\n    }\n  };\n\n  tab._markImpl._processSelectedMarks = function tab__markImpl$_processSelectedMarks(marksPresModel) {\n    var marks = new tab._Collection();\n\n    if (ss.isNullOrUndefined(marksPresModel) || tab._Utility.isNullOrEmpty(marksPresModel.marks)) {\n      return marks;\n    }\n\n    var $enum1 = ss.IEnumerator.getEnumerator(marksPresModel.marks);\n\n    while ($enum1.moveNext()) {\n      var markPresModel = $enum1.current;\n      var tupleId = markPresModel.tupleId;\n      var mark = new tableauSoftware.Mark(tupleId);\n\n      marks._add(tupleId.toString(), mark);\n\n      var $enum2 = ss.IEnumerator.getEnumerator(markPresModel.pairs);\n\n      while ($enum2.moveNext()) {\n        var pairPresModel = $enum2.current;\n\n        var value = tab._Utility.convertRawValue(pairPresModel.value, pairPresModel.valueDataType);\n\n        var pair = new tableauSoftware.Pair(pairPresModel.fieldName, value);\n        pair.formattedValue = pairPresModel.formattedValue;\n\n        if (!mark._impl.get__pairs()._has(pair.fieldName)) {\n          mark._impl._addPair(pair);\n        }\n      }\n    }\n\n    return marks;\n  };\n\n  tab._markImpl.prototype = {\n    _clonedPairs: null,\n    _tupleId: 0,\n    get__pairs: function tab__markImpl$get__pairs() {\n      return this._collection;\n    },\n    get__tupleId: function tab__markImpl$get__tupleId() {\n      return this._tupleId;\n    },\n    get__clonedPairs: function tab__markImpl$get__clonedPairs() {\n      if (this._clonedPairs == null) {\n        this._clonedPairs = this._collection._toApiCollection();\n      }\n\n      return this._clonedPairs;\n    },\n    _addPair: function tab__markImpl$_addPair(pair) {\n      this._collection._add(pair.fieldName, pair);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._Param\n\n  };\n\n  tab._Param = function tab__Param() {};\n\n  tab._Param.verifyString = function tab__Param$verifyString(argumentValue, argumentName) {\n    if (ss.isNullOrUndefined(argumentValue) || !argumentValue.length) {\n      throw tab._TableauException.createInternalStringArgumentException(argumentName);\n    }\n  };\n\n  tab._Param.verifyValue = function tab__Param$verifyValue(argumentValue, argumentName) {\n    if (ss.isNullOrUndefined(argumentValue)) {\n      throw tab._TableauException.createInternalNullArgumentException(argumentName);\n    }\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._parameterImpl\n\n\n  tab._parameterImpl = function tab__parameterImpl(pm) {\n    this._name = pm.name;\n    this._currentValue = tab._Utility.getDataValue(pm.currentValue);\n    this._dataType = pm.dataType;\n    this._allowableValuesType = pm.allowableValuesType;\n\n    if (ss.isValue(pm.allowableValues) && this._allowableValuesType === 'list') {\n      this._allowableValues = [];\n      var $enum1 = ss.IEnumerator.getEnumerator(pm.allowableValues);\n\n      while ($enum1.moveNext()) {\n        var adv = $enum1.current;\n\n        this._allowableValues.push(tab._Utility.getDataValue(adv));\n      }\n    }\n\n    if (this._allowableValuesType === 'range') {\n      this._minValue = tab._Utility.getDataValue(pm.minValue);\n      this._maxValue = tab._Utility.getDataValue(pm.maxValue);\n      this._stepSize = pm.stepSize;\n\n      if ((this._dataType === 'date' || this._dataType === 'datetime') && ss.isValue(this._stepSize) && ss.isValue(pm.dateStepPeriod)) {\n        this._dateStepPeriod = pm.dateStepPeriod;\n      }\n    }\n  };\n\n  tab._parameterImpl.prototype = {\n    _parameter: null,\n    _name: null,\n    _currentValue: null,\n    _dataType: null,\n    _allowableValuesType: null,\n    _allowableValues: null,\n    _minValue: null,\n    _maxValue: null,\n    _stepSize: null,\n    _dateStepPeriod: null,\n    get__parameter: function tab__parameterImpl$get__parameter() {\n      if (this._parameter == null) {\n        this._parameter = new tableauSoftware.Parameter(this);\n      }\n\n      return this._parameter;\n    },\n    get__name: function tab__parameterImpl$get__name() {\n      return this._name;\n    },\n    get__currentValue: function tab__parameterImpl$get__currentValue() {\n      return this._currentValue;\n    },\n    get__dataType: function tab__parameterImpl$get__dataType() {\n      return this._dataType;\n    },\n    get__allowableValuesType: function tab__parameterImpl$get__allowableValuesType() {\n      return this._allowableValuesType;\n    },\n    get__allowableValues: function tab__parameterImpl$get__allowableValues() {\n      return this._allowableValues;\n    },\n    get__minValue: function tab__parameterImpl$get__minValue() {\n      return this._minValue;\n    },\n    get__maxValue: function tab__parameterImpl$get__maxValue() {\n      return this._maxValue;\n    },\n    get__stepSize: function tab__parameterImpl$get__stepSize() {\n      return this._stepSize;\n    },\n    get__dateStepPeriod: function tab__parameterImpl$get__dateStepPeriod() {\n      return this._dateStepPeriod;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._SheetImpl\n\n  };\n\n  tab._SheetImpl = function tab__SheetImpl(sheetInfoImpl, workbookImpl, messagingOptions) {\n    tab._Param.verifyValue(sheetInfoImpl, 'sheetInfoImpl');\n\n    tab._Param.verifyValue(workbookImpl, 'workbookImpl');\n\n    tab._Param.verifyValue(messagingOptions, 'messagingOptions');\n\n    this._name = sheetInfoImpl.name;\n    this._index = sheetInfoImpl.index;\n    this._isActive = sheetInfoImpl.isActive;\n    this._isHidden = sheetInfoImpl.isHidden;\n    this._sheetType = sheetInfoImpl.sheetType;\n    this._size = sheetInfoImpl.size;\n    this._url = sheetInfoImpl.url;\n    this._workbookImpl = workbookImpl;\n    this._messagingOptions = messagingOptions;\n    this._zoneId = sheetInfoImpl.zoneId;\n  };\n\n  tab._SheetImpl._convertValueToIntIfValid = function tab__SheetImpl$_convertValueToIntIfValid(value) {\n    if (ss.isValue(value)) {\n      return tab._Utility.toInt(value);\n    }\n\n    return value;\n  };\n\n  tab._SheetImpl._normalizeSheetSize = function tab__SheetImpl$_normalizeSheetSize(size) {\n    var behavior = tab._enums._normalizeSheetSizeBehavior(size.behavior, 'size.behavior');\n\n    var minSize = size.minSize;\n\n    if (ss.isValue(minSize)) {\n      minSize = tab.$create_Size(tab._SheetImpl._convertValueToIntIfValid(size.minSize.width), tab._SheetImpl._convertValueToIntIfValid(size.minSize.height));\n    }\n\n    var maxSize = size.maxSize;\n\n    if (ss.isValue(maxSize)) {\n      maxSize = tab.$create_Size(tab._SheetImpl._convertValueToIntIfValid(size.maxSize.width), tab._SheetImpl._convertValueToIntIfValid(size.maxSize.height));\n    }\n\n    return tab.$create_SheetSize(behavior, minSize, maxSize);\n  };\n\n  tab._SheetImpl.prototype = {\n    _name: null,\n    _index: 0,\n    _isActive: false,\n    _isHidden: false,\n    _sheetType: null,\n    _size: null,\n    _url: null,\n    _workbookImpl: null,\n    _messagingOptions: null,\n    _parentStoryPointImpl: null,\n    _zoneId: 0,\n    get_name: function tab__SheetImpl$get_name() {\n      return this._name;\n    },\n    get_index: function tab__SheetImpl$get_index() {\n      return this._index;\n    },\n    get_workbookImpl: function tab__SheetImpl$get_workbookImpl() {\n      return this._workbookImpl;\n    },\n    get_workbook: function tab__SheetImpl$get_workbook() {\n      return this._workbookImpl.get_workbook();\n    },\n    get_url: function tab__SheetImpl$get_url() {\n      if (this._isHidden) {\n        throw tab._TableauException.createNoUrlForHiddenWorksheet();\n      }\n\n      return this._url;\n    },\n    get_size: function tab__SheetImpl$get_size() {\n      return this._size;\n    },\n    get_isHidden: function tab__SheetImpl$get_isHidden() {\n      return this._isHidden;\n    },\n    get_isActive: function tab__SheetImpl$get_isActive() {\n      return this._isActive;\n    },\n    set_isActive: function tab__SheetImpl$set_isActive(value) {\n      this._isActive = value;\n      return value;\n    },\n    get_isDashboard: function tab__SheetImpl$get_isDashboard() {\n      return this._sheetType === 'dashboard';\n    },\n    get_sheetType: function tab__SheetImpl$get_sheetType() {\n      return this._sheetType;\n    },\n    get_parentStoryPoint: function tab__SheetImpl$get_parentStoryPoint() {\n      if (ss.isValue(this._parentStoryPointImpl)) {\n        return this._parentStoryPointImpl.get_storyPoint();\n      }\n\n      return null;\n    },\n    get_parentStoryPointImpl: function tab__SheetImpl$get_parentStoryPointImpl() {\n      return this._parentStoryPointImpl;\n    },\n    set_parentStoryPointImpl: function tab__SheetImpl$set_parentStoryPointImpl(value) {\n      if (this._sheetType === 'story') {\n        throw tab._TableauException.createInternalError('A story cannot be a child of another story.');\n      }\n\n      this._parentStoryPointImpl = value;\n      return value;\n    },\n    get_zoneId: function tab__SheetImpl$get_zoneId() {\n      return this._zoneId;\n    },\n    get_messagingOptions: function tab__SheetImpl$get_messagingOptions() {\n      return this._messagingOptions;\n    },\n    changeSizeAsync: function tab__SheetImpl$changeSizeAsync(newSize) {\n      newSize = tab._SheetImpl._normalizeSheetSize(newSize);\n\n      if (this._sheetType === 'worksheet' && newSize.behavior !== 'automatic') {\n        throw tab._TableauException.createInvalidSizeBehaviorOnWorksheet();\n      }\n\n      var deferred = new tab._Deferred();\n\n      if (this._size.behavior === newSize.behavior && newSize.behavior === 'automatic') {\n        deferred.resolve(newSize);\n        return deferred.get_promise();\n      }\n\n      var dict = this._processSheetSize(newSize);\n\n      var param = {};\n      param['api.setSheetSizeName'] = this._name;\n      param['api.minWidth'] = dict['api.minWidth'];\n      param['api.minHeight'] = dict['api.minHeight'];\n      param['api.maxWidth'] = dict['api.maxWidth'];\n      param['api.maxHeight'] = dict['api.maxHeight'];\n      var returnHandler = new tab._CommandReturnHandler('api.SetSheetSizeCommand', 1, ss.Delegate.create(this, function (result) {\n        this.get_workbookImpl()._update(ss.Delegate.create(this, function () {\n          var updatedSize = this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();\n\n          deferred.resolve(updatedSize);\n        }));\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(param, returnHandler);\n      return deferred.get_promise();\n    },\n    sendCommand: function tab__SheetImpl$sendCommand(commandParameters, returnHandler) {\n      this._messagingOptions.sendCommand(commandParameters, returnHandler);\n    },\n    _processSheetSize: function tab__SheetImpl$_processSheetSize(newSize) {\n      var fixedSheetSize = null;\n\n      if (ss.isNullOrUndefined(newSize) || ss.isNullOrUndefined(newSize.behavior) || newSize.behavior !== 'automatic' && ss.isNullOrUndefined(newSize.minSize) && ss.isNullOrUndefined(newSize.maxSize)) {\n        throw tab._TableauException.createInvalidSheetSizeParam();\n      }\n\n      var minWidth = 0;\n      var minHeight = 0;\n      var maxWidth = 0;\n      var maxHeight = 0;\n      var dict = {};\n      dict['api.minWidth'] = 0;\n      dict['api.minHeight'] = 0;\n      dict['api.maxWidth'] = 0;\n      dict['api.maxHeight'] = 0;\n\n      if (newSize.behavior === 'automatic') {\n        fixedSheetSize = tab.$create_SheetSize('automatic', undefined, undefined);\n      } else if (newSize.behavior === 'atmost') {\n        if (ss.isNullOrUndefined(newSize.maxSize) || ss.isNullOrUndefined(newSize.maxSize.width) || ss.isNullOrUndefined(newSize.maxSize.height)) {\n          throw tab._TableauException.createMissingMaxSize();\n        }\n\n        if (newSize.maxSize.width < 0 || newSize.maxSize.height < 0) {\n          throw tab._TableauException.createInvalidSizeValue();\n        }\n\n        dict['api.maxWidth'] = newSize.maxSize.width;\n        dict['api.maxHeight'] = newSize.maxSize.height;\n        fixedSheetSize = tab.$create_SheetSize('atmost', undefined, newSize.maxSize);\n      } else if (newSize.behavior === 'atleast') {\n        if (ss.isNullOrUndefined(newSize.minSize) || ss.isNullOrUndefined(newSize.minSize.width) || ss.isNullOrUndefined(newSize.minSize.height)) {\n          throw tab._TableauException.createMissingMinSize();\n        }\n\n        if (newSize.minSize.width < 0 || newSize.minSize.height < 0) {\n          throw tab._TableauException.createInvalidSizeValue();\n        }\n\n        dict['api.minWidth'] = newSize.minSize.width;\n        dict['api.minHeight'] = newSize.minSize.height;\n        fixedSheetSize = tab.$create_SheetSize('atleast', newSize.minSize, undefined);\n      } else if (newSize.behavior === 'range') {\n        if (ss.isNullOrUndefined(newSize.minSize) || ss.isNullOrUndefined(newSize.maxSize) || ss.isNullOrUndefined(newSize.minSize.width) || ss.isNullOrUndefined(newSize.maxSize.width) || ss.isNullOrUndefined(newSize.minSize.height) || ss.isNullOrUndefined(newSize.maxSize.height)) {\n          throw tab._TableauException.createMissingMinMaxSize();\n        }\n\n        if (newSize.minSize.width < 0 || newSize.minSize.height < 0 || newSize.maxSize.width < 0 || newSize.maxSize.height < 0 || newSize.minSize.width > newSize.maxSize.width || newSize.minSize.height > newSize.maxSize.height) {\n          throw tab._TableauException.createInvalidRangeSize();\n        }\n\n        dict['api.minWidth'] = newSize.minSize.width;\n        dict['api.minHeight'] = newSize.minSize.height;\n        dict['api.maxWidth'] = newSize.maxSize.width;\n        dict['api.maxHeight'] = newSize.maxSize.height;\n        fixedSheetSize = tab.$create_SheetSize('range', newSize.minSize, newSize.maxSize);\n      } else if (newSize.behavior === 'exactly') {\n        if (ss.isValue(newSize.minSize) && ss.isValue(newSize.maxSize) && ss.isValue(newSize.minSize.width) && ss.isValue(newSize.maxSize.width) && ss.isValue(newSize.minSize.height) && ss.isValue(newSize.maxSize.height)) {\n          minWidth = newSize.minSize.width;\n          minHeight = newSize.minSize.height;\n          maxWidth = newSize.maxSize.width;\n          maxHeight = newSize.maxSize.height;\n\n          if (minWidth !== maxWidth || minHeight !== maxHeight) {\n            throw tab._TableauException.createSizeConflictForExactly();\n          }\n        } else if (ss.isValue(newSize.minSize) && ss.isValue(newSize.minSize.width) && ss.isValue(newSize.minSize.height)) {\n          minWidth = newSize.minSize.width;\n          minHeight = newSize.minSize.height;\n          maxWidth = minWidth;\n          maxHeight = minHeight;\n        } else if (ss.isValue(newSize.maxSize) && ss.isValue(newSize.maxSize.width) && ss.isValue(newSize.maxSize.height)) {\n          maxWidth = newSize.maxSize.width;\n          maxHeight = newSize.maxSize.height;\n          minWidth = maxWidth;\n          minHeight = maxHeight;\n        }\n\n        dict['api.minWidth'] = minWidth;\n        dict['api.minHeight'] = minHeight;\n        dict['api.maxWidth'] = maxWidth;\n        dict['api.maxHeight'] = maxHeight;\n        fixedSheetSize = tab.$create_SheetSize('exactly', tab.$create_Size(minWidth, minHeight), tab.$create_Size(maxWidth, maxHeight));\n      }\n\n      this._size = fixedSheetSize;\n      return dict;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._StoryImpl\n\n  };\n\n  tab._StoryImpl = function tab__StoryImpl(sheetInfoImpl, workbookImpl, messagingOptions, storyPm, findSheetFunc) {\n    tab._StoryImpl.initializeBase(this, [sheetInfoImpl, workbookImpl, messagingOptions]);\n\n    tab._Param.verifyValue(storyPm, 'storyPm');\n\n    tab._Param.verifyValue(findSheetFunc, 'findSheetFunc');\n\n    this._findSheetFunc$1 = findSheetFunc;\n    this.update(storyPm);\n  };\n\n  tab._StoryImpl.prototype = {\n    _activeStoryPointImpl$1: null,\n    _findSheetFunc$1: null,\n    _story$1: null,\n    _storyPointsInfo$1: null,\n    add_activeStoryPointChange: function tab__StoryImpl$add_activeStoryPointChange(value) {\n      this.__activeStoryPointChange$1 = ss.Delegate.combine(this.__activeStoryPointChange$1, value);\n    },\n    remove_activeStoryPointChange: function tab__StoryImpl$remove_activeStoryPointChange(value) {\n      this.__activeStoryPointChange$1 = ss.Delegate.remove(this.__activeStoryPointChange$1, value);\n    },\n    __activeStoryPointChange$1: null,\n    get_activeStoryPointImpl: function tab__StoryImpl$get_activeStoryPointImpl() {\n      return this._activeStoryPointImpl$1;\n    },\n    get_sheet: function tab__StoryImpl$get_sheet() {\n      return this.get_story();\n    },\n    get_story: function tab__StoryImpl$get_story() {\n      if (this._story$1 == null) {\n        this._story$1 = new tableauSoftware.Story(this);\n      }\n\n      return this._story$1;\n    },\n    get_storyPointsInfo: function tab__StoryImpl$get_storyPointsInfo() {\n      return this._storyPointsInfo$1;\n    },\n    update: function tab__StoryImpl$update(storyPm) {\n      var activeStoryPointContainedSheetInfo = null;\n      var newActiveStoryPointInfoImpl = null;\n      this._storyPointsInfo$1 = this._storyPointsInfo$1 || new Array(storyPm.storyPoints.length);\n\n      for (var i = 0; i < storyPm.storyPoints.length; i++) {\n        var storyPointPm = storyPm.storyPoints[i];\n        var caption = storyPointPm.caption;\n        var isActive = i === storyPm.activeStoryPointIndex;\n        var storyPointInfoImpl = tab.$create__StoryPointInfoImpl(caption, i, storyPointPm.storyPointId, isActive, storyPointPm.isUpdated, this);\n\n        if (ss.isNullOrUndefined(this._storyPointsInfo$1[i])) {\n          this._storyPointsInfo$1[i] = new tableauSoftware.StoryPointInfo(storyPointInfoImpl);\n        } else if (this._storyPointsInfo$1[i]._impl.storyPointId === storyPointInfoImpl.storyPointId) {\n          var existing = this._storyPointsInfo$1[i]._impl;\n          existing.caption = storyPointInfoImpl.caption;\n          existing.index = storyPointInfoImpl.index;\n          existing.isActive = isActive;\n          existing.isUpdated = storyPointInfoImpl.isUpdated;\n        } else {\n          this._storyPointsInfo$1[i] = new tableauSoftware.StoryPointInfo(storyPointInfoImpl);\n        }\n\n        if (isActive) {\n          activeStoryPointContainedSheetInfo = storyPointPm.containedSheetInfo;\n          newActiveStoryPointInfoImpl = storyPointInfoImpl;\n        }\n      }\n\n      var deleteCount = this._storyPointsInfo$1.length - storyPm.storyPoints.length;\n\n      this._storyPointsInfo$1.splice(storyPm.storyPoints.length, deleteCount);\n\n      var activeStoryPointChanged = ss.isNullOrUndefined(this._activeStoryPointImpl$1) || this._activeStoryPointImpl$1.get_storyPointId() !== newActiveStoryPointInfoImpl.storyPointId;\n\n      if (ss.isValue(this._activeStoryPointImpl$1) && activeStoryPointChanged) {\n        this._activeStoryPointImpl$1.set_isActive(false);\n      }\n\n      var previouslyActiveStoryPoint = this._activeStoryPointImpl$1;\n\n      if (activeStoryPointChanged) {\n        var containedSheetImpl = tab._StoryPointImpl.createContainedSheet(activeStoryPointContainedSheetInfo, this.get_workbookImpl(), this.get_messagingOptions(), this._findSheetFunc$1);\n\n        this._activeStoryPointImpl$1 = new tab._StoryPointImpl(newActiveStoryPointInfoImpl, containedSheetImpl);\n      } else {\n        this._activeStoryPointImpl$1.set_isActive(newActiveStoryPointInfoImpl.isActive);\n\n        this._activeStoryPointImpl$1.set_isUpdated(newActiveStoryPointInfoImpl.isUpdated);\n      }\n\n      if (activeStoryPointChanged && ss.isValue(previouslyActiveStoryPoint)) {\n        this._raiseActiveStoryPointChange$1(this._storyPointsInfo$1[previouslyActiveStoryPoint.get_index()], this._activeStoryPointImpl$1.get_storyPoint());\n      }\n    },\n    activatePreviousStoryPointAsync: function tab__StoryImpl$activatePreviousStoryPointAsync() {\n      return this._activatePreviousNextStoryPointAsync$1('api.ActivatePreviousStoryPoint');\n    },\n    activateNextStoryPointAsync: function tab__StoryImpl$activateNextStoryPointAsync() {\n      return this._activatePreviousNextStoryPointAsync$1('api.ActivateNextStoryPoint');\n    },\n    activateStoryPointAsync: function tab__StoryImpl$activateStoryPointAsync(index) {\n      var deferred = new tab._Deferred();\n\n      if (index < 0 || index >= this._storyPointsInfo$1.length) {\n        throw tab._TableauException.createIndexOutOfRange(index);\n      }\n\n      var previouslyActiveStoryPointImpl = this.get_activeStoryPointImpl();\n      var commandParameters = {};\n      commandParameters['api.storyPointIndex'] = index;\n      var returnHandler = new tab._CommandReturnHandler('api.ActivateStoryPoint', 0, ss.Delegate.create(this, function (result) {\n        var activeStoryPointPm = result;\n\n        this._updateActiveState$1(previouslyActiveStoryPointImpl, activeStoryPointPm);\n\n        deferred.resolve(this._activeStoryPointImpl$1.get_storyPoint());\n      }), function (remoteError, errorMessage) {\n        deferred.reject(tab._TableauException.createServerError(errorMessage));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    revertStoryPointAsync: function tab__StoryImpl$revertStoryPointAsync(index) {\n      index = index || this._activeStoryPointImpl$1.get_index();\n\n      if (index < 0 || index >= this._storyPointsInfo$1.length) {\n        throw tab._TableauException.createIndexOutOfRange(index);\n      }\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      commandParameters['api.storyPointIndex'] = index;\n      var returnHandler = new tab._CommandReturnHandler('api.RevertStoryPoint', 0, ss.Delegate.create(this, function (result) {\n        var updatedStoryPointPm = result;\n\n        this._updateStoryPointInfo$1(index, updatedStoryPointPm);\n\n        deferred.resolve(this._storyPointsInfo$1[index]);\n      }), function (remoteError, errorMessage) {\n        deferred.reject(tab._TableauException.createServerError(errorMessage));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _activatePreviousNextStoryPointAsync$1: function tab__StoryImpl$_activatePreviousNextStoryPointAsync$1(commandName) {\n      if (commandName !== 'api.ActivatePreviousStoryPoint' && commandName !== 'api.ActivateNextStoryPoint') {\n        throw tab._TableauException.createInternalError(\"commandName '\" + commandName + \"' is invalid.\");\n      }\n\n      var deferred = new tab._Deferred();\n      var previouslyActiveStoryPointImpl = this.get_activeStoryPointImpl();\n      var commandParameters = {};\n      var returnHandler = new tab._CommandReturnHandler(commandName, 0, ss.Delegate.create(this, function (result) {\n        var activeStoryPointPm = result;\n\n        this._updateActiveState$1(previouslyActiveStoryPointImpl, activeStoryPointPm);\n\n        deferred.resolve(this._activeStoryPointImpl$1.get_storyPoint());\n      }), function (remoteError, errorMessage) {\n        deferred.reject(tab._TableauException.createServerError(errorMessage));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _updateStoryPointInfo$1: function tab__StoryImpl$_updateStoryPointInfo$1(index, newStoryPointPm) {\n      var existingImpl = this._storyPointsInfo$1[index]._impl;\n\n      if (existingImpl.storyPointId !== newStoryPointPm.storyPointId) {\n        throw tab._TableauException.createInternalError(\"We should not be updating a story point where the IDs don't match. Existing storyPointID=\" + existingImpl.storyPointId + ', newStoryPointID=' + newStoryPointPm.storyPointId);\n      }\n\n      existingImpl.caption = newStoryPointPm.caption;\n      existingImpl.isUpdated = newStoryPointPm.isUpdated;\n\n      if (newStoryPointPm.storyPointId === this._activeStoryPointImpl$1.get_storyPointId()) {\n        this._activeStoryPointImpl$1.set_isUpdated(newStoryPointPm.isUpdated);\n      }\n    },\n    _updateActiveState$1: function tab__StoryImpl$_updateActiveState$1(previouslyActiveStoryPointImpl, newActiveStoryPointPm) {\n      var newActiveIndex = newActiveStoryPointPm.index;\n\n      if (previouslyActiveStoryPointImpl.get_index() === newActiveIndex) {\n        return;\n      }\n\n      var oldStoryPointInfo = this._storyPointsInfo$1[previouslyActiveStoryPointImpl.get_index()];\n\n      var newStoryPointInfoImpl = this._storyPointsInfo$1[newActiveIndex]._impl;\n\n      var containedSheetImpl = tab._StoryPointImpl.createContainedSheet(newActiveStoryPointPm.containedSheetInfo, this.get_workbookImpl(), this.get_messagingOptions(), this._findSheetFunc$1);\n\n      newStoryPointInfoImpl.isActive = true;\n      this._activeStoryPointImpl$1 = new tab._StoryPointImpl(newStoryPointInfoImpl, containedSheetImpl);\n      previouslyActiveStoryPointImpl.set_isActive(false);\n      oldStoryPointInfo._impl.isActive = false;\n\n      this._raiseActiveStoryPointChange$1(oldStoryPointInfo, this._activeStoryPointImpl$1.get_storyPoint());\n    },\n    _raiseActiveStoryPointChange$1: function tab__StoryImpl$_raiseActiveStoryPointChange$1(oldStoryPointInfo, newStoryPoint) {\n      if (this.__activeStoryPointChange$1 != null) {\n        this.__activeStoryPointChange$1(oldStoryPointInfo, newStoryPoint);\n      }\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._StoryPointImpl\n\n  };\n\n  tab._StoryPointImpl = function tab__StoryPointImpl(storyPointInfoImpl, containedSheetImpl) {\n    this._isActive = storyPointInfoImpl.isActive;\n    this._isUpdated = storyPointInfoImpl.isUpdated;\n    this._caption = storyPointInfoImpl.caption;\n    this._index = storyPointInfoImpl.index;\n    this._parentStoryImpl = storyPointInfoImpl.parentStoryImpl;\n    this._storyPointId = storyPointInfoImpl.storyPointId;\n    this._containedSheetImpl = containedSheetImpl;\n\n    if (ss.isValue(containedSheetImpl)) {\n      this._containedSheetImpl.set_parentStoryPointImpl(this);\n\n      if (containedSheetImpl.get_sheetType() === 'dashboard') {\n        var containedDashboardImpl = this._containedSheetImpl;\n\n        for (var i = 0; i < containedDashboardImpl.get_worksheets().get__length(); i++) {\n          var worksheet = containedDashboardImpl.get_worksheets().get_item(i);\n\n          worksheet._impl.set_parentStoryPointImpl(this);\n        }\n      }\n    }\n  };\n\n  tab._StoryPointImpl.createContainedSheet = function tab__StoryPointImpl$createContainedSheet(containedSheetInfo, workbookImpl, messagingOptions, findSheetFunc) {\n    var containedSheetType = containedSheetInfo.sheetType;\n    var index = -1;\n    var size = tab.SheetSizeFactory.createAutomatic();\n    var isActive = false;\n    var publishedSheetInfo = findSheetFunc(containedSheetInfo.name);\n    var isHidden = ss.isNullOrUndefined(publishedSheetInfo);\n    var url = isHidden ? '' : publishedSheetInfo.getUrl();\n    var sheetInfoImpl = tab.$create__SheetInfoImpl(containedSheetInfo.name, containedSheetType, index, size, workbookImpl.get_workbook(), url, isActive, isHidden, containedSheetInfo.zoneId);\n\n    if (containedSheetInfo.sheetType === 'worksheet') {\n      var parentDashboardImpl = null;\n      var worksheetImpl = new tab._WorksheetImpl(sheetInfoImpl, workbookImpl, messagingOptions, parentDashboardImpl);\n      return worksheetImpl;\n    } else if (containedSheetInfo.sheetType === 'dashboard') {\n      var dashboardImpl = new tab._DashboardImpl(sheetInfoImpl, workbookImpl, messagingOptions);\n\n      var dashboardZones = tab._WorkbookImpl._createDashboardZones(containedSheetInfo.dashboardZones);\n\n      dashboardImpl._addObjects(dashboardZones, findSheetFunc);\n\n      return dashboardImpl;\n    } else if (containedSheetInfo.sheetType === 'story') {\n      throw tab._TableauException.createInternalError('Cannot have a story embedded within another story.');\n    } else {\n      throw tab._TableauException.createInternalError(\"Unknown sheet type '\" + containedSheetInfo.sheetType + \"'\");\n    }\n  };\n\n  tab._StoryPointImpl.prototype = {\n    _caption: null,\n    _index: 0,\n    _isActive: false,\n    _isUpdated: false,\n    _containedSheetImpl: null,\n    _parentStoryImpl: null,\n    _storyPoint: null,\n    _storyPointId: 0,\n    get_caption: function tab__StoryPointImpl$get_caption() {\n      return this._caption;\n    },\n    get_containedSheetImpl: function tab__StoryPointImpl$get_containedSheetImpl() {\n      return this._containedSheetImpl;\n    },\n    get_index: function tab__StoryPointImpl$get_index() {\n      return this._index;\n    },\n    get_isActive: function tab__StoryPointImpl$get_isActive() {\n      return this._isActive;\n    },\n    set_isActive: function tab__StoryPointImpl$set_isActive(value) {\n      this._isActive = value;\n      return value;\n    },\n    get_isUpdated: function tab__StoryPointImpl$get_isUpdated() {\n      return this._isUpdated;\n    },\n    set_isUpdated: function tab__StoryPointImpl$set_isUpdated(value) {\n      this._isUpdated = value;\n      return value;\n    },\n    get_parentStoryImpl: function tab__StoryPointImpl$get_parentStoryImpl() {\n      return this._parentStoryImpl;\n    },\n    get_storyPoint: function tab__StoryPointImpl$get_storyPoint() {\n      if (this._storyPoint == null) {\n        this._storyPoint = new tableauSoftware.StoryPoint(this);\n      }\n\n      return this._storyPoint;\n    },\n    get_storyPointId: function tab__StoryPointImpl$get_storyPointId() {\n      return this._storyPointId;\n    },\n    _toInfoImpl: function tab__StoryPointImpl$_toInfoImpl() {\n      return tab.$create__StoryPointInfoImpl(this._caption, this._index, this._storyPointId, this._isActive, this._isUpdated, this._parentStoryImpl);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.StoryPointInfoImplUtil\n\n  };\n\n  tab.StoryPointInfoImplUtil = function tab_StoryPointInfoImplUtil() {};\n\n  tab.StoryPointInfoImplUtil.clone = function tab_StoryPointInfoImplUtil$clone(impl) {\n    return tab.$create__StoryPointInfoImpl(impl.caption, impl.index, impl.storyPointId, impl.isActive, impl.isUpdated, impl.parentStoryImpl);\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._TableauException\n\n\n  tab._TableauException = function tab__TableauException() {};\n\n  tab._TableauException.create = function tab__TableauException$create(id, message) {\n    var x = new Error(message);\n    x.tableauSoftwareErrorCode = id;\n    return x;\n  };\n\n  tab._TableauException.createInternalError = function tab__TableauException$createInternalError(details) {\n    if (ss.isValue(details)) {\n      return tab._TableauException.create('internalError', 'Internal error. Please contact Tableau support with the following information: ' + details);\n    } else {\n      return tab._TableauException.create('internalError', 'Internal error. Please contact Tableau support');\n    }\n  };\n\n  tab._TableauException.createInternalNullArgumentException = function tab__TableauException$createInternalNullArgumentException(argumentName) {\n    return tab._TableauException.createInternalError(\"Null/undefined argument '\" + argumentName + \"'.\");\n  };\n\n  tab._TableauException.createInternalStringArgumentException = function tab__TableauException$createInternalStringArgumentException(argumentName) {\n    return tab._TableauException.createInternalError(\"Invalid string argument '\" + argumentName + \"'.\");\n  };\n\n  tab._TableauException.createServerError = function tab__TableauException$createServerError(message) {\n    return tab._TableauException.create('serverError', message);\n  };\n\n  tab._TableauException.createNotActiveSheet = function tab__TableauException$createNotActiveSheet() {\n    return tab._TableauException.create('notActiveSheet', 'Operation not allowed on non-active sheet');\n  };\n\n  tab._TableauException.createInvalidCustomViewName = function tab__TableauException$createInvalidCustomViewName(customViewName) {\n    return tab._TableauException.create('invalidCustomViewName', 'Invalid custom view name: ' + customViewName);\n  };\n\n  tab._TableauException.createInvalidParameter = function tab__TableauException$createInvalidParameter(paramName) {\n    return tab._TableauException.create('invalidParameter', 'Invalid parameter: ' + paramName);\n  };\n\n  tab._TableauException.createInvalidFilterFieldNameOrValue = function tab__TableauException$createInvalidFilterFieldNameOrValue(fieldName) {\n    return tab._TableauException.create('invalidFilterFieldNameOrValue', 'Invalid filter field name or value: ' + fieldName);\n  };\n\n  tab._TableauException.createInvalidDateParameter = function tab__TableauException$createInvalidDateParameter(paramName) {\n    return tab._TableauException.create('invalidDateParameter', 'Invalid date parameter: ' + paramName);\n  };\n\n  tab._TableauException.createNullOrEmptyParameter = function tab__TableauException$createNullOrEmptyParameter(paramName) {\n    return tab._TableauException.create('nullOrEmptyParameter', 'Parameter cannot be null or empty: ' + paramName);\n  };\n\n  tab._TableauException.createMissingMaxSize = function tab__TableauException$createMissingMaxSize() {\n    return tab._TableauException.create('missingMaxSize', 'Missing maxSize for SheetSizeBehavior.ATMOST');\n  };\n\n  tab._TableauException.createMissingMinSize = function tab__TableauException$createMissingMinSize() {\n    return tab._TableauException.create('missingMinSize', 'Missing minSize for SheetSizeBehavior.ATLEAST');\n  };\n\n  tab._TableauException.createMissingMinMaxSize = function tab__TableauException$createMissingMinMaxSize() {\n    return tab._TableauException.create('missingMinMaxSize', 'Missing minSize or maxSize for SheetSizeBehavior.RANGE');\n  };\n\n  tab._TableauException.createInvalidRangeSize = function tab__TableauException$createInvalidRangeSize() {\n    return tab._TableauException.create('invalidSize', 'Missing minSize or maxSize for SheetSizeBehavior.RANGE');\n  };\n\n  tab._TableauException.createInvalidSizeValue = function tab__TableauException$createInvalidSizeValue() {\n    return tab._TableauException.create('invalidSize', 'Size value cannot be less than zero');\n  };\n\n  tab._TableauException.createInvalidSheetSizeParam = function tab__TableauException$createInvalidSheetSizeParam() {\n    return tab._TableauException.create('invalidSize', 'Invalid sheet size parameter');\n  };\n\n  tab._TableauException.createSizeConflictForExactly = function tab__TableauException$createSizeConflictForExactly() {\n    return tab._TableauException.create('invalidSize', 'Conflicting size values for SheetSizeBehavior.EXACTLY');\n  };\n\n  tab._TableauException.createInvalidSizeBehaviorOnWorksheet = function tab__TableauException$createInvalidSizeBehaviorOnWorksheet() {\n    return tab._TableauException.create('invalidSizeBehaviorOnWorksheet', 'Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets');\n  };\n\n  tab._TableauException.createNoUrlForHiddenWorksheet = function tab__TableauException$createNoUrlForHiddenWorksheet() {\n    return tab._TableauException.create('noUrlForHiddenWorksheet', 'Hidden worksheets do not have a URL.');\n  };\n\n  tab._TableauException._createInvalidAggregationFieldName = function tab__TableauException$_createInvalidAggregationFieldName(fieldName) {\n    return tab._TableauException.create('invalidAggregationFieldName', \"Invalid aggregation type for field '\" + fieldName + \"'\");\n  };\n\n  tab._TableauException.createIndexOutOfRange = function tab__TableauException$createIndexOutOfRange(index) {\n    return tab._TableauException.create('indexOutOfRange', \"Index '\" + index + \"' is out of range.\");\n  };\n\n  tab._TableauException.createUnsupportedEventName = function tab__TableauException$createUnsupportedEventName(eventName) {\n    return tab._TableauException.create('unsupportedEventName', \"Unsupported event '\" + eventName + \"'.\");\n  };\n\n  tab._TableauException.createBrowserNotCapable = function tab__TableauException$createBrowserNotCapable() {\n    return tab._TableauException.create('browserNotCapable', 'This browser is incapable of supporting the Tableau JavaScript API.');\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._Utility\n\n\n  tab._Utility = function tab__Utility() {};\n\n  tab._Utility.hasOwnProperty = function tab__Utility$hasOwnProperty(value, field) {\n    return value.hasOwnProperty(field);\n  };\n\n  tab._Utility.isNullOrEmpty = function tab__Utility$isNullOrEmpty(value) {\n    return ss.isNullOrUndefined(value) || (value['length'] || 0) <= 0;\n  };\n\n  tab._Utility.isString = function tab__Utility$isString(value) {\n    return typeof value === 'string';\n  };\n\n  tab._Utility.isNumber = function tab__Utility$isNumber(value) {\n    return typeof value === 'number';\n  };\n\n  tab._Utility.isDate = function tab__Utility$isDate(value) {\n    if (typeof value === 'object' && value instanceof Date) {\n      return true;\n    } else if (Object.prototype.toString.call(value) !== '[object Date]') {\n      return false;\n    }\n\n    return !isNaN(value.getTime());\n  };\n\n  tab._Utility.isDateValid = function tab__Utility$isDateValid(dt) {\n    return !isNaN(dt.getTime());\n  };\n\n  tab._Utility.indexOf = function tab__Utility$indexOf(array, searchElement, fromIndex) {\n    if (ss.isValue(Array.prototype['indexOf'])) {\n      return array.indexOf(searchElement, fromIndex);\n    }\n\n    fromIndex = fromIndex || 0;\n    var length = array.length;\n\n    if (length > 0) {\n      for (var index = fromIndex; index < length; index++) {\n        if (array[index] === searchElement) {\n          return index;\n        }\n      }\n    }\n\n    return -1;\n  };\n\n  tab._Utility.contains = function tab__Utility$contains(array, searchElement, fromIndex) {\n    var index = tab._Utility.indexOf(array, searchElement, fromIndex);\n\n    return index >= 0;\n  };\n\n  tab._Utility.getTopmostWindow = function tab__Utility$getTopmostWindow() {\n    var win = window.self;\n\n    while (ss.isValue(win.parent) && win.parent !== win) {\n      win = win.parent;\n    }\n\n    return win;\n  };\n\n  tab._Utility.toInt = function tab__Utility$toInt(value) {\n    if (tab._Utility.isNumber(value)) {\n      return value;\n    }\n\n    return parseInt(value.toString(), 10);\n  };\n\n  tab._Utility.hasClass = function tab__Utility$hasClass(element, className) {\n    var regexClass = new RegExp('[\\\\n\\\\t\\\\r]', 'g');\n    return ss.isValue(element) && (' ' + element.className + ' ').replace(regexClass, ' ').indexOf(' ' + className + ' ') > -1;\n  };\n\n  tab._Utility.findParentWithClassName = function tab__Utility$findParentWithClassName(element, className, stopAtElement) {\n    var parent = ss.isValue(element) ? element.parentNode : null;\n    stopAtElement = stopAtElement || document.body;\n\n    while (parent != null) {\n      if (tab._Utility.hasClass(parent, className)) {\n        return parent;\n      }\n\n      if (parent === stopAtElement) {\n        parent = null;\n      } else {\n        parent = parent.parentNode;\n      }\n    }\n\n    return parent;\n  };\n\n  tab._Utility.hasJsonParse = function tab__Utility$hasJsonParse() {\n    return ss.isValue(window.JSON) && ss.isValue(window.JSON.parse);\n  };\n\n  tab._Utility.hasWindowPostMessage = function tab__Utility$hasWindowPostMessage() {\n    return ss.isValue(window.postMessage);\n  };\n\n  tab._Utility.isPostMessageSynchronous = function tab__Utility$isPostMessageSynchronous() {\n    if (tab._Utility.isIE()) {\n      var msieRegEx = new RegExp('(msie) ([\\\\w.]+)');\n      var matches = msieRegEx.exec(window.navigator.userAgent.toLowerCase());\n      var versionStr = matches[2] || '0';\n      var version = parseInt(versionStr, 10);\n      return version <= 8;\n    }\n\n    return false;\n  };\n\n  tab._Utility.hasDocumentAttachEvent = function tab__Utility$hasDocumentAttachEvent() {\n    return ss.isValue(document.attachEvent);\n  };\n\n  tab._Utility.hasWindowAddEventListener = function tab__Utility$hasWindowAddEventListener() {\n    return ss.isValue(window.addEventListener);\n  };\n\n  tab._Utility.isElementOfTag = function tab__Utility$isElementOfTag(element, tagName) {\n    return ss.isValue(element) && element.nodeType === 1 && element.tagName.toLowerCase() === tagName.toLowerCase();\n  };\n\n  tab._Utility.elementToString = function tab__Utility$elementToString(element) {\n    var str = new ss.StringBuilder();\n    str.append(element.tagName.toLowerCase());\n\n    if (!tab._Utility.isNullOrEmpty(element.id)) {\n      str.append('#').append(element.id);\n    }\n\n    if (!tab._Utility.isNullOrEmpty(element.className)) {\n      var classes = element.className.split(' ');\n      str.append('.').append(classes.join('.'));\n    }\n\n    return str.toString();\n  };\n\n  tab._Utility.tableauGCS = function tab__Utility$tableauGCS(e) {\n    if (ss.isValue(window.getComputedStyle)) {\n      return window.getComputedStyle(e);\n    } else {\n      return e.currentStyle;\n    }\n  };\n\n  tab._Utility.isIE = function tab__Utility$isIE() {\n    return window.navigator.userAgent.indexOf('MSIE') > -1 && ss.isNullOrUndefined(window.opera);\n  };\n\n  tab._Utility.isSafari = function tab__Utility$isSafari() {\n    var ua = window.navigator.userAgent;\n    var isChrome = ua.indexOf('Chrome') >= 0;\n    return ua.indexOf('Safari') >= 0 && !isChrome;\n  };\n\n  tab._Utility.mobileDetect = function tab__Utility$mobileDetect() {\n    var ua = window.navigator.userAgent;\n\n    if (ua.indexOf('iPad') !== -1) {\n      return true;\n    }\n\n    if (ua.indexOf('Android') !== -1) {\n      return true;\n    }\n\n    if (ua.indexOf('AppleWebKit') !== -1 && ua.indexOf('Mobile') !== -1) {\n      return true;\n    }\n\n    return false;\n  };\n\n  tab._Utility.elementOffset = function tab__Utility$elementOffset(element) {\n    var rect = null;\n    rect = element.getBoundingClientRect();\n    var elementTop = rect.top;\n    var elementLeft = rect.left;\n    var win = new tab.WindowHelper(window.self);\n    var docElement = window.document.documentElement;\n    var x = elementLeft + win.get_pageXOffset() - docElement.clientLeft;\n    var y = elementTop + win.get_pageYOffset() - docElement.clientTop;\n    return tab.$create_Point(x, y);\n  };\n\n  tab._Utility.convertRawValue = function tab__Utility$convertRawValue(rawValue, dataType) {\n    if (ss.isNullOrUndefined(rawValue)) {\n      return null;\n    }\n\n    switch (dataType) {\n      case 'bool':\n        return rawValue;\n\n      case 'date':\n        return new Date(rawValue);\n\n      case 'number':\n        if (rawValue == null) {\n          return Number.NaN;\n        }\n\n        return rawValue;\n\n      case 'string':\n      default:\n        return rawValue;\n    }\n  };\n\n  tab._Utility.getDataValue = function tab__Utility$getDataValue(dv) {\n    if (ss.isNullOrUndefined(dv)) {\n      return tab.$create_DataValue(null, null, null);\n    }\n\n    return tab.$create_DataValue(tab._Utility.convertRawValue(dv.value, dv.type), dv.formattedValue, dv.aliasedValue);\n  };\n\n  tab._Utility.serializeDateForServer = function tab__Utility$serializeDateForServer(date) {\n    var serializedDate = '';\n\n    if (ss.isValue(date) && tab._Utility.isDate(date)) {\n      var year = date.getUTCFullYear();\n      var month = date.getUTCMonth() + 1;\n      var day = date.getUTCDate();\n      var hh = date.getUTCHours();\n      var mm = date.getUTCMinutes();\n      var sec = date.getUTCSeconds();\n      serializedDate = year + '-' + month + '-' + day + ' ' + hh + ':' + mm + ':' + sec;\n    }\n\n    return serializedDate;\n  };\n\n  tab._Utility.computeContentSize = function tab__Utility$computeContentSize(element) {\n    var style = tab._Utility._getComputedStyle(element);\n\n    var paddingLeft = parseFloat(style.paddingLeft);\n    var paddingTop = parseFloat(style.paddingTop);\n    var paddingRight = parseFloat(style.paddingRight);\n    var paddingBottom = parseFloat(style.paddingBottom);\n    var width = element.clientWidth - Math.round(paddingLeft + paddingRight);\n    var height = element.clientHeight - Math.round(paddingTop + paddingBottom);\n    return tab.$create_Size(width, height);\n  };\n\n  tab._Utility._getComputedStyle = function tab__Utility$_getComputedStyle(element) {\n    if (ss.isValue(window.getComputedStyle)) {\n      if (ss.isValue(element.ownerDocument.defaultView.opener)) {\n        return element.ownerDocument.defaultView.getComputedStyle(element, null);\n      }\n\n      return window.getComputedStyle(element, null);\n    } else if (ss.isValue(element.currentStyle)) {\n      return element.currentStyle;\n    }\n\n    return element.style;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.VizImpl\n\n\n  tab.VizImpl = function tab_VizImpl(messageRouter, viz, parentElement, url, options) {\n    if (!tab._Utility.hasWindowPostMessage() || !tab._Utility.hasJsonParse()) {\n      throw tab._TableauException.createBrowserNotCapable();\n    }\n\n    this._messagingOptions = new tab.CrossDomainMessagingOptions(messageRouter, this);\n    this._viz = viz;\n\n    if (ss.isNullOrUndefined(parentElement) || parentElement.nodeType !== 1) {\n      parentElement = document.body;\n    }\n\n    this._parameters = new tab._VizParameters(parentElement, url, options);\n\n    if (ss.isValue(options)) {\n      this._onFirstInteractiveCallback = options.onFirstInteractive;\n      this._onFirstVizSizeKnownCallback = options.onFirstVizSizeKnown;\n    }\n  };\n\n  tab.VizImpl.prototype = {\n    _workbookTabSwitchHandler: null,\n    _viz: null,\n    _iframe: null,\n    _parameters: null,\n    _initialAvailableSize: null,\n    _instanceId: null,\n    _workbookImpl: null,\n    _onFirstInteractiveCallback: null,\n    _onFirstVizSizeKnownCallback: null,\n    _onFirstInteractiveAlreadyCalled: false,\n    _areTabsHidden: false,\n    _isToolbarHidden: false,\n    _areAutomaticUpdatesPaused: false,\n    _messagingOptions: null,\n    _vizSize: null,\n    _windowResizeHandler: null,\n    _initializingWorkbookImpl: false,\n    add_customViewsListLoad: function tab_VizImpl$add_customViewsListLoad(value) {\n      this.__customViewsListLoad = ss.Delegate.combine(this.__customViewsListLoad, value);\n    },\n    remove_customViewsListLoad: function tab_VizImpl$remove_customViewsListLoad(value) {\n      this.__customViewsListLoad = ss.Delegate.remove(this.__customViewsListLoad, value);\n    },\n    __customViewsListLoad: null,\n    add_stateReadyForQuery: function tab_VizImpl$add_stateReadyForQuery(value) {\n      this.__stateReadyForQuery = ss.Delegate.combine(this.__stateReadyForQuery, value);\n    },\n    remove_stateReadyForQuery: function tab_VizImpl$remove_stateReadyForQuery(value) {\n      this.__stateReadyForQuery = ss.Delegate.remove(this.__stateReadyForQuery, value);\n    },\n    __stateReadyForQuery: null,\n    add__marksSelection: function tab_VizImpl$add__marksSelection(value) {\n      this.__marksSelection = ss.Delegate.combine(this.__marksSelection, value);\n    },\n    remove__marksSelection: function tab_VizImpl$remove__marksSelection(value) {\n      this.__marksSelection = ss.Delegate.remove(this.__marksSelection, value);\n    },\n    __marksSelection: null,\n    add__filterChange: function tab_VizImpl$add__filterChange(value) {\n      this.__filterChange = ss.Delegate.combine(this.__filterChange, value);\n    },\n    remove__filterChange: function tab_VizImpl$remove__filterChange(value) {\n      this.__filterChange = ss.Delegate.remove(this.__filterChange, value);\n    },\n    __filterChange: null,\n    add__parameterValueChange: function tab_VizImpl$add__parameterValueChange(value) {\n      this.__parameterValueChange = ss.Delegate.combine(this.__parameterValueChange, value);\n    },\n    remove__parameterValueChange: function tab_VizImpl$remove__parameterValueChange(value) {\n      this.__parameterValueChange = ss.Delegate.remove(this.__parameterValueChange, value);\n    },\n    __parameterValueChange: null,\n    add__customViewLoad: function tab_VizImpl$add__customViewLoad(value) {\n      this.__customViewLoad = ss.Delegate.combine(this.__customViewLoad, value);\n    },\n    remove__customViewLoad: function tab_VizImpl$remove__customViewLoad(value) {\n      this.__customViewLoad = ss.Delegate.remove(this.__customViewLoad, value);\n    },\n    __customViewLoad: null,\n    add__customViewSave: function tab_VizImpl$add__customViewSave(value) {\n      this.__customViewSave = ss.Delegate.combine(this.__customViewSave, value);\n    },\n    remove__customViewSave: function tab_VizImpl$remove__customViewSave(value) {\n      this.__customViewSave = ss.Delegate.remove(this.__customViewSave, value);\n    },\n    __customViewSave: null,\n    add__customViewRemove: function tab_VizImpl$add__customViewRemove(value) {\n      this.__customViewRemove = ss.Delegate.combine(this.__customViewRemove, value);\n    },\n    remove__customViewRemove: function tab_VizImpl$remove__customViewRemove(value) {\n      this.__customViewRemove = ss.Delegate.remove(this.__customViewRemove, value);\n    },\n    __customViewRemove: null,\n    add__customViewSetDefault: function tab_VizImpl$add__customViewSetDefault(value) {\n      this.__customViewSetDefault = ss.Delegate.combine(this.__customViewSetDefault, value);\n    },\n    remove__customViewSetDefault: function tab_VizImpl$remove__customViewSetDefault(value) {\n      this.__customViewSetDefault = ss.Delegate.remove(this.__customViewSetDefault, value);\n    },\n    __customViewSetDefault: null,\n    add__tabSwitch: function tab_VizImpl$add__tabSwitch(value) {\n      this.__tabSwitch = ss.Delegate.combine(this.__tabSwitch, value);\n    },\n    remove__tabSwitch: function tab_VizImpl$remove__tabSwitch(value) {\n      this.__tabSwitch = ss.Delegate.remove(this.__tabSwitch, value);\n    },\n    __tabSwitch: null,\n    add__storyPointSwitch: function tab_VizImpl$add__storyPointSwitch(value) {\n      this.__storyPointSwitch = ss.Delegate.combine(this.__storyPointSwitch, value);\n    },\n    remove__storyPointSwitch: function tab_VizImpl$remove__storyPointSwitch(value) {\n      this.__storyPointSwitch = ss.Delegate.remove(this.__storyPointSwitch, value);\n    },\n    __storyPointSwitch: null,\n    add__vizResize: function tab_VizImpl$add__vizResize(value) {\n      this.__vizResize = ss.Delegate.combine(this.__vizResize, value);\n    },\n    remove__vizResize: function tab_VizImpl$remove__vizResize(value) {\n      this.__vizResize = ss.Delegate.remove(this.__vizResize, value);\n    },\n    __vizResize: null,\n    get_handlerId: function tab_VizImpl$get_handlerId() {\n      return this._parameters.handlerId;\n    },\n    set_handlerId: function tab_VizImpl$set_handlerId(value) {\n      this._parameters.handlerId = value;\n      return value;\n    },\n    get_iframe: function tab_VizImpl$get_iframe() {\n      return this._iframe;\n    },\n    get_instanceId: function tab_VizImpl$get_instanceId() {\n      return this._instanceId;\n    },\n    get_serverRoot: function tab_VizImpl$get_serverRoot() {\n      return this._parameters.serverRoot;\n    },\n    get__viz: function tab_VizImpl$get__viz() {\n      return this._viz;\n    },\n    get__areTabsHidden: function tab_VizImpl$get__areTabsHidden() {\n      return this._areTabsHidden;\n    },\n    get__isToolbarHidden: function tab_VizImpl$get__isToolbarHidden() {\n      return this._isToolbarHidden;\n    },\n    get__isHidden: function tab_VizImpl$get__isHidden() {\n      return this._iframe.style.display === 'none';\n    },\n    get__parentElement: function tab_VizImpl$get__parentElement() {\n      return this._parameters.parentElement;\n    },\n    get__url: function tab_VizImpl$get__url() {\n      return this._parameters.get_baseUrl();\n    },\n    get__workbook: function tab_VizImpl$get__workbook() {\n      return this._workbookImpl.get_workbook();\n    },\n    get__workbookImpl: function tab_VizImpl$get__workbookImpl() {\n      return this._workbookImpl;\n    },\n    get__areAutomaticUpdatesPaused: function tab_VizImpl$get__areAutomaticUpdatesPaused() {\n      return this._areAutomaticUpdatesPaused;\n    },\n    get__vizSize: function tab_VizImpl$get__vizSize() {\n      return this._vizSize;\n    },\n    getCurrentUrlAsync: function tab_VizImpl$getCurrentUrlAsync() {\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.GetCurrentUrlCommand', 0, function (result) {\n        deferred.resolve(result);\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createInternalError(message));\n      });\n\n      this._sendCommand(null, returnHandler);\n\n      return deferred.get_promise();\n    },\n    handleVizLoad: function tab_VizImpl$handleVizLoad() {\n      this._sendVizOffset();\n\n      if (ss.isNullOrUndefined(this._workbookImpl)) {\n        this._workbookImpl = new tab._WorkbookImpl(this, this._messagingOptions, ss.Delegate.create(this, function () {\n          this._onWorkbookInteractive();\n        }));\n      } else if (!this._initializingWorkbookImpl) {\n        this._workbookImpl._update(ss.Delegate.create(this, function () {\n          this._onWorkbookInteractive();\n        }));\n      }\n    },\n    _calculateFrameSize: function tab_VizImpl$_calculateFrameSize(availableSize) {\n      var chromeHeight = this._vizSize.chromeHeight;\n      var sheetSize = this._vizSize.sheetSize;\n      var width = 0;\n      var height = 0;\n\n      if (sheetSize.behavior === 'exactly') {\n        width = sheetSize.maxSize.width;\n        height = sheetSize.maxSize.height + chromeHeight;\n      } else {\n        var minWidth;\n        var maxWidth;\n        var minHeight;\n        var maxHeight;\n\n        switch (sheetSize.behavior) {\n          case 'range':\n            minWidth = sheetSize.minSize.width;\n            maxWidth = sheetSize.maxSize.width;\n            minHeight = sheetSize.minSize.height + chromeHeight;\n            maxHeight = sheetSize.maxSize.height + chromeHeight;\n            width = Math.max(minWidth, Math.min(maxWidth, availableSize.width));\n            height = Math.max(minHeight, Math.min(maxHeight, availableSize.height));\n            break;\n\n          case 'atleast':\n            minWidth = sheetSize.minSize.width;\n            minHeight = sheetSize.minSize.height + chromeHeight;\n            width = Math.max(minWidth, availableSize.width);\n            height = Math.max(minHeight, availableSize.height);\n            break;\n\n          case 'atmost':\n            maxWidth = sheetSize.maxSize.width;\n            maxHeight = sheetSize.maxSize.height + chromeHeight;\n            width = Math.min(maxWidth, availableSize.width);\n            height = Math.min(maxHeight, availableSize.height);\n            break;\n\n          case 'automatic':\n            width = availableSize.width;\n            height = Math.max(availableSize.height, chromeHeight);\n            break;\n\n          default:\n            throw tab._TableauException.createInternalError('Unknown SheetSizeBehavior for viz: ' + sheetSize.behavior);\n        }\n      }\n\n      return tab.$create_Size(width, height);\n    },\n    _getNewFrameSize: function tab_VizImpl$_getNewFrameSize() {\n      var availableSize;\n\n      if (ss.isValue(this._initialAvailableSize)) {\n        availableSize = this._initialAvailableSize;\n        this._initialAvailableSize = null;\n      } else {\n        availableSize = tab._Utility.computeContentSize(this.get__parentElement());\n      }\n\n      this._raiseVizResizeEvent(availableSize);\n\n      return this._calculateFrameSize(availableSize);\n    },\n    _refreshSize: function tab_VizImpl$_refreshSize() {\n      var frameSize = this._getNewFrameSize();\n\n      this._setFrameSize(frameSize.width + 'px', frameSize.height + 'px');\n\n      var resizeAttempts = 10;\n\n      for (var i = 0; i < resizeAttempts; i++) {\n        var newFrameSize = this._getNewFrameSize();\n\n        if (JSON.stringify(frameSize) === JSON.stringify(newFrameSize)) {\n          return;\n        }\n\n        frameSize = newFrameSize;\n\n        this._setFrameSize(frameSize.width + 'px', frameSize.height + 'px');\n      }\n\n      throw tab._TableauException.create('maxVizResizeAttempts', 'Viz resize limit hit. The calculated iframe size did not stabilize after ' + resizeAttempts + ' resizes.');\n    },\n    handleEventNotification: function tab_VizImpl$handleEventNotification(eventName, eventParameters) {\n      var notif = tab._ApiServerNotification.deserialize(eventParameters);\n\n      if (eventName === 'api.FirstVizSizeKnownEvent') {\n        var size = JSON.parse(notif.get_data());\n\n        this._handleInitialVizSize(size);\n      } else if (eventName === 'api.VizInteractiveEvent') {\n        this._instanceId = notif.get_data();\n\n        if (ss.isValue(this._workbookImpl) && this._workbookImpl.get_name() === notif.get_workbookName()) {\n          this._onWorkbookInteractive();\n        }\n\n        this._raiseStateReadyForQuery();\n      } else if (eventName === 'api.MarksSelectionChangedEvent') {\n        if (this.__marksSelection != null) {\n          if (this._workbookImpl.get_name() === notif.get_workbookName()) {\n            var worksheetImpl = null;\n\n            var activeSheetImpl = this._workbookImpl.get_activeSheetImpl();\n\n            if (activeSheetImpl.get_name() === notif.get_worksheetName()) {\n              worksheetImpl = activeSheetImpl;\n            } else if (activeSheetImpl.get_isDashboard()) {\n              var db = activeSheetImpl;\n              worksheetImpl = db.get_worksheets()._get(notif.get_worksheetName())._impl;\n            }\n\n            if (ss.isValue(worksheetImpl)) {\n              worksheetImpl.set_selectedMarks(null);\n\n              this.__marksSelection(new tab.MarksEvent('marksselection', this._viz, worksheetImpl));\n            }\n          }\n        }\n      } else if (eventName === 'api.FilterChangedEvent') {\n        if (this.__filterChange != null) {\n          if (this._workbookImpl.get_name() === notif.get_workbookName()) {\n            var worksheetImpl = null;\n\n            var activeSheetImpl = this._workbookImpl.get_activeSheetImpl();\n\n            if (activeSheetImpl.get_name() === notif.get_worksheetName()) {\n              worksheetImpl = activeSheetImpl;\n            } else if (activeSheetImpl.get_isDashboard()) {\n              var db = activeSheetImpl;\n              worksheetImpl = db.get_worksheets()._get(notif.get_worksheetName())._impl;\n            }\n\n            if (ss.isValue(worksheetImpl)) {\n              var results = JSON.parse(notif.get_data());\n              var filterFieldName = results[0];\n              var filterCaption = results[1];\n\n              this.__filterChange(new tab.FilterEvent('filterchange', this._viz, worksheetImpl, filterFieldName, filterCaption));\n            }\n          }\n        }\n      } else if (eventName === 'api.ParameterChangedEvent') {\n        if (this.__parameterValueChange != null) {\n          if (this._workbookImpl.get_name() === notif.get_workbookName()) {\n            this._workbookImpl.set__lastChangedParameterImpl(null);\n\n            var parameterName = notif.get_data();\n\n            this._raiseParameterValueChange(parameterName);\n          }\n        }\n      } else if (eventName === 'api.CustomViewsListLoadedEvent') {\n        var info = JSON.parse(notif.get_data());\n        var process = ss.Delegate.create(this, function () {\n          tab._CustomViewImpl._processCustomViews(this._workbookImpl, this._messagingOptions, info);\n        });\n        var raiseEvents = ss.Delegate.create(this, function () {\n          this._raiseCustomViewsListLoad();\n\n          if (this.__customViewLoad != null && !info.customViewLoaded) {\n            this._raiseCustomViewLoad(this._workbookImpl.get_activeCustomView());\n          }\n        });\n\n        if (ss.isNullOrUndefined(this._workbookImpl)) {\n          this._initializingWorkbookImpl = true;\n          this._workbookImpl = new tab._WorkbookImpl(this, this._messagingOptions, ss.Delegate.create(this, function () {\n            process();\n\n            this._onWorkbookInteractive(raiseEvents);\n\n            this._initializingWorkbookImpl = false;\n          }));\n        } else {\n          process();\n\n          this._ensureCalledAfterFirstInteractive(raiseEvents);\n        }\n      } else if (eventName === 'api.CustomViewUpdatedEvent') {\n        var info = JSON.parse(notif.get_data());\n\n        if (ss.isNullOrUndefined(this._workbookImpl)) {\n          this._workbookImpl = new tab._WorkbookImpl(this, this._messagingOptions, ss.Delegate.create(this, function () {\n            this._onWorkbookInteractive();\n          }));\n        }\n\n        if (ss.isValue(this._workbookImpl)) {\n          tab._CustomViewImpl._processCustomViewUpdate(this._workbookImpl, this._messagingOptions, info, true);\n        }\n\n        if (this.__customViewSave != null) {\n          var updated = this._workbookImpl.get__updatedCustomViews()._toApiCollection();\n\n          for (var i = 0, len = updated.length; i < len; i++) {\n            this._raiseCustomViewSave(updated[i]);\n          }\n        }\n      } else if (eventName === 'api.CustomViewRemovedEvent') {\n        if (this.__customViewRemove != null) {\n          var removed = this._workbookImpl.get__removedCustomViews()._toApiCollection();\n\n          for (var i = 0, len = removed.length; i < len; i++) {\n            this._raiseCustomViewRemove(removed[i]);\n          }\n        }\n      } else if (eventName === 'api.CustomViewSetDefaultEvent') {\n        var info = JSON.parse(notif.get_data());\n\n        if (ss.isValue(this._workbookImpl)) {\n          tab._CustomViewImpl._processCustomViews(this._workbookImpl, this._messagingOptions, info);\n        }\n\n        if (this.__customViewSetDefault != null) {\n          var updated = this._workbookImpl.get__updatedCustomViews()._toApiCollection();\n\n          for (var i = 0, len = updated.length; i < len; i++) {\n            this._raiseCustomViewSetDefault(updated[i]);\n          }\n        }\n      } else if (eventName === 'api.TabSwitchEvent') {\n        this._workbookImpl._update(ss.Delegate.create(this, function () {\n          if (ss.isValue(this._workbookTabSwitchHandler)) {\n            this._workbookTabSwitchHandler();\n          }\n\n          if (this._workbookImpl.get_name() === notif.get_workbookName()) {\n            var oldSheetName = notif.get_worksheetName();\n            var currSheetName = notif.get_data();\n\n            this._raiseTabSwitch(oldSheetName, currSheetName);\n          }\n\n          this._onWorkbookInteractive();\n        }));\n      } else if (eventName === 'api.StorytellingStateChangedEvent') {\n        var storyImpl = this._workbookImpl.get_activeSheetImpl();\n\n        if (storyImpl.get_sheetType() === 'story') {\n          storyImpl.update(JSON.parse(notif.get_data()));\n        }\n      }\n    },\n    addEventListener: function tab_VizImpl$addEventListener(eventName, handler) {\n      var normalizedEventName = tab._enums._normalizeTableauEventName(eventName);\n\n      if (normalizedEventName === 'marksselection') {\n        this.add__marksSelection(handler);\n      } else if (normalizedEventName === 'parametervaluechange') {\n        this.add__parameterValueChange(handler);\n      } else if (normalizedEventName === 'filterchange') {\n        this.add__filterChange(handler);\n      } else if (normalizedEventName === 'customviewload') {\n        this.add__customViewLoad(handler);\n      } else if (normalizedEventName === 'customviewsave') {\n        this.add__customViewSave(handler);\n      } else if (normalizedEventName === 'customviewremove') {\n        this.add__customViewRemove(handler);\n      } else if (normalizedEventName === 'customviewsetdefault') {\n        this.add__customViewSetDefault(handler);\n      } else if (normalizedEventName === 'tabswitch') {\n        this.add__tabSwitch(handler);\n      } else if (normalizedEventName === 'storypointswitch') {\n        this.add__storyPointSwitch(handler);\n      } else if (normalizedEventName === 'vizresize') {\n        this.add__vizResize(handler);\n      } else {\n        throw tab._TableauException.createUnsupportedEventName(eventName);\n      }\n    },\n    removeEventListener: function tab_VizImpl$removeEventListener(eventName, handler) {\n      var normalizedEventName = tab._enums._normalizeTableauEventName(eventName);\n\n      if (normalizedEventName === 'marksselection') {\n        this.remove__marksSelection(handler);\n      } else if (normalizedEventName === 'parametervaluechange') {\n        this.remove__parameterValueChange(handler);\n      } else if (normalizedEventName === 'filterchange') {\n        this.remove__filterChange(handler);\n      } else if (normalizedEventName === 'customviewload') {\n        this.remove__customViewLoad(handler);\n      } else if (normalizedEventName === 'customviewsave') {\n        this.remove__customViewSave(handler);\n      } else if (normalizedEventName === 'customviewremove') {\n        this.remove__customViewRemove(handler);\n      } else if (normalizedEventName === 'customviewsetdefault') {\n        this.remove__customViewSetDefault(handler);\n      } else if (normalizedEventName === 'tabswitch') {\n        this.remove__tabSwitch(handler);\n      } else if (normalizedEventName === 'storypointswitch') {\n        this.remove__storyPointSwitch(handler);\n      } else if (normalizedEventName === 'vizresize') {\n        this.remove__vizResize(handler);\n      } else {\n        throw tab._TableauException.createUnsupportedEventName(eventName);\n      }\n    },\n    _dispose: function tab_VizImpl$_dispose() {\n      if (ss.isValue(this._iframe)) {\n        this._iframe.parentNode.removeChild(this._iframe);\n\n        this._iframe = null;\n      }\n\n      tab._VizManagerImpl._unregisterViz(this._viz);\n\n      this._messagingOptions.get_router().unregisterHandler(this);\n\n      this._removeWindowResizeHandler();\n    },\n    _show: function tab_VizImpl$_show() {\n      this._iframe.style.display = 'block';\n      this._iframe.style.visibility = 'visible';\n    },\n    _hide: function tab_VizImpl$_hide() {\n      this._iframe.style.display = 'none';\n    },\n    _makeInvisible: function tab_VizImpl$_makeInvisible() {\n      this._iframe.style.visibility = 'hidden';\n    },\n    _showExportImageDialog: function tab_VizImpl$_showExportImageDialog() {\n      this._invokeCommand('showExportImageDialog');\n    },\n    _showExportDataDialog: function tab_VizImpl$_showExportDataDialog(sheetOrInfoOrName) {\n      var sheetName = this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName);\n\n      this._invokeCommand('showExportDataDialog', sheetName);\n    },\n    _showExportCrossTabDialog: function tab_VizImpl$_showExportCrossTabDialog(sheetOrInfoOrName) {\n      var sheetName = this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName);\n\n      this._invokeCommand('showExportCrosstabDialog', sheetName);\n    },\n    _showExportPDFDialog: function tab_VizImpl$_showExportPDFDialog() {\n      this._invokeCommand('showExportPDFDialog');\n    },\n    _revertAllAsync: function tab_VizImpl$_revertAllAsync() {\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.RevertAllCommand', 1, function (result) {\n        deferred.resolve();\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(null, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _refreshDataAsync: function tab_VizImpl$_refreshDataAsync() {\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.RefreshDataCommand', 1, function (result) {\n        deferred.resolve();\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(null, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _showShareDialog: function tab_VizImpl$_showShareDialog() {\n      this._invokeCommand('showShareDialog');\n    },\n    _showDownloadWorkbookDialog: function tab_VizImpl$_showDownloadWorkbookDialog() {\n      if (this.get__workbookImpl().get_isDownloadAllowed()) {\n        this._invokeCommand('showDownloadWorkbookDialog');\n      } else {\n        throw tab._TableauException.create('downloadWorkbookNotAllowed', 'Download workbook is not allowed');\n      }\n    },\n    _pauseAutomaticUpdatesAsync: function tab_VizImpl$_pauseAutomaticUpdatesAsync() {\n      return this._invokeAutomaticUpdatesCommandAsync('pauseAutomaticUpdates');\n    },\n    _resumeAutomaticUpdatesAsync: function tab_VizImpl$_resumeAutomaticUpdatesAsync() {\n      return this._invokeAutomaticUpdatesCommandAsync('resumeAutomaticUpdates');\n    },\n    _toggleAutomaticUpdatesAsync: function tab_VizImpl$_toggleAutomaticUpdatesAsync() {\n      return this._invokeAutomaticUpdatesCommandAsync('toggleAutomaticUpdates');\n    },\n    _setFrameSize: function tab_VizImpl$_setFrameSize(width, height) {\n      this._parameters.width = width;\n      this._parameters.height = height;\n      this._iframe.style.width = this._parameters.width;\n      this._iframe.style.height = this._parameters.height;\n    },\n    _setFrameSizeAndUpdate: function tab_VizImpl$_setFrameSizeAndUpdate(width, height) {\n      this._raiseVizResizeEvent(tab.$create_Size(-1, -1));\n\n      this._setFrameSize(width, height);\n\n      this._workbookImpl._updateActiveSheetAsync();\n    },\n    _setAreAutomaticUpdatesPaused: function tab_VizImpl$_setAreAutomaticUpdatesPaused(value) {\n      this._areAutomaticUpdatesPaused = value;\n    },\n    _contentRootElement: function tab_VizImpl$_contentRootElement() {\n      return this._parameters.parentElement;\n    },\n    _create: function tab_VizImpl$_create() {\n      try {\n        tab._VizManagerImpl._registerViz(this._viz);\n      } catch (e) {\n        this._dispose();\n\n        throw e;\n      }\n\n      if (!this._parameters.fixedSize) {\n        this._initialAvailableSize = tab._Utility.computeContentSize(this.get__parentElement());\n\n        if (!this._initialAvailableSize.width || !this._initialAvailableSize.height) {\n          this._initialAvailableSize = tab.$create_Size(800, 600);\n        }\n\n        this._iframe = this._createIframe();\n\n        this._makeInvisible();\n      } else {\n        this._iframe = this._createIframe();\n\n        this._show();\n      }\n\n      if (!tab._Utility.hasWindowPostMessage()) {\n        if (tab._Utility.isIE()) {\n          this._iframe.onreadystatechange = this._getOnCheckForDoneDelegate();\n        } else {\n          this._iframe.onload = this._getOnCheckForDoneDelegate();\n        }\n      }\n\n      this._isToolbarHidden = !this._parameters.toolbar;\n      this._areTabsHidden = !this._parameters.tabs;\n\n      this._messagingOptions.get_router().registerHandler(this);\n\n      this._iframe.src = this._parameters.get_url();\n    },\n    _sendVizOffset: function tab_VizImpl$_sendVizOffset() {\n      if (!tab._Utility.hasWindowPostMessage() || ss.isNullOrUndefined(this._iframe) || !ss.isValue(this._iframe.contentWindow)) {\n        return;\n      }\n\n      var offset = tab._Utility.elementOffset(this._iframe);\n\n      var param = [];\n      param.push('vizOffsetResp');\n      param.push(offset.x);\n      param.push(offset.y);\n\n      this._iframe.contentWindow.postMessage(param.join(','), '*');\n    },\n    _sendCommand: function tab_VizImpl$_sendCommand(commandParameters, returnHandler) {\n      this._messagingOptions.sendCommand(commandParameters, returnHandler);\n    },\n    _raiseParameterValueChange: function tab_VizImpl$_raiseParameterValueChange(parameterName) {\n      if (this.__parameterValueChange != null) {\n        this.__parameterValueChange(new tab.ParameterEvent('parametervaluechange', this._viz, parameterName));\n      }\n    },\n    _raiseCustomViewLoad: function tab_VizImpl$_raiseCustomViewLoad(customView) {\n      if (this.__customViewLoad != null) {\n        this.__customViewLoad(new tab.CustomViewEvent('customviewload', this._viz, ss.isValue(customView) ? customView._impl : null));\n      }\n    },\n    _raiseCustomViewSave: function tab_VizImpl$_raiseCustomViewSave(customView) {\n      if (this.__customViewSave != null) {\n        this.__customViewSave(new tab.CustomViewEvent('customviewsave', this._viz, customView._impl));\n      }\n    },\n    _raiseCustomViewRemove: function tab_VizImpl$_raiseCustomViewRemove(customView) {\n      if (this.__customViewRemove != null) {\n        this.__customViewRemove(new tab.CustomViewEvent('customviewremove', this._viz, customView._impl));\n      }\n    },\n    _raiseCustomViewSetDefault: function tab_VizImpl$_raiseCustomViewSetDefault(customView) {\n      if (this.__customViewSetDefault != null) {\n        this.__customViewSetDefault(new tab.CustomViewEvent('customviewsetdefault', this._viz, customView._impl));\n      }\n    },\n    _raiseTabSwitch: function tab_VizImpl$_raiseTabSwitch(oldSheetName, newSheetName) {\n      if (this.__tabSwitch != null) {\n        this.__tabSwitch(new tab.TabSwitchEvent('tabswitch', this._viz, oldSheetName, newSheetName));\n      }\n    },\n    raiseStoryPointSwitch: function tab_VizImpl$raiseStoryPointSwitch(oldStoryPointInfo, newStoryPoint) {\n      if (this.__storyPointSwitch != null) {\n        this.__storyPointSwitch(new tab.StoryPointSwitchEvent('storypointswitch', this._viz, oldStoryPointInfo, newStoryPoint));\n      }\n    },\n    _raiseStateReadyForQuery: function tab_VizImpl$_raiseStateReadyForQuery() {\n      if (this.__stateReadyForQuery != null) {\n        this.__stateReadyForQuery(this);\n      }\n    },\n    _raiseCustomViewsListLoad: function tab_VizImpl$_raiseCustomViewsListLoad() {\n      if (this.__customViewsListLoad != null) {\n        this.__customViewsListLoad(this);\n      }\n    },\n    _raiseVizResizeEvent: function tab_VizImpl$_raiseVizResizeEvent(availableSize) {\n      if (this.__vizResize != null) {\n        this.__vizResize(new tab.VizResizeEvent('vizresize', this._viz, availableSize));\n      }\n    },\n    _verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard: function tab_VizImpl$_verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName) {\n      if (ss.isNullOrUndefined(sheetOrInfoOrName)) {\n        return null;\n      }\n\n      var sheetImpl = this._workbookImpl._findActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName);\n\n      if (ss.isNullOrUndefined(sheetImpl)) {\n        throw tab._TableauException.createNotActiveSheet();\n      }\n\n      return sheetImpl.get_name();\n    },\n    _invokeAutomaticUpdatesCommandAsync: function tab_VizImpl$_invokeAutomaticUpdatesCommandAsync(command) {\n      if (command !== 'pauseAutomaticUpdates' && command !== 'resumeAutomaticUpdates' && command !== 'toggleAutomaticUpdates') {\n        throw tab._TableauException.createInternalError(null);\n      }\n\n      var param = {};\n      param['api.invokeCommandName'] = command;\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.InvokeCommandCommand', 0, ss.Delegate.create(this, function (result) {\n        var pm = result;\n\n        if (ss.isValue(pm) && ss.isValue(pm.isAutoUpdate)) {\n          this._areAutomaticUpdatesPaused = !pm.isAutoUpdate;\n        }\n\n        deferred.resolve(this._areAutomaticUpdatesPaused);\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _invokeCommand: function tab_VizImpl$_invokeCommand(command, sheetName) {\n      if (command !== 'showExportImageDialog' && command !== 'showExportDataDialog' && command !== 'showExportCrosstabDialog' && command !== 'showExportPDFDialog' && command !== 'showShareDialog' && command !== 'showDownloadWorkbookDialog') {\n        throw tab._TableauException.createInternalError(null);\n      }\n\n      var param = {};\n      param['api.invokeCommandName'] = command;\n\n      if (ss.isValue(sheetName)) {\n        param['api.invokeCommandParam'] = sheetName;\n      }\n\n      var returnHandler = new tab._CommandReturnHandler('api.InvokeCommandCommand', 0, null, null);\n\n      this._sendCommand(param, returnHandler);\n    },\n    _onWorkbookInteractive: function tab_VizImpl$_onWorkbookInteractive(actionAfterFirstInteractive) {\n      if (!this._onFirstInteractiveAlreadyCalled) {\n        var callback = this._onFirstInteractiveCallback;\n        window.setTimeout(ss.Delegate.create(this, function () {\n          if (ss.isValue(callback)) {\n            callback(new tab.TableauEvent('firstinteractive', this._viz));\n          }\n\n          if (ss.isValue(actionAfterFirstInteractive)) {\n            actionAfterFirstInteractive();\n          }\n        }), 0);\n        this._onFirstInteractiveAlreadyCalled = true;\n      }\n\n      this._raiseStateReadyForQuery();\n    },\n    _ensureCalledAfterFirstInteractive: function tab_VizImpl$_ensureCalledAfterFirstInteractive(action) {\n      var start = new Date();\n      var poll = null;\n      poll = ss.Delegate.create(this, function () {\n        var now = new Date();\n\n        if (this._onFirstInteractiveAlreadyCalled) {\n          action();\n        } else if (now - start > 5 * 60 * 1000) {\n          throw tab._TableauException.createInternalError('Timed out while waiting for the viz to become interactive');\n        } else {\n          window.setTimeout(poll, 10);\n        }\n      });\n      poll();\n    },\n    _checkForDone: function tab_VizImpl$_checkForDone() {\n      if (tab._Utility.isIE()) {\n        if (this._iframe.readyState === 'complete') {\n          this.handleVizLoad();\n        }\n      } else {\n        this.handleVizLoad();\n      }\n    },\n    _onCheckForDone: function tab_VizImpl$_onCheckForDone() {\n      window.setTimeout(ss.Delegate.create(this, this._checkForDone), 3000);\n    },\n    _createIframe: function tab_VizImpl$_createIframe() {\n      if (ss.isNullOrUndefined(this._contentRootElement())) {\n        return null;\n      }\n\n      var ifr = document.createElement('IFrame');\n      ifr.frameBorder = '0';\n      ifr.setAttribute('allowTransparency', 'true');\n      ifr.marginHeight = '0';\n      ifr.marginWidth = '0';\n      ifr.style.display = 'block';\n\n      if (this._parameters.fixedSize) {\n        ifr.style.width = this._parameters.width;\n        ifr.style.height = this._parameters.height;\n      } else {\n        ifr.style.width = '1px';\n        ifr.style.height = '1px';\n        ifr.setAttribute('scrolling', 'no');\n      }\n\n      if (tab._Utility.isSafari()) {\n        ifr.addEventListener('mousewheel', ss.Delegate.create(this, this._onIframeMouseWheel), false);\n      }\n\n      this._contentRootElement().appendChild(ifr);\n\n      return ifr;\n    },\n    _onIframeMouseWheel: function tab_VizImpl$_onIframeMouseWheel(e) {},\n    _getOnCheckForDoneDelegate: function tab_VizImpl$_getOnCheckForDoneDelegate() {\n      return ss.Delegate.create(this, function (e) {\n        this._onCheckForDone();\n      });\n    },\n    _handleInitialVizSize: function tab_VizImpl$_handleInitialVizSize(vizAndChromeSize) {\n      var sheetSize = tab.SheetSizeFactory.fromSizeConstraints(vizAndChromeSize.sizeConstraints);\n      this._vizSize = tab.$create_VizSize(sheetSize, vizAndChromeSize.chromeHeight);\n\n      if (ss.isValue(this._onFirstVizSizeKnownCallback)) {\n        this._onFirstVizSizeKnownCallback(new tab.FirstVizSizeKnownEvent('firstvizsizeknown', this._viz, this._vizSize));\n      }\n\n      if (this._parameters.fixedSize) {\n        return;\n      }\n\n      this._refreshSize();\n\n      this._addWindowResizeHandler();\n\n      this._show();\n    },\n    _removeWindowResizeHandler: function tab_VizImpl$_removeWindowResizeHandler() {\n      if (ss.isNullOrUndefined(this._windowResizeHandler)) {\n        return;\n      }\n\n      if (tab._Utility.hasWindowAddEventListener()) {\n        window.removeEventListener('resize', this._windowResizeHandler, false);\n      } else {\n        window.self.detachEvent('onresize', this._windowResizeHandler);\n      }\n\n      this._windowResizeHandler = null;\n    },\n    _addWindowResizeHandler: function tab_VizImpl$_addWindowResizeHandler() {\n      if (ss.isValue(this._windowResizeHandler)) {\n        return;\n      }\n\n      this._windowResizeHandler = ss.Delegate.create(this, function () {\n        this._refreshSize();\n      });\n\n      if (tab._Utility.hasWindowAddEventListener()) {\n        window.addEventListener('resize', this._windowResizeHandler, false);\n      } else {\n        window.self.attachEvent('onresize', this._windowResizeHandler);\n      }\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._VizManagerImpl\n\n  };\n\n  tab._VizManagerImpl = function tab__VizManagerImpl() {};\n\n  tab._VizManagerImpl.get__clonedVizs = function tab__VizManagerImpl$get__clonedVizs() {\n    return tab._VizManagerImpl._vizs.concat();\n  };\n\n  tab._VizManagerImpl._registerViz = function tab__VizManagerImpl$_registerViz(viz) {\n    tab._VizManagerImpl._verifyVizNotAlreadyParented(viz);\n\n    tab._VizManagerImpl._vizs.push(viz);\n  };\n\n  tab._VizManagerImpl._unregisterViz = function tab__VizManagerImpl$_unregisterViz(viz) {\n    for (var i = 0, len = tab._VizManagerImpl._vizs.length; i < len; i++) {\n      if (tab._VizManagerImpl._vizs[i] === viz) {\n        tab._VizManagerImpl._vizs.splice(i, 1);\n\n        break;\n      }\n    }\n  };\n\n  tab._VizManagerImpl._sendVizOffsets = function tab__VizManagerImpl$_sendVizOffsets() {\n    for (var i = 0, len = tab._VizManagerImpl._vizs.length; i < len; i++) {\n      tab._VizManagerImpl._vizs[i]._impl._sendVizOffset();\n    }\n  };\n\n  tab._VizManagerImpl._verifyVizNotAlreadyParented = function tab__VizManagerImpl$_verifyVizNotAlreadyParented(viz) {\n    var parent = viz.getParentElement();\n\n    for (var i = 0, len = tab._VizManagerImpl._vizs.length; i < len; i++) {\n      if (tab._VizManagerImpl._vizs[i].getParentElement() === parent) {\n        var message = \"Another viz is already present in element '\" + tab._Utility.elementToString(parent) + \"'.\";\n        throw tab._TableauException.create('vizAlreadyInManager', message);\n      }\n    }\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab._VizParameters\n\n\n  tab._VizParameters = function tab__VizParameters(element, url, options) {\n    if (ss.isNullOrUndefined(element) || ss.isNullOrUndefined(url)) {\n      throw tab._TableauException.create('noUrlOrParentElementNotFound', 'URL is empty or Parent element not found');\n    }\n\n    if (ss.isNullOrUndefined(options)) {\n      options = {};\n      options.hideTabs = false;\n      options.hideToolbar = false;\n      options.onFirstInteractive = null;\n    }\n\n    if (ss.isValue(options.height) || ss.isValue(options.width)) {\n      this.fixedSize = true;\n\n      if (tab._Utility.isNumber(options.height)) {\n        options.height = options.height.toString() + 'px';\n      }\n\n      if (tab._Utility.isNumber(options.width)) {\n        options.width = options.width.toString() + 'px';\n      }\n\n      this.height = ss.isValue(options.height) ? options.height.toString() : null;\n      this.width = ss.isValue(options.width) ? options.width.toString() : null;\n    } else {\n      this.fixedSize = false;\n    }\n\n    this.tabs = !(options.hideTabs || false);\n    this.toolbar = !(options.hideToolbar || false);\n    this.parentElement = element;\n    this._createOptions = options;\n    this.toolBarPosition = options.toolbarPosition;\n    var urlParts = url.split('?');\n    this._urlFromApi = urlParts[0];\n\n    if (urlParts.length === 2) {\n      this.userSuppliedParameters = urlParts[1];\n    } else {\n      this.userSuppliedParameters = '';\n    }\n\n    var r = new RegExp('.*?[^/:]/', '').exec(this._urlFromApi);\n\n    if (ss.isNullOrUndefined(r) || r[0].toLowerCase().indexOf('http://') === -1 && r[0].toLowerCase().indexOf('https://') === -1) {\n      throw tab._TableauException.create('invalidUrl', 'Invalid url');\n    }\n\n    this.host_url = r[0].toLowerCase();\n    this.name = this._urlFromApi.replace(r[0], '');\n    this.name = this.name.replace('views/', '');\n    this.serverRoot = decodeURIComponent(this.host_url);\n  };\n\n  tab._VizParameters.prototype = {\n    name: '',\n    host_url: null,\n    tabs: false,\n    toolbar: false,\n    toolBarPosition: null,\n    handlerId: null,\n    width: null,\n    height: null,\n    serverRoot: null,\n    parentElement: null,\n    userSuppliedParameters: null,\n    fixedSize: false,\n    _urlFromApi: null,\n    _createOptions: null,\n    get_url: function tab__VizParameters$get_url() {\n      return this._constructUrl();\n    },\n    get_baseUrl: function tab__VizParameters$get_baseUrl() {\n      return this._urlFromApi;\n    },\n    _constructUrl: function tab__VizParameters$_constructUrl() {\n      var url = [];\n      url.push(this.get_baseUrl());\n      url.push('?');\n\n      if (this.userSuppliedParameters.length > 0) {\n        url.push(this.userSuppliedParameters);\n        url.push('&');\n      }\n\n      url.push(':embed=y');\n      url.push('&:showVizHome=n');\n      url.push('&:jsdebug=y');\n\n      if (!this.fixedSize) {\n        url.push('&:bootstrapWhenNotified=y');\n      }\n\n      if (!this.tabs) {\n        url.push('&:tabs=n');\n      }\n\n      if (!this.toolbar) {\n        url.push('&:toolbar=n');\n      } else if (!ss.isNullOrUndefined(this.toolBarPosition)) {\n        url.push('&:toolbar=');\n        url.push(this.toolBarPosition);\n      }\n\n      var userOptions = this._createOptions;\n      var $dict1 = userOptions;\n\n      for (var $key2 in $dict1) {\n        var entry = {\n          key: $key2,\n          value: $dict1[$key2]\n        };\n\n        if (entry.key !== 'embed' && entry.key !== 'height' && entry.key !== 'width' && entry.key !== 'autoSize' && entry.key !== 'hideTabs' && entry.key !== 'hideToolbar' && entry.key !== 'onFirstInteractive' && entry.key !== 'onFirstVizSizeKnown' && entry.key !== 'toolbarPosition' && entry.key !== 'instanceIdToClone') {\n          url.push('&');\n          url.push(encodeURIComponent(entry.key));\n          url.push('=');\n          url.push(encodeURIComponent(entry.value.toString()));\n        }\n      }\n\n      url.push('&:apiID=' + this.handlerId);\n\n      if (ss.isValue(this._createOptions.instanceIdToClone)) {\n        url.push('#' + this._createOptions.instanceIdToClone);\n      }\n\n      return url.join('');\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._WorkbookImpl\n\n  };\n\n  tab._WorkbookImpl = function tab__WorkbookImpl(vizImpl, messagingOptions, callback) {\n    this._publishedSheetsInfo = new tab._Collection();\n    this._customViews = new tab._Collection();\n    this._updatedCustomViews = new tab._Collection();\n    this._removedCustomViews = new tab._Collection();\n    this._vizImpl = vizImpl;\n    this._messagingOptions = messagingOptions;\n\n    this._getClientInfo(callback);\n  };\n\n  tab._WorkbookImpl._createDashboardZones = function tab__WorkbookImpl$_createDashboardZones(zones) {\n    zones = zones || [];\n    var zonesInfo = [];\n\n    for (var i = 0; i < zones.length; i++) {\n      var zone = zones[i];\n      var objectType = zone.zoneType;\n      var size = tab.$create_Size(zone.width, zone.height);\n      var position = tab.$create_Point(zone.x, zone.y);\n      var name = zone.name;\n      var zoneInfo = tab.$create__dashboardZoneInfo(name, objectType, position, size, zone.zoneId);\n      zonesInfo.push(zoneInfo);\n    }\n\n    return zonesInfo;\n  };\n\n  tab._WorkbookImpl._extractSheetName = function tab__WorkbookImpl$_extractSheetName(sheetOrInfoOrName) {\n    if (ss.isNullOrUndefined(sheetOrInfoOrName)) {\n      return null;\n    }\n\n    if (tab._Utility.isString(sheetOrInfoOrName)) {\n      return sheetOrInfoOrName;\n    }\n\n    var info = sheetOrInfoOrName;\n    var getName = ss.Delegate.create(info, info.getName);\n\n    if (ss.isValue(getName)) {\n      return getName();\n    }\n\n    return null;\n  };\n\n  tab._WorkbookImpl._createSheetSize = function tab__WorkbookImpl$_createSheetSize(sheetInfo) {\n    if (ss.isNullOrUndefined(sheetInfo)) {\n      return tab.SheetSizeFactory.createAutomatic();\n    }\n\n    return tab.SheetSizeFactory.fromSizeConstraints(sheetInfo.sizeConstraints);\n  };\n\n  tab._WorkbookImpl._processParameters = function tab__WorkbookImpl$_processParameters(paramList) {\n    var parameters = new tab._Collection();\n    var $enum1 = ss.IEnumerator.getEnumerator(paramList.parameters);\n\n    while ($enum1.moveNext()) {\n      var model = $enum1.current;\n      var paramImpl = new tab._parameterImpl(model);\n\n      parameters._add(paramImpl.get__name(), paramImpl.get__parameter());\n    }\n\n    return parameters;\n  };\n\n  tab._WorkbookImpl._findAndCreateParameterImpl = function tab__WorkbookImpl$_findAndCreateParameterImpl(parameterName, paramList) {\n    var $enum1 = ss.IEnumerator.getEnumerator(paramList.parameters);\n\n    while ($enum1.moveNext()) {\n      var model = $enum1.current;\n\n      if (model.name === parameterName) {\n        return new tab._parameterImpl(model);\n      }\n    }\n\n    return null;\n  };\n\n  tab._WorkbookImpl.prototype = {\n    _workbook: null,\n    _vizImpl: null,\n    _name: null,\n    _activeSheetImpl: null,\n    _activatingHiddenSheetImpl: null,\n    _isDownloadAllowed: false,\n    _messagingOptions: null,\n    get_workbook: function tab__WorkbookImpl$get_workbook() {\n      if (ss.isNullOrUndefined(this._workbook)) {\n        this._workbook = new tableauSoftware.Workbook(this);\n      }\n\n      return this._workbook;\n    },\n    get_viz: function tab__WorkbookImpl$get_viz() {\n      return this._vizImpl.get__viz();\n    },\n    get_publishedSheets: function tab__WorkbookImpl$get_publishedSheets() {\n      return this._publishedSheetsInfo;\n    },\n    get_name: function tab__WorkbookImpl$get_name() {\n      return this._name;\n    },\n    get_activeSheetImpl: function tab__WorkbookImpl$get_activeSheetImpl() {\n      return this._activeSheetImpl;\n    },\n    get_activeCustomView: function tab__WorkbookImpl$get_activeCustomView() {\n      return this._currentCustomView;\n    },\n    get_isDownloadAllowed: function tab__WorkbookImpl$get_isDownloadAllowed() {\n      return this._isDownloadAllowed;\n    },\n    _findActiveSheetOrSheetWithinActiveDashboard: function tab__WorkbookImpl$_findActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName) {\n      if (ss.isNullOrUndefined(this._activeSheetImpl)) {\n        return null;\n      }\n\n      var sheetName = tab._WorkbookImpl._extractSheetName(sheetOrInfoOrName);\n\n      if (ss.isNullOrUndefined(sheetName)) {\n        return null;\n      }\n\n      if (sheetName === this._activeSheetImpl.get_name()) {\n        return this._activeSheetImpl;\n      }\n\n      if (this._activeSheetImpl.get_isDashboard()) {\n        var dashboardImpl = this._activeSheetImpl;\n\n        var sheet = dashboardImpl.get_worksheets()._get(sheetName);\n\n        if (ss.isValue(sheet)) {\n          return sheet._impl;\n        }\n      }\n\n      return null;\n    },\n    _setActiveSheetAsync: function tab__WorkbookImpl$_setActiveSheetAsync(sheetNameOrInfoOrIndex) {\n      if (tab._Utility.isNumber(sheetNameOrInfoOrIndex)) {\n        var index = sheetNameOrInfoOrIndex;\n\n        if (index < this._publishedSheetsInfo.get__length() && index >= 0) {\n          return this._activateSheetWithInfoAsync(this._publishedSheetsInfo.get_item(index)._impl);\n        } else {\n          throw tab._TableauException.createIndexOutOfRange(index);\n        }\n      }\n\n      var sheetName = tab._WorkbookImpl._extractSheetName(sheetNameOrInfoOrIndex);\n\n      var sheetInfo = this._publishedSheetsInfo._get(sheetName);\n\n      if (ss.isValue(sheetInfo)) {\n        return this._activateSheetWithInfoAsync(sheetInfo._impl);\n      } else if (this._activeSheetImpl.get_isDashboard()) {\n        var d = this._activeSheetImpl;\n\n        var sheet = d.get_worksheets()._get(sheetName);\n\n        if (ss.isValue(sheet)) {\n          this._activatingHiddenSheetImpl = null;\n          var sheetUrl = '';\n\n          if (sheet.getIsHidden()) {\n            this._activatingHiddenSheetImpl = sheet._impl;\n          } else {\n            sheetUrl = sheet._impl.get_url();\n          }\n\n          return this._activateSheetInternalAsync(sheet._impl.get_name(), sheetUrl);\n        }\n      }\n\n      throw tab._TableauException.create('sheetNotInWorkbook', 'Sheet is not found in Workbook');\n    },\n    _revertAllAsync: function tab__WorkbookImpl$_revertAllAsync() {\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.RevertAllCommand', 1, function (result) {\n        deferred.resolve();\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(null, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _update: function tab__WorkbookImpl$_update(callback) {\n      this._getClientInfo(callback);\n    },\n    _activateSheetWithInfoAsync: function tab__WorkbookImpl$_activateSheetWithInfoAsync(sheetInfoImpl) {\n      return this._activateSheetInternalAsync(sheetInfoImpl.name, sheetInfoImpl.url);\n    },\n    _activateSheetInternalAsync: function tab__WorkbookImpl$_activateSheetInternalAsync(sheetName, sheetUrl) {\n      var deferred = new tab._Deferred();\n\n      if (ss.isValue(this._activeSheetImpl) && sheetName === this._activeSheetImpl.get_name()) {\n        deferred.resolve(this._activeSheetImpl.get_sheet());\n        return deferred.get_promise();\n      }\n\n      var param = {};\n      param['api.switchToSheetName'] = sheetName;\n      param['api.switchToRepositoryUrl'] = sheetUrl;\n      param['api.oldRepositoryUrl'] = this._activeSheetImpl.get_url();\n      var returnHandler = new tab._CommandReturnHandler('api.SwitchActiveSheetCommand', 0, ss.Delegate.create(this, function (result) {\n        this._vizImpl._workbookTabSwitchHandler = ss.Delegate.create(this, function () {\n          this._vizImpl._workbookTabSwitchHandler = null;\n          deferred.resolve(this._activeSheetImpl.get_sheet());\n        });\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _updateActiveSheetAsync: function tab__WorkbookImpl$_updateActiveSheetAsync() {\n      var deferred = new tab._Deferred();\n      var param = {};\n      param['api.switchToSheetName'] = this._activeSheetImpl.get_name();\n      param['api.switchToRepositoryUrl'] = this._activeSheetImpl.get_url();\n      param['api.oldRepositoryUrl'] = this._activeSheetImpl.get_url();\n      var returnHandler = new tab._CommandReturnHandler('api.UpdateActiveSheetCommand', 0, ss.Delegate.create(this, function (result) {\n        deferred.resolve(this._activeSheetImpl.get_sheet());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _sendCommand: function tab__WorkbookImpl$_sendCommand(commandParameters, returnHandler) {\n      this._messagingOptions.sendCommand(commandParameters, returnHandler);\n    },\n    _getClientInfo: function tab__WorkbookImpl$_getClientInfo(callback) {\n      var returnHandler = new tab._CommandReturnHandler('api.GetClientInfoCommand', 0, ss.Delegate.create(this, function (result) {\n        var clientInfo = result;\n\n        this._processInfo(clientInfo);\n\n        if (ss.isValue(callback)) {\n          callback();\n        }\n      }), null);\n\n      this._sendCommand(null, returnHandler);\n    },\n    _processInfo: function tab__WorkbookImpl$_processInfo(clientInfo) {\n      this._name = clientInfo.workbookName;\n      this._isDownloadAllowed = clientInfo.isDownloadAllowed;\n\n      this._vizImpl._setAreAutomaticUpdatesPaused(!clientInfo.isAutoUpdate);\n\n      this._createSheetsInfo(clientInfo);\n\n      this._initializeActiveSheet(clientInfo);\n    },\n    _initializeActiveSheet: function tab__WorkbookImpl$_initializeActiveSheet(clientInfo) {\n      var currentSheetName = clientInfo.currentSheetName;\n\n      var newActiveSheetInfo = this._publishedSheetsInfo._get(currentSheetName);\n\n      if (ss.isNullOrUndefined(newActiveSheetInfo) && ss.isNullOrUndefined(this._activatingHiddenSheetImpl)) {\n        throw tab._TableauException.createInternalError('The active sheet was not specified in baseSheets');\n      }\n\n      if (ss.isValue(this._activeSheetImpl) && this._activeSheetImpl.get_name() === currentSheetName) {\n        return;\n      }\n\n      if (ss.isValue(this._activeSheetImpl)) {\n        this._activeSheetImpl.set_isActive(false);\n\n        var oldActiveSheetInfo = this._publishedSheetsInfo._get(this._activeSheetImpl.get_name());\n\n        if (ss.isValue(oldActiveSheetInfo)) {\n          oldActiveSheetInfo._impl.isActive = false;\n        }\n\n        if (this._activeSheetImpl.get_sheetType() === 'story') {\n          var storyImpl = this._activeSheetImpl;\n          storyImpl.remove_activeStoryPointChange(ss.Delegate.create(this._vizImpl, this._vizImpl.raiseStoryPointSwitch));\n        }\n      }\n\n      if (ss.isValue(this._activatingHiddenSheetImpl)) {\n        var infoImpl = tab.$create__SheetInfoImpl(this._activatingHiddenSheetImpl.get_name(), 'worksheet', -1, this._activatingHiddenSheetImpl.get_size(), this.get_workbook(), '', true, true, 4294967295);\n        this._activatingHiddenSheetImpl = null;\n        this._activeSheetImpl = new tab._WorksheetImpl(infoImpl, this, this._messagingOptions, null);\n      } else {\n        var baseSheet = null;\n\n        for (var i = 0, len = clientInfo.publishedSheets.length; i < len; i++) {\n          if (clientInfo.publishedSheets[i].name === currentSheetName) {\n            baseSheet = clientInfo.publishedSheets[i];\n            break;\n          }\n        }\n\n        if (ss.isNullOrUndefined(baseSheet)) {\n          throw tab._TableauException.createInternalError('No base sheet was found corresponding to the active sheet.');\n        }\n\n        var findSheetFunc = ss.Delegate.create(this, function (sheetName) {\n          return this._publishedSheetsInfo._get(sheetName);\n        });\n\n        if (baseSheet.sheetType === 'dashboard') {\n          var dashboardImpl = new tab._DashboardImpl(newActiveSheetInfo._impl, this, this._messagingOptions);\n          this._activeSheetImpl = dashboardImpl;\n\n          var dashboardFrames = tab._WorkbookImpl._createDashboardZones(clientInfo.dashboardZones);\n\n          dashboardImpl._addObjects(dashboardFrames, findSheetFunc);\n        } else if (baseSheet.sheetType === 'story') {\n          var storyImpl = new tab._StoryImpl(newActiveSheetInfo._impl, this, this._messagingOptions, clientInfo.story, findSheetFunc);\n          this._activeSheetImpl = storyImpl;\n          storyImpl.add_activeStoryPointChange(ss.Delegate.create(this._vizImpl, this._vizImpl.raiseStoryPointSwitch));\n        } else {\n          this._activeSheetImpl = new tab._WorksheetImpl(newActiveSheetInfo._impl, this, this._messagingOptions, null);\n        }\n\n        newActiveSheetInfo._impl.isActive = true;\n      }\n\n      this._activeSheetImpl.set_isActive(true);\n    },\n    _createSheetsInfo: function tab__WorkbookImpl$_createSheetsInfo(clientInfo) {\n      var baseSheets = clientInfo.publishedSheets;\n\n      if (ss.isNullOrUndefined(baseSheets)) {\n        return;\n      }\n\n      for (var index = 0; index < baseSheets.length; index++) {\n        var baseSheet = baseSheets[index];\n        var sheetName = baseSheet.name;\n\n        var sheetInfo = this._publishedSheetsInfo._get(sheetName);\n\n        var size = tab._WorkbookImpl._createSheetSize(baseSheet);\n\n        if (ss.isNullOrUndefined(sheetInfo)) {\n          var isActive = sheetName === clientInfo.currentSheetName;\n          var sheetType = baseSheet.sheetType;\n          var sheetInfoImpl = tab.$create__SheetInfoImpl(sheetName, sheetType, index, size, this.get_workbook(), baseSheet.repositoryUrl, isActive, false, 4294967295);\n          sheetInfo = new tableauSoftware.SheetInfo(sheetInfoImpl);\n\n          this._publishedSheetsInfo._add(sheetName, sheetInfo);\n        } else {\n          sheetInfo._impl.size = size;\n        }\n      }\n    },\n    _currentCustomView: null,\n    get__customViews: function tab__WorkbookImpl$get__customViews() {\n      return this._customViews;\n    },\n    set__customViews: function tab__WorkbookImpl$set__customViews(value) {\n      this._customViews = value;\n      return value;\n    },\n    get__updatedCustomViews: function tab__WorkbookImpl$get__updatedCustomViews() {\n      return this._updatedCustomViews;\n    },\n    set__updatedCustomViews: function tab__WorkbookImpl$set__updatedCustomViews(value) {\n      this._updatedCustomViews = value;\n      return value;\n    },\n    get__removedCustomViews: function tab__WorkbookImpl$get__removedCustomViews() {\n      return this._removedCustomViews;\n    },\n    set__removedCustomViews: function tab__WorkbookImpl$set__removedCustomViews(value) {\n      this._removedCustomViews = value;\n      return value;\n    },\n    get__currentCustomView: function tab__WorkbookImpl$get__currentCustomView() {\n      return this._currentCustomView;\n    },\n    set__currentCustomView: function tab__WorkbookImpl$set__currentCustomView(value) {\n      this._currentCustomView = value;\n      return value;\n    },\n    _getCustomViewsAsync: function tab__WorkbookImpl$_getCustomViewsAsync() {\n      return tab._CustomViewImpl._getCustomViewsAsync(this, this._messagingOptions);\n    },\n    _showCustomViewAsync: function tab__WorkbookImpl$_showCustomViewAsync(customViewName) {\n      if (ss.isNullOrUndefined(customViewName) || tab._Utility.isNullOrEmpty(customViewName)) {\n        return tab._CustomViewImpl._showCustomViewAsync(this, this._messagingOptions, null);\n      } else {\n        var cv = this._customViews._get(customViewName);\n\n        if (ss.isNullOrUndefined(cv)) {\n          var deferred = new tab._Deferred();\n          deferred.reject(tab._TableauException.createInvalidCustomViewName(customViewName));\n          return deferred.get_promise();\n        }\n\n        return cv._impl._showAsync();\n      }\n    },\n    _removeCustomViewAsync: function tab__WorkbookImpl$_removeCustomViewAsync(customViewName) {\n      if (tab._Utility.isNullOrEmpty(customViewName)) {\n        throw tab._TableauException.createNullOrEmptyParameter('customViewName');\n      }\n\n      var cv = this._customViews._get(customViewName);\n\n      if (ss.isNullOrUndefined(cv)) {\n        var deferred = new tab._Deferred();\n        deferred.reject(tab._TableauException.createInvalidCustomViewName(customViewName));\n        return deferred.get_promise();\n      }\n\n      return cv._impl._removeAsync();\n    },\n    _rememberCustomViewAsync: function tab__WorkbookImpl$_rememberCustomViewAsync(customViewName) {\n      if (tab._Utility.isNullOrEmpty(customViewName)) {\n        throw tab._TableauException.createInvalidParameter('customViewName');\n      }\n\n      return tab._CustomViewImpl._saveNewAsync(this, this._messagingOptions, customViewName);\n    },\n    _setActiveCustomViewAsDefaultAsync: function tab__WorkbookImpl$_setActiveCustomViewAsDefaultAsync() {\n      return tab._CustomViewImpl._makeCurrentCustomViewDefaultAsync(this, this._messagingOptions);\n    },\n    _parameters: null,\n    _lastChangedParameterImpl: null,\n    get__lastChangedParameterImpl: function tab__WorkbookImpl$get__lastChangedParameterImpl() {\n      return this._lastChangedParameterImpl;\n    },\n    set__lastChangedParameterImpl: function tab__WorkbookImpl$set__lastChangedParameterImpl(value) {\n      this._lastChangedParameterImpl = value;\n      return value;\n    },\n    get__parameters: function tab__WorkbookImpl$get__parameters() {\n      return this._parameters;\n    },\n    _getSingleParameterAsync: function tab__WorkbookImpl$_getSingleParameterAsync(parameterName) {\n      var deferred = new tab._Deferred();\n\n      if (ss.isValue(this._lastChangedParameterImpl)) {\n        deferred.resolve(this._lastChangedParameterImpl.get__parameter());\n        return deferred.get_promise();\n      }\n\n      var commandParameters = {};\n      var returnHandler = new tab._CommandReturnHandler('api.FetchParametersCommand', 0, ss.Delegate.create(this, function (result) {\n        var paramList = result;\n\n        var parameterImpl = tab._WorkbookImpl._findAndCreateParameterImpl(parameterName, paramList);\n\n        this._lastChangedParameterImpl = parameterImpl;\n        deferred.resolve(parameterImpl.get__parameter());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(commandParameters, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _getParametersAsync: function tab__WorkbookImpl$_getParametersAsync() {\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      var returnHandler = new tab._CommandReturnHandler('api.FetchParametersCommand', 0, ss.Delegate.create(this, function (result) {\n        var paramList = result;\n        this._parameters = tab._WorkbookImpl._processParameters(paramList);\n        deferred.resolve(this.get__parameters()._toApiCollection());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n\n      this._sendCommand(commandParameters, returnHandler);\n\n      return deferred.get_promise();\n    },\n    _changeParameterValueAsync: function tab__WorkbookImpl$_changeParameterValueAsync(parameterName, value) {\n      var deferred = new tab._Deferred();\n      var parameterImpl = null;\n\n      if (ss.isValue(this._parameters)) {\n        if (ss.isNullOrUndefined(this._parameters._get(parameterName))) {\n          deferred.reject(tab._TableauException.createInvalidParameter(parameterName));\n          return deferred.get_promise();\n        }\n\n        parameterImpl = this._parameters._get(parameterName)._impl;\n\n        if (ss.isNullOrUndefined(parameterImpl)) {\n          deferred.reject(tab._TableauException.createInvalidParameter(parameterName));\n          return deferred.get_promise();\n        }\n      }\n\n      var param = {};\n      param['api.setParameterName'] = ss.isValue(this._parameters) ? parameterImpl.get__name() : parameterName;\n\n      if (ss.isValue(value) && tab._Utility.isDate(value)) {\n        var date = value;\n\n        var dateStr = tab._Utility.serializeDateForServer(date);\n\n        param['api.setParameterValue'] = dateStr;\n      } else {\n        param['api.setParameterValue'] = ss.isValue(value) ? value.toString() : null;\n      }\n\n      this._lastChangedParameterImpl = null;\n      var returnHandler = new tab._CommandReturnHandler('api.SetParameterValueCommand', 0, ss.Delegate.create(this, function (result) {\n        var pm = result;\n\n        if (ss.isNullOrUndefined(pm)) {\n          deferred.reject(tab._TableauException.create('serverError', 'server error'));\n          return;\n        }\n\n        if (!pm.isValidPresModel) {\n          deferred.reject(tab._TableauException.createInvalidParameter(parameterName));\n          return;\n        }\n\n        var paramUpdated = new tab._parameterImpl(pm);\n        this._lastChangedParameterImpl = paramUpdated;\n        deferred.resolve(paramUpdated.get__parameter());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createInvalidParameter(parameterName));\n      });\n\n      this._sendCommand(param, returnHandler);\n\n      return deferred.get_promise();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._WorksheetImpl\n\n  };\n\n  tab._WorksheetImpl = function tab__WorksheetImpl(sheetInfoImpl, workbookImpl, messagingOptions, parentDashboardImpl) {\n    this._filters$1 = new tab._Collection();\n    this._selectedMarks$1 = new tab._Collection();\n\n    tab._WorksheetImpl.initializeBase(this, [sheetInfoImpl, workbookImpl, messagingOptions]);\n\n    this._parentDashboardImpl$1 = parentDashboardImpl;\n  };\n\n  tab._WorksheetImpl._filterCommandError = function tab__WorksheetImpl$_filterCommandError(rawPm) {\n    var commandError = rawPm;\n\n    if (ss.isValue(commandError) && ss.isValue(commandError.errorCode)) {\n      var additionalInfo = commandError.additionalInformation;\n\n      switch (commandError.errorCode) {\n        case 'invalidFilterFieldName':\n        case 'invalidFilterFieldValue':\n          return tab._TableauException.create(commandError.errorCode, additionalInfo);\n\n        case 'invalidAggregationFieldName':\n          return tab._TableauException._createInvalidAggregationFieldName(additionalInfo);\n\n        default:\n          return tab._TableauException.createServerError(additionalInfo);\n      }\n    }\n\n    return null;\n  };\n\n  tab._WorksheetImpl._normalizeRangeFilterOption$1 = function tab__WorksheetImpl$_normalizeRangeFilterOption$1(filterOptions) {\n    if (ss.isNullOrUndefined(filterOptions)) {\n      throw tab._TableauException.createNullOrEmptyParameter('filterOptions');\n    }\n\n    if (ss.isNullOrUndefined(filterOptions.min) && ss.isNullOrUndefined(filterOptions.max)) {\n      throw tab._TableauException.create('invalidParameter', 'At least one of filterOptions.min or filterOptions.max must be specified.');\n    }\n\n    var fixedUpFilterOptions = {};\n\n    if (ss.isValue(filterOptions.min)) {\n      fixedUpFilterOptions.min = filterOptions.min;\n    }\n\n    if (ss.isValue(filterOptions.max)) {\n      fixedUpFilterOptions.max = filterOptions.max;\n    }\n\n    if (ss.isValue(filterOptions.nullOption)) {\n      fixedUpFilterOptions.nullOption = tab._enums._normalizeNullOption(filterOptions.nullOption, 'filterOptions.nullOption');\n    }\n\n    return fixedUpFilterOptions;\n  };\n\n  tab._WorksheetImpl._normalizeRelativeDateFilterOptions$1 = function tab__WorksheetImpl$_normalizeRelativeDateFilterOptions$1(filterOptions) {\n    if (ss.isNullOrUndefined(filterOptions)) {\n      throw tab._TableauException.createNullOrEmptyParameter('filterOptions');\n    }\n\n    var fixedUpFilterOptions = {};\n    fixedUpFilterOptions.rangeType = tab._enums._normalizeDateRangeType(filterOptions.rangeType, 'filterOptions.rangeType');\n    fixedUpFilterOptions.periodType = tab._enums._normalizePeriodType(filterOptions.periodType, 'filterOptions.periodType');\n\n    if (fixedUpFilterOptions.rangeType === 'lastn' || fixedUpFilterOptions.rangeType === 'nextn') {\n      if (ss.isNullOrUndefined(filterOptions.rangeN)) {\n        throw tab._TableauException.create('missingRangeNForRelativeDateFilters', 'Missing rangeN field for a relative date filter of LASTN or NEXTN.');\n      }\n\n      fixedUpFilterOptions.rangeN = tab._Utility.toInt(filterOptions.rangeN);\n    }\n\n    if (ss.isValue(filterOptions.anchorDate)) {\n      if (!tab._Utility.isDate(filterOptions.anchorDate) || !tab._Utility.isDateValid(filterOptions.anchorDate)) {\n        throw tab._TableauException.createInvalidDateParameter('filterOptions.anchorDate');\n      }\n\n      fixedUpFilterOptions.anchorDate = filterOptions.anchorDate;\n    }\n\n    return fixedUpFilterOptions;\n  };\n\n  tab._WorksheetImpl._createFilterCommandReturnHandler$1 = function tab__WorksheetImpl$_createFilterCommandReturnHandler$1(commandName, fieldName, deferred) {\n    return new tab._CommandReturnHandler(commandName, 1, function (result) {\n      var error = tab._WorksheetImpl._filterCommandError(result);\n\n      if (error == null) {\n        deferred.resolve(fieldName);\n      } else {\n        deferred.reject(error);\n      }\n    }, function (remoteError, message) {\n      if (remoteError) {\n        deferred.reject(tab._TableauException.createInvalidFilterFieldNameOrValue(fieldName));\n      } else {\n        var error = tab._TableauException.create('filterCannotBePerformed', message);\n\n        deferred.reject(error);\n      }\n    });\n  };\n\n  tab._WorksheetImpl._createSelectionCommandError$1 = function tab__WorksheetImpl$_createSelectionCommandError$1(rawPm) {\n    var commandError = rawPm;\n\n    if (ss.isValue(commandError) && ss.isValue(commandError.errorCode)) {\n      var additionalInfo = commandError.additionalInformation;\n\n      switch (commandError.errorCode) {\n        case 'invalidSelectionFieldName':\n        case 'invalidSelectionValue':\n        case 'invalidSelectionDate':\n          return tab._TableauException.create(commandError.errorCode, additionalInfo);\n      }\n    }\n\n    return null;\n  };\n\n  tab._WorksheetImpl.prototype = {\n    _worksheet$1: null,\n    _parentDashboardImpl$1: null,\n    get_sheet: function tab__WorksheetImpl$get_sheet() {\n      return this.get_worksheet();\n    },\n    get_worksheet: function tab__WorksheetImpl$get_worksheet() {\n      if (this._worksheet$1 == null) {\n        this._worksheet$1 = new tableauSoftware.Worksheet(this);\n      }\n\n      return this._worksheet$1;\n    },\n    get_parentDashboardImpl: function tab__WorksheetImpl$get_parentDashboardImpl() {\n      return this._parentDashboardImpl$1;\n    },\n    get_parentDashboard: function tab__WorksheetImpl$get_parentDashboard() {\n      if (ss.isValue(this._parentDashboardImpl$1)) {\n        return this._parentDashboardImpl$1.get_dashboard();\n      }\n\n      return null;\n    },\n    _getDataSourcesAsync: function tab__WorksheetImpl$_getDataSourcesAsync() {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      commandParameters['api.worksheetName'] = this.get_name();\n      var returnHandler = new tab._CommandReturnHandler('api.GetDataSourcesCommand', 0, function (result) {\n        var dataSourcesPm = result;\n\n        var dataSources = tab._DataSourceImpl.processDataSourcesForWorksheet(dataSourcesPm);\n\n        deferred.resolve(dataSources._toApiCollection());\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _getDataSourceAsync: function tab__WorksheetImpl$_getDataSourceAsync(dataSourceName) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      commandParameters['api.dataSourceName'] = dataSourceName;\n      commandParameters['api.worksheetName'] = this.get_name();\n      var returnHandler = new tab._CommandReturnHandler('api.GetDataSourceCommand', 0, function (result) {\n        var dataSourcePm = result;\n\n        var dataSourceImpl = tab._DataSourceImpl.processDataSource(dataSourcePm);\n\n        if (ss.isValue(dataSourceImpl)) {\n          deferred.resolve(dataSourceImpl.get_dataSource());\n        } else {\n          deferred.reject(tab._TableauException.createServerError(\"Data source '\" + dataSourceName + \"' not found\"));\n        }\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _verifyActiveSheetOrEmbeddedInActiveDashboard$1: function tab__WorksheetImpl$_verifyActiveSheetOrEmbeddedInActiveDashboard$1() {\n      var isRootAndActiveWorksheet = this.get_isActive();\n\n      var isWithinActiveDashboard = ss.isValue(this._parentDashboardImpl$1) && this._parentDashboardImpl$1.get_isActive();\n\n      var isWithinActiveStoryPoint = ss.isValue(this.get_parentStoryPointImpl()) && this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();\n\n      if (!isRootAndActiveWorksheet && !isWithinActiveDashboard && !isWithinActiveStoryPoint) {\n        throw tab._TableauException.createNotActiveSheet();\n      }\n    },\n    _addVisualIdToCommand$1: function tab__WorksheetImpl$_addVisualIdToCommand$1(commandParameters) {\n      if (ss.isValue(this.get_parentStoryPointImpl())) {\n        var visualId = {};\n        visualId.worksheet = this.get_name();\n\n        if (ss.isValue(this.get_parentDashboardImpl())) {\n          visualId.dashboard = this.get_parentDashboardImpl().get_name();\n        }\n\n        visualId.flipboardZoneId = this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId();\n        visualId.storyboard = this.get_parentStoryPointImpl().get_parentStoryImpl().get_name();\n        visualId.storyPointId = this.get_parentStoryPointImpl().get_storyPointId();\n        commandParameters['api.visualId'] = visualId;\n      } else {\n        commandParameters['api.worksheetName'] = this.get_name();\n\n        if (ss.isValue(this.get_parentDashboardImpl())) {\n          commandParameters['api.dashboardName'] = this.get_parentDashboardImpl().get_name();\n        }\n      }\n    },\n    get__filters: function tab__WorksheetImpl$get__filters() {\n      return this._filters$1;\n    },\n    set__filters: function tab__WorksheetImpl$set__filters(value) {\n      this._filters$1 = value;\n      return value;\n    },\n    _getFilterAsync: function tab__WorksheetImpl$_getFilterAsync(fieldName, fieldCaption, options) {\n      if (!tab._Utility.isNullOrEmpty(fieldName) && !tab._Utility.isNullOrEmpty(fieldCaption)) {\n        throw tab._TableauException.createInternalError('Only fieldName OR fieldCaption is allowed, not both.');\n      }\n\n      options = options || {};\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      if (!tab._Utility.isNullOrEmpty(fieldCaption) && tab._Utility.isNullOrEmpty(fieldName)) {\n        commandParameters['api.fieldCaption'] = fieldCaption;\n      }\n\n      if (!tab._Utility.isNullOrEmpty(fieldName)) {\n        commandParameters['api.fieldName'] = fieldName;\n      }\n\n      commandParameters['api.filterHierarchicalLevels'] = 0;\n      commandParameters['api.ignoreDomain'] = options.ignoreDomain || false;\n      var returnHandler = new tab._CommandReturnHandler('api.GetOneFilterInfoCommand', 0, ss.Delegate.create(this, function (result) {\n        var error = tab._WorksheetImpl._filterCommandError(result);\n\n        if (error == null) {\n          var filterJson = result;\n\n          var filter = tableauSoftware.Filter._createFilter(this, filterJson);\n\n          deferred.resolve(filter);\n        } else {\n          deferred.reject(error);\n        }\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _getFiltersAsync: function tab__WorksheetImpl$_getFiltersAsync(options) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      options = options || {};\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      commandParameters['api.ignoreDomain'] = options.ignoreDomain || false;\n      var returnHandler = new tab._CommandReturnHandler('api.GetFiltersListCommand', 0, ss.Delegate.create(this, function (result) {\n        var filtersListJson = result;\n        this.set__filters(tableauSoftware.Filter._processFiltersList(this, filtersListJson));\n        deferred.resolve(this.get__filters()._toApiCollection());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _applyFilterAsync: function tab__WorksheetImpl$_applyFilterAsync(fieldName, values, updateType, options) {\n      return this._applyFilterWithValuesInternalAsync$1(fieldName, values, updateType, options);\n    },\n    _clearFilterAsync: function tab__WorksheetImpl$_clearFilterAsync(fieldName) {\n      return this._clearFilterInternalAsync$1(fieldName);\n    },\n    _applyRangeFilterAsync: function tab__WorksheetImpl$_applyRangeFilterAsync(fieldName, options) {\n      var fixedUpFilterOptions = tab._WorksheetImpl._normalizeRangeFilterOption$1(options);\n\n      return this._applyRangeFilterInternalAsync$1(fieldName, fixedUpFilterOptions);\n    },\n    _applyRelativeDateFilterAsync: function tab__WorksheetImpl$_applyRelativeDateFilterAsync(fieldName, options) {\n      var fixedUpFilterOptions = tab._WorksheetImpl._normalizeRelativeDateFilterOptions$1(options);\n\n      return this._applyRelativeDateFilterInternalAsync$1(fieldName, fixedUpFilterOptions);\n    },\n    _applyHierarchicalFilterAsync: function tab__WorksheetImpl$_applyHierarchicalFilterAsync(fieldName, values, updateType, options) {\n      if (ss.isNullOrUndefined(values) && updateType !== 'all') {\n        throw tab._TableauException.createInvalidParameter('values');\n      }\n\n      return this._applyHierarchicalFilterInternalAsync$1(fieldName, values, updateType, options);\n    },\n    _clearFilterInternalAsync$1: function tab__WorksheetImpl$_clearFilterInternalAsync$1(fieldName) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (tab._Utility.isNullOrEmpty(fieldName)) {\n        throw tab._TableauException.createNullOrEmptyParameter('fieldName');\n      }\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      commandParameters['api.fieldCaption'] = fieldName;\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var returnHandler = tab._WorksheetImpl._createFilterCommandReturnHandler$1('api.ClearFilterCommand', fieldName, deferred);\n\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _applyFilterWithValuesInternalAsync$1: function tab__WorksheetImpl$_applyFilterWithValuesInternalAsync$1(fieldName, values, updateType, options) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (tab._Utility.isNullOrEmpty(fieldName)) {\n        throw tab._TableauException.createNullOrEmptyParameter('fieldName');\n      }\n\n      updateType = tab._enums._normalizeFilterUpdateType(updateType, 'updateType');\n      var fieldValues = [];\n\n      if (tab._jQueryShim.isArray(values)) {\n        for (var i = 0; i < values.length; i++) {\n          fieldValues.push(values[i].toString());\n        }\n      } else if (ss.isValue(values)) {\n        fieldValues.push(values.toString());\n      }\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n      commandParameters['api.fieldCaption'] = fieldName;\n      commandParameters['api.filterUpdateType'] = updateType;\n      commandParameters['api.exclude'] = ss.isValue(options) && options.isExcludeMode ? true : false;\n\n      if (updateType !== 'all') {\n        commandParameters['api.filterCategoricalValues'] = fieldValues;\n      }\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var returnHandler = tab._WorksheetImpl._createFilterCommandReturnHandler$1('api.ApplyCategoricalFilterCommand', fieldName, deferred);\n\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _applyRangeFilterInternalAsync$1: function tab__WorksheetImpl$_applyRangeFilterInternalAsync$1(fieldName, filterOptions) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (tab._Utility.isNullOrEmpty(fieldName)) {\n        throw tab._TableauException.createNullOrEmptyParameter('fieldName');\n      }\n\n      if (ss.isNullOrUndefined(filterOptions)) {\n        throw tab._TableauException.createNullOrEmptyParameter('filterOptions');\n      }\n\n      var commandParameters = {};\n      commandParameters['api.fieldCaption'] = fieldName;\n\n      if (ss.isValue(filterOptions.min)) {\n        if (tab._Utility.isDate(filterOptions.min)) {\n          var dt = filterOptions.min;\n\n          if (tab._Utility.isDateValid(dt)) {\n            commandParameters['api.filterRangeMin'] = tab._Utility.serializeDateForServer(dt);\n          } else {\n            throw tab._TableauException.createInvalidDateParameter('filterOptions.min');\n          }\n        } else {\n          commandParameters['api.filterRangeMin'] = filterOptions.min;\n        }\n      }\n\n      if (ss.isValue(filterOptions.max)) {\n        if (tab._Utility.isDate(filterOptions.max)) {\n          var dt = filterOptions.max;\n\n          if (tab._Utility.isDateValid(dt)) {\n            commandParameters['api.filterRangeMax'] = tab._Utility.serializeDateForServer(dt);\n          } else {\n            throw tab._TableauException.createInvalidDateParameter('filterOptions.max');\n          }\n        } else {\n          commandParameters['api.filterRangeMax'] = filterOptions.max;\n        }\n      }\n\n      if (ss.isValue(filterOptions.nullOption)) {\n        commandParameters['api.filterRangeNullOption'] = filterOptions.nullOption;\n      }\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var deferred = new tab._Deferred();\n\n      var returnHandler = tab._WorksheetImpl._createFilterCommandReturnHandler$1('api.ApplyRangeFilterCommand', fieldName, deferred);\n\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _applyRelativeDateFilterInternalAsync$1: function tab__WorksheetImpl$_applyRelativeDateFilterInternalAsync$1(fieldName, filterOptions) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (tab._Utility.isNullOrEmpty(fieldName)) {\n        throw tab._TableauException.createInvalidParameter('fieldName');\n      } else if (ss.isNullOrUndefined(filterOptions)) {\n        throw tab._TableauException.createInvalidParameter('filterOptions');\n      }\n\n      var commandParameters = {};\n      commandParameters['api.fieldCaption'] = fieldName;\n\n      if (ss.isValue(filterOptions)) {\n        commandParameters['api.filterPeriodType'] = filterOptions.periodType;\n        commandParameters['api.filterDateRangeType'] = filterOptions.rangeType;\n\n        if (filterOptions.rangeType === 'lastn' || filterOptions.rangeType === 'nextn') {\n          if (ss.isNullOrUndefined(filterOptions.rangeN)) {\n            throw tab._TableauException.create('missingRangeNForRelativeDateFilters', 'Missing rangeN field for a relative date filter of LASTN or NEXTN.');\n          }\n\n          commandParameters['api.filterDateRange'] = filterOptions.rangeN;\n        }\n\n        if (ss.isValue(filterOptions.anchorDate)) {\n          commandParameters['api.filterDateArchorValue'] = tab._Utility.serializeDateForServer(filterOptions.anchorDate);\n        }\n      }\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var deferred = new tab._Deferred();\n\n      var returnHandler = tab._WorksheetImpl._createFilterCommandReturnHandler$1('api.ApplyRelativeDateFilterCommand', fieldName, deferred);\n\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _applyHierarchicalFilterInternalAsync$1: function tab__WorksheetImpl$_applyHierarchicalFilterInternalAsync$1(fieldName, values, updateType, options) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (tab._Utility.isNullOrEmpty(fieldName)) {\n        throw tab._TableauException.createNullOrEmptyParameter('fieldName');\n      }\n\n      updateType = tab._enums._normalizeFilterUpdateType(updateType, 'updateType');\n      var fieldValues = null;\n      var levelValues = null;\n\n      if (tab._jQueryShim.isArray(values)) {\n        fieldValues = [];\n        var arr = values;\n\n        for (var i = 0; i < arr.length; i++) {\n          fieldValues.push(arr[i].toString());\n        }\n      } else if (tab._Utility.isString(values)) {\n        fieldValues = [];\n        fieldValues.push(values.toString());\n      } else if (ss.isValue(values) && ss.isValue(values.levels)) {\n        var levelValue = values.levels;\n        levelValues = [];\n\n        if (tab._jQueryShim.isArray(levelValue)) {\n          var levels = levelValue;\n\n          for (var i = 0; i < levels.length; i++) {\n            levelValues.push(levels[i].toString());\n          }\n        } else {\n          levelValues.push(levelValue.toString());\n        }\n      } else if (ss.isValue(values)) {\n        throw tab._TableauException.createInvalidParameter('values');\n      }\n\n      var commandParameters = {};\n      commandParameters['api.fieldCaption'] = fieldName;\n      commandParameters['api.filterUpdateType'] = updateType;\n      commandParameters['api.exclude'] = ss.isValue(options) && options.isExcludeMode ? true : false;\n\n      if (fieldValues != null) {\n        commandParameters['api.filterHierarchicalValues'] = tab.JsonUtil.toJson(fieldValues, false, '');\n      }\n\n      if (levelValues != null) {\n        commandParameters['api.filterHierarchicalLevels'] = tab.JsonUtil.toJson(levelValues, false, '');\n      }\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var deferred = new tab._Deferred();\n\n      var returnHandler = tab._WorksheetImpl._createFilterCommandReturnHandler$1('api.ApplyHierarchicalFilterCommand', fieldName, deferred);\n\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    get_selectedMarks: function tab__WorksheetImpl$get_selectedMarks() {\n      return this._selectedMarks$1;\n    },\n    set_selectedMarks: function tab__WorksheetImpl$set_selectedMarks(value) {\n      this._selectedMarks$1 = value;\n      return value;\n    },\n    _clearSelectedMarksAsync: function tab__WorksheetImpl$_clearSelectedMarksAsync() {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      commandParameters['api.filterUpdateType'] = 'replace';\n      var returnHandler = new tab._CommandReturnHandler('api.SelectMarksCommand', 1, function (result) {\n        deferred.resolve();\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _selectMarksAsync: function tab__WorksheetImpl$_selectMarksAsync(fieldNameOrFieldValuesMap, valueOrUpdateType, updateType) {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      if (fieldNameOrFieldValuesMap == null && valueOrUpdateType == null) {\n        return this._clearSelectedMarksAsync();\n      }\n\n      if (tab._Utility.isString(fieldNameOrFieldValuesMap) && (tab._jQueryShim.isArray(valueOrUpdateType) || tab._Utility.isString(valueOrUpdateType) || !tab._enums._isSelectionUpdateType(valueOrUpdateType))) {\n        return this._selectMarksWithFieldNameAndValueAsync$1(fieldNameOrFieldValuesMap, valueOrUpdateType, updateType);\n      } else if (tab._jQueryShim.isArray(fieldNameOrFieldValuesMap)) {\n        return this._selectMarksWithMarksArrayAsync$1(fieldNameOrFieldValuesMap, valueOrUpdateType);\n      } else {\n        return this._selectMarksWithMultiDimOptionAsync$1(fieldNameOrFieldValuesMap, valueOrUpdateType);\n      }\n    },\n    _getSelectedMarksAsync: function tab__WorksheetImpl$_getSelectedMarksAsync() {\n      this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();\n\n      var deferred = new tab._Deferred();\n      var commandParameters = {};\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      var returnHandler = new tab._CommandReturnHandler('api.FetchSelectedMarksCommand', 0, ss.Delegate.create(this, function (result) {\n        var pm = result;\n        this._selectedMarks$1 = tab._markImpl._processSelectedMarks(pm);\n        deferred.resolve(this._selectedMarks$1._toApiCollection());\n      }), function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    },\n    _selectMarksWithFieldNameAndValueAsync$1: function tab__WorksheetImpl$_selectMarksWithFieldNameAndValueAsync$1(fieldName, value, updateType) {\n      var catNameList = [];\n      var catValueList = [];\n      var hierNameList = [];\n      var hierValueList = [];\n      var rangeNameList = [];\n      var rangeValueList = [];\n\n      this._parseMarksParam$1(catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, fieldName, value);\n\n      return this._selectMarksWithValuesAsync$1(null, catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, updateType);\n    },\n    _selectMarksWithMultiDimOptionAsync$1: function tab__WorksheetImpl$_selectMarksWithMultiDimOptionAsync$1(fieldValuesMap, updateType) {\n      var dict = fieldValuesMap;\n      var catNameList = [];\n      var catValueList = [];\n      var hierNameList = [];\n      var hierValueList = [];\n      var rangeNameList = [];\n      var rangeValueList = [];\n      var $dict1 = dict;\n\n      for (var $key2 in $dict1) {\n        var ent = {\n          key: $key2,\n          value: $dict1[$key2]\n        };\n\n        if (fieldValuesMap.hasOwnProperty(ent.key)) {\n          if (!tab._jQueryShim.isFunction(dict[ent.key])) {\n            this._parseMarksParam$1(catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, ent.key, ent.value);\n          }\n        }\n      }\n\n      return this._selectMarksWithValuesAsync$1(null, catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, updateType);\n    },\n    _selectMarksWithMarksArrayAsync$1: function tab__WorksheetImpl$_selectMarksWithMarksArrayAsync$1(marksArray, updateType) {\n      var catNameList = [];\n      var catValueList = [];\n      var hierNameList = [];\n      var hierValueList = [];\n      var rangeNameList = [];\n      var rangeValueList = [];\n      var tupleIdList = [];\n\n      for (var i = 0; i < marksArray.length; i++) {\n        var mark = marksArray[i];\n\n        if (ss.isValue(mark._impl.get__tupleId()) && mark._impl.get__tupleId() > 0) {\n          tupleIdList.push(mark._impl.get__tupleId());\n        } else {\n          var pairs = mark._impl.get__pairs();\n\n          for (var j = 0; j < pairs.get__length(); j++) {\n            var pair = pairs.get_item(j);\n\n            if (pair.hasOwnProperty('fieldName') && pair.hasOwnProperty('value') && !tab._jQueryShim.isFunction(pair.fieldName) && !tab._jQueryShim.isFunction(pair.value)) {\n              this._parseMarksParam$1(catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, pair.fieldName, pair.value);\n            }\n          }\n        }\n      }\n\n      return this._selectMarksWithValuesAsync$1(tupleIdList, catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, updateType);\n    },\n    _parseMarksParam$1: function tab__WorksheetImpl$_parseMarksParam$1(catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, fieldName, value) {\n      var sourceOptions = value;\n\n      if (tab._WorksheetImpl._regexHierarchicalFieldName$1.test(fieldName)) {\n        this._addToParamLists$1(hierNameList, hierValueList, fieldName, value);\n      } else if (ss.isValue(sourceOptions.min) || ss.isValue(sourceOptions.max)) {\n        var range = {};\n\n        if (ss.isValue(sourceOptions.min)) {\n          if (tab._Utility.isDate(sourceOptions.min)) {\n            var dt = sourceOptions.min;\n\n            if (tab._Utility.isDateValid(dt)) {\n              range.min = tab._Utility.serializeDateForServer(dt);\n            } else {\n              throw tab._TableauException.createInvalidDateParameter('options.min');\n            }\n          } else {\n            range.min = sourceOptions.min;\n          }\n        }\n\n        if (ss.isValue(sourceOptions.max)) {\n          if (tab._Utility.isDate(sourceOptions.max)) {\n            var dt = sourceOptions.max;\n\n            if (tab._Utility.isDateValid(dt)) {\n              range.max = tab._Utility.serializeDateForServer(dt);\n            } else {\n              throw tab._TableauException.createInvalidDateParameter('options.max');\n            }\n          } else {\n            range.max = sourceOptions.max;\n          }\n        }\n\n        if (ss.isValue(sourceOptions.nullOption)) {\n          var nullOption = tab._enums._normalizeNullOption(sourceOptions.nullOption, 'options.nullOption');\n\n          range.nullOption = nullOption;\n        } else {\n          range.nullOption = 'allValues';\n        }\n\n        var jsonValue = tab.JsonUtil.toJson(range, false, '');\n\n        this._addToParamLists$1(rangeNameList, rangeValueList, fieldName, jsonValue);\n      } else {\n        this._addToParamLists$1(catNameList, catValueList, fieldName, value);\n      }\n    },\n    _addToParamLists$1: function tab__WorksheetImpl$_addToParamLists$1(paramNameList, paramValueList, paramName, paramValue) {\n      var markValues = [];\n\n      if (tab._jQueryShim.isArray(paramValue)) {\n        var values = paramValue;\n\n        for (var i = 0; i < values.length; i++) {\n          markValues.push(values[i]);\n        }\n      } else {\n        markValues.push(paramValue);\n      }\n\n      paramValueList.push(markValues);\n      paramNameList.push(paramName);\n    },\n    _selectMarksWithValuesAsync$1: function tab__WorksheetImpl$_selectMarksWithValuesAsync$1(tupleIdList, catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, updateType) {\n      var commandParameters = {};\n\n      this._addVisualIdToCommand$1(commandParameters);\n\n      updateType = tab._enums._normalizeSelectionUpdateType(updateType, 'updateType');\n      commandParameters['api.filterUpdateType'] = updateType;\n\n      if (!tab._Utility.isNullOrEmpty(tupleIdList)) {\n        commandParameters['api.tupleIds'] = tab.JsonUtil.toJson(tupleIdList, false, '');\n      }\n\n      if (!tab._Utility.isNullOrEmpty(catNameList) && !tab._Utility.isNullOrEmpty(catValueList)) {\n        commandParameters['api.categoricalFieldCaption'] = tab.JsonUtil.toJson(catNameList, false, '');\n        var markValues = [];\n\n        for (var i = 0; i < catValueList.length; i++) {\n          var values = tab.JsonUtil.toJson(catValueList[i], false, '');\n          markValues.push(values);\n        }\n\n        commandParameters['api.categoricalMarkValues'] = tab.JsonUtil.toJson(markValues, false, '');\n      }\n\n      if (!tab._Utility.isNullOrEmpty(hierNameList) && !tab._Utility.isNullOrEmpty(hierValueList)) {\n        commandParameters['api.hierarchicalFieldCaption'] = tab.JsonUtil.toJson(hierNameList, false, '');\n        var markValues = [];\n\n        for (var i = 0; i < hierValueList.length; i++) {\n          var values = tab.JsonUtil.toJson(hierValueList[i], false, '');\n          markValues.push(values);\n        }\n\n        commandParameters['api.hierarchicalMarkValues'] = tab.JsonUtil.toJson(markValues, false, '');\n      }\n\n      if (!tab._Utility.isNullOrEmpty(rangeNameList) && !tab._Utility.isNullOrEmpty(rangeValueList)) {\n        commandParameters['api.rangeFieldCaption'] = tab.JsonUtil.toJson(rangeNameList, false, '');\n        var markValues = [];\n\n        for (var i = 0; i < rangeValueList.length; i++) {\n          var values = tab.JsonUtil.toJson(rangeValueList[i], false, '');\n          markValues.push(values);\n        }\n\n        commandParameters['api.rangeMarkValues'] = tab.JsonUtil.toJson(markValues, false, '');\n      }\n\n      if (tab._Utility.isNullOrEmpty(commandParameters['api.tupleIds']) && tab._Utility.isNullOrEmpty(commandParameters['api.categoricalFieldCaption']) && tab._Utility.isNullOrEmpty(commandParameters['api.hierarchicalFieldCaption']) && tab._Utility.isNullOrEmpty(commandParameters['api.rangeFieldCaption'])) {\n        throw tab._TableauException.createInvalidParameter('fieldNameOrFieldValuesMap');\n      }\n\n      var deferred = new tab._Deferred();\n      var returnHandler = new tab._CommandReturnHandler('api.SelectMarksCommand', 1, function (result) {\n        var error = tab._WorksheetImpl._createSelectionCommandError$1(result);\n\n        if (error == null) {\n          deferred.resolve();\n        } else {\n          deferred.reject(error);\n        }\n      }, function (remoteError, message) {\n        deferred.reject(tab._TableauException.createServerError(message));\n      });\n      this.sendCommand(commandParameters, returnHandler);\n      return deferred.get_promise();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.JsonUtil\n\n  };\n\n  tab.JsonUtil = function tab_JsonUtil() {};\n\n  tab.JsonUtil.parseJson = function tab_JsonUtil$parseJson(jsonValue) {\n    return tab._jQueryShim.parseJSON(jsonValue);\n  };\n\n  tab.JsonUtil.toJson = function tab_JsonUtil$toJson(it, pretty, indentStr) {\n    pretty = pretty || false;\n    indentStr = indentStr || '';\n    var stack = [];\n    return tab.JsonUtil._serialize(it, pretty, indentStr, stack);\n  };\n\n  tab.JsonUtil._indexOf = function tab_JsonUtil$_indexOf(array, searchElement, fromIndex) {\n    if (ss.isValue(Array.prototype['indexOf'])) {\n      return array.indexOf(searchElement, fromIndex);\n    }\n\n    fromIndex = fromIndex || 0;\n    var length = array.length;\n\n    if (length > 0) {\n      for (var index = fromIndex; index < length; index++) {\n        if (array[index] === searchElement) {\n          return index;\n        }\n      }\n    }\n\n    return -1;\n  };\n\n  tab.JsonUtil._contains = function tab_JsonUtil$_contains(array, searchElement, fromIndex) {\n    var index = tab.JsonUtil._indexOf(array, searchElement, fromIndex);\n\n    return index >= 0;\n  };\n\n  tab.JsonUtil._serialize = function tab_JsonUtil$_serialize(it, pretty, indentStr, stack) {\n    if (tab.JsonUtil._contains(stack, it)) {\n      throw Error.createError('The object contains recursive reference of sub-objects', null);\n    }\n\n    if (ss.isUndefined(it)) {\n      return 'undefined';\n    }\n\n    if (it == null) {\n      return 'null';\n    }\n\n    var objtype = tab._jQueryShim.type(it);\n\n    if (objtype === 'number' || objtype === 'boolean') {\n      return it.toString();\n    }\n\n    if (objtype === 'string') {\n      return tab.JsonUtil._escapeString(it);\n    }\n\n    stack.push(it);\n    var newObj;\n    indentStr = indentStr || '';\n    var nextIndent = pretty ? indentStr + '\\t' : '';\n    var tf = it.__json__ || it.json;\n\n    if (tab._jQueryShim.isFunction(tf)) {\n      var jsonCallback = tf;\n      newObj = jsonCallback(it);\n\n      if (it !== newObj) {\n        var res = tab.JsonUtil._serialize(newObj, pretty, nextIndent, stack);\n\n        stack.pop();\n        return res;\n      }\n    }\n\n    if (ss.isValue(it.nodeType) && ss.isValue(it.cloneNode)) {\n      throw Error.createError(\"Can't serialize DOM nodes\", null);\n    }\n\n    var separator = pretty ? ' ' : '';\n    var newLine = pretty ? '\\n' : '';\n\n    if (tab._jQueryShim.isArray(it)) {\n      return tab.JsonUtil._serializeArray(it, pretty, indentStr, stack, nextIndent, newLine);\n    }\n\n    if (objtype === 'function') {\n      stack.pop();\n      return null;\n    }\n\n    return tab.JsonUtil._serializeGeneric(it, pretty, indentStr, stack, nextIndent, newLine, separator);\n  };\n\n  tab.JsonUtil._serializeGeneric = function tab_JsonUtil$_serializeGeneric(it, pretty, indentStr, stack, nextIndent, newLine, separator) {\n    var d = it;\n    var bdr = new ss.StringBuilder('{');\n    var init = false;\n    var $dict1 = d;\n\n    for (var $key2 in $dict1) {\n      var e = {\n        key: $key2,\n        value: $dict1[$key2]\n      };\n      var keyStr;\n      var val;\n\n      if (typeof e.key === 'number') {\n        keyStr = '\"' + e.key + '\"';\n      } else if (typeof e.key === 'string') {\n        keyStr = tab.JsonUtil._escapeString(e.key);\n      } else {\n        continue;\n      }\n\n      val = tab.JsonUtil._serialize(e.value, pretty, nextIndent, stack);\n\n      if (val == null) {\n        continue;\n      }\n\n      if (init) {\n        bdr.append(',');\n      }\n\n      bdr.append(newLine + nextIndent + keyStr + ':' + separator + val);\n      init = true;\n    }\n\n    bdr.append(newLine + indentStr + '}');\n    stack.pop();\n    return bdr.toString();\n  };\n\n  tab.JsonUtil._serializeArray = function tab_JsonUtil$_serializeArray(it, pretty, indentStr, stack, nextIndent, newLine) {\n    var initialized = false;\n    var sb = new ss.StringBuilder('[');\n    var a = it;\n\n    for (var i = 0; i < a.length; i++) {\n      var o = a[i];\n\n      var s = tab.JsonUtil._serialize(o, pretty, nextIndent, stack);\n\n      if (s == null) {\n        s = 'undefined';\n      }\n\n      if (initialized) {\n        sb.append(',');\n      }\n\n      sb.append(newLine + nextIndent + s);\n      initialized = true;\n    }\n\n    sb.append(newLine + indentStr + ']');\n    stack.pop();\n    return sb.toString();\n  };\n\n  tab.JsonUtil._escapeString = function tab_JsonUtil$_escapeString(str) {\n    str = '\"' + str.replace(/([\"\\\\])/g, '\\\\$1') + '\"';\n    str = str.replace(new RegExp(\"[\\f]\", 'g'), '\\\\f');\n    str = str.replace(new RegExp(\"[\\b]\", 'g'), '\\\\b');\n    str = str.replace(new RegExp('[\\n]', 'g'), '\\\\n');\n    str = str.replace(new RegExp('[\\t]', 'g'), '\\\\t');\n    str = str.replace(new RegExp('[\\r]', 'g'), '\\\\r');\n    return str;\n  };\n\n  Type.registerNamespace('tableauSoftware'); ////////////////////////////////////////////////////////////////////////////////\n  // tab.DataValue\n\n  tab.$create_DataValue = function tab_DataValue(value, formattedValue, aliasedValue) {\n    var $o = {};\n    $o.value = value;\n\n    if (tab._Utility.isNullOrEmpty(aliasedValue)) {\n      $o.formattedValue = formattedValue;\n    } else {\n      $o.formattedValue = aliasedValue;\n    }\n\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.VizSize\n\n\n  tab.$create_VizSize = function tab_VizSize(sheetSize, chromeHeight) {\n    var $o = {};\n    $o.sheetSize = sheetSize;\n    $o.chromeHeight = chromeHeight;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.Point\n\n\n  tab.$create_Point = function tab_Point(x, y) {\n    var $o = {};\n    $o.x = x;\n    $o.y = y;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.Size\n\n\n  tab.$create_Size = function tab_Size(width, height) {\n    var $o = {};\n    $o.width = width;\n    $o.height = height;\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tab.SheetSize\n\n\n  tab.$create_SheetSize = function tab_SheetSize(behavior, minSize, maxSize) {\n    var $o = {};\n    $o.behavior = behavior || 'automatic';\n\n    if (ss.isValue(minSize)) {\n      $o.minSize = minSize;\n    }\n\n    if (ss.isValue(maxSize)) {\n      $o.maxSize = maxSize;\n    }\n\n    return $o;\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tableauSoftware.CustomView\n\n\n  tableauSoftware.CustomView = function tableauSoftware_CustomView(customViewImpl) {\n    this._impl = customViewImpl;\n  };\n\n  tableauSoftware.CustomView.prototype = {\n    _impl: null,\n    getWorkbook: function tableauSoftware_CustomView$getWorkbook() {\n      return this._impl.get__workbook();\n    },\n    getUrl: function tableauSoftware_CustomView$getUrl() {\n      return this._impl.get__url();\n    },\n    getName: function tableauSoftware_CustomView$getName() {\n      return this._impl.get__name();\n    },\n    setName: function tableauSoftware_CustomView$setName(value) {\n      this._impl.set__name(value);\n    },\n    getOwnerName: function tableauSoftware_CustomView$getOwnerName() {\n      return this._impl.get__ownerName();\n    },\n    getAdvertised: function tableauSoftware_CustomView$getAdvertised() {\n      return this._impl.get__advertised();\n    },\n    setAdvertised: function tableauSoftware_CustomView$setAdvertised(value) {\n      this._impl.set__advertised(value);\n    },\n    getDefault: function tableauSoftware_CustomView$getDefault() {\n      return this._impl.get__isDefault();\n    },\n    saveAsync: function tableauSoftware_CustomView$saveAsync() {\n      return this._impl.saveAsync();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.CustomViewEvent\n\n  };\n\n  tab.CustomViewEvent = function tab_CustomViewEvent(eventName, viz, customViewImpl) {\n    tab.CustomViewEvent.initializeBase(this, [eventName, viz]);\n    this._context$1 = new tab._customViewEventContext(viz._impl.get__workbookImpl(), customViewImpl);\n  };\n\n  tab.CustomViewEvent.prototype = {\n    _context$1: null,\n    getCustomViewAsync: function tab_CustomViewEvent$getCustomViewAsync() {\n      var deferred = new tab._Deferred();\n      var customView = null;\n\n      if (ss.isValue(this._context$1.get__customViewImpl())) {\n        customView = this._context$1.get__customViewImpl().get__customView();\n      }\n\n      deferred.resolve(customView);\n      return deferred.get_promise();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._customViewEventContext\n\n  };\n\n  tab._customViewEventContext = function tab__customViewEventContext(workbook, customViewImpl) {\n    tab._customViewEventContext.initializeBase(this, [workbook, null]);\n\n    this._customViewImpl$1 = customViewImpl;\n  };\n\n  tab._customViewEventContext.prototype = {\n    _customViewImpl$1: null,\n    get__customViewImpl: function tab__customViewEventContext$get__customViewImpl() {\n      return this._customViewImpl$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Dashboard\n\n  };\n\n  tableauSoftware.Dashboard = function tableauSoftware_Dashboard(dashboardImpl) {\n    tableauSoftware.Dashboard.initializeBase(this, [dashboardImpl]);\n  };\n\n  tableauSoftware.Dashboard.prototype = {\n    _impl: null,\n    getParentStoryPoint: function tableauSoftware_Dashboard$getParentStoryPoint() {\n      return this._impl.get_parentStoryPoint();\n    },\n    getObjects: function tableauSoftware_Dashboard$getObjects() {\n      return this._impl.get_objects()._toApiCollection();\n    },\n    getWorksheets: function tableauSoftware_Dashboard$getWorksheets() {\n      return this._impl.get_worksheets()._toApiCollection();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.DashboardObject\n\n  };\n\n  tableauSoftware.DashboardObject = function tableauSoftware_DashboardObject(frameInfo, dashboard, worksheet) {\n    if (frameInfo._objectType === 'worksheet' && ss.isNullOrUndefined(worksheet)) {\n      throw tab._TableauException.createInternalError('worksheet parameter is required for WORKSHEET objects');\n    } else if (frameInfo._objectType !== 'worksheet' && ss.isValue(worksheet)) {\n      throw tab._TableauException.createInternalError('worksheet parameter should be undefined for non-WORKSHEET objects');\n    }\n\n    this._zoneInfo = frameInfo;\n    this._dashboard = dashboard;\n    this._worksheet = worksheet;\n  };\n\n  tableauSoftware.DashboardObject.prototype = {\n    _zoneInfo: null,\n    _dashboard: null,\n    _worksheet: null,\n    getObjectType: function tableauSoftware_DashboardObject$getObjectType() {\n      return this._zoneInfo._objectType;\n    },\n    getDashboard: function tableauSoftware_DashboardObject$getDashboard() {\n      return this._dashboard;\n    },\n    getWorksheet: function tableauSoftware_DashboardObject$getWorksheet() {\n      return this._worksheet;\n    },\n    getPosition: function tableauSoftware_DashboardObject$getPosition() {\n      return this._zoneInfo._position;\n    },\n    getSize: function tableauSoftware_DashboardObject$getSize() {\n      return this._zoneInfo._size;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.DataSource\n\n  };\n\n  tableauSoftware.DataSource = function tableauSoftware_DataSource(impl) {\n    this._impl = impl;\n  };\n\n  tableauSoftware.DataSource.prototype = {\n    _impl: null,\n    getName: function tableauSoftware_DataSource$getName() {\n      return this._impl.get_name();\n    },\n    getFields: function tableauSoftware_DataSource$getFields() {\n      return this._impl.get_fields()._toApiCollection();\n    },\n    getIsPrimary: function tableauSoftware_DataSource$getIsPrimary() {\n      return this._impl.get_isPrimary();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Field\n\n  };\n\n  tableauSoftware.Field = function tableauSoftware_Field(dataSource, name, fieldRoleType, fieldAggrType) {\n    this._dataSource = dataSource;\n    this._name = name;\n    this._fieldRoleType = fieldRoleType;\n    this._fieldAggrType = fieldAggrType;\n  };\n\n  tableauSoftware.Field.prototype = {\n    _dataSource: null,\n    _name: null,\n    _fieldRoleType: null,\n    _fieldAggrType: null,\n    getDataSource: function tableauSoftware_Field$getDataSource() {\n      return this._dataSource;\n    },\n    getName: function tableauSoftware_Field$getName() {\n      return this._name;\n    },\n    getRole: function tableauSoftware_Field$getRole() {\n      return this._fieldRoleType;\n    },\n    getAggregation: function tableauSoftware_Field$getAggregation() {\n      return this._fieldAggrType;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.CategoricalFilter\n\n  };\n\n  tableauSoftware.CategoricalFilter = function tableauSoftware_CategoricalFilter(worksheetImpl, pm) {\n    tableauSoftware.CategoricalFilter.initializeBase(this, [worksheetImpl, pm]);\n\n    this._initializeFromJson$1(pm);\n  };\n\n  tableauSoftware.CategoricalFilter.prototype = {\n    _isExclude$1: false,\n    _appliedValues$1: null,\n    getIsExcludeMode: function tableauSoftware_CategoricalFilter$getIsExcludeMode() {\n      return this._isExclude$1;\n    },\n    getAppliedValues: function tableauSoftware_CategoricalFilter$getAppliedValues() {\n      return this._appliedValues$1;\n    },\n    _updateFromJson: function tableauSoftware_CategoricalFilter$_updateFromJson(pm) {\n      this._initializeFromJson$1(pm);\n    },\n    _initializeFromJson$1: function tableauSoftware_CategoricalFilter$_initializeFromJson$1(pm) {\n      this._isExclude$1 = pm.isExclude;\n\n      if (ss.isValue(pm.appliedValues)) {\n        this._appliedValues$1 = [];\n        var $enum1 = ss.IEnumerator.getEnumerator(pm.appliedValues);\n\n        while ($enum1.moveNext()) {\n          var v = $enum1.current;\n\n          this._appliedValues$1.push(tab._Utility.getDataValue(v));\n        }\n      }\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Filter\n\n  };\n\n  tableauSoftware.Filter = function tableauSoftware_Filter(worksheetImpl, pm) {\n    this._worksheetImpl = worksheetImpl;\n\n    this._initializeFromJson(pm);\n  };\n\n  tableauSoftware.Filter._createFilter = function tableauSoftware_Filter$_createFilter(worksheetImpl, pm) {\n    switch (pm.filterType) {\n      case 'categorical':\n        return new tableauSoftware.CategoricalFilter(worksheetImpl, pm);\n\n      case 'relativedate':\n        return new tableauSoftware.RelativeDateFilter(worksheetImpl, pm);\n\n      case 'hierarchical':\n        return new tableauSoftware.HierarchicalFilter(worksheetImpl, pm);\n\n      case 'quantitative':\n        return new tableauSoftware.QuantitativeFilter(worksheetImpl, pm);\n    }\n\n    return null;\n  };\n\n  tableauSoftware.Filter._processFiltersList = function tableauSoftware_Filter$_processFiltersList(worksheetImpl, filtersListDict) {\n    var filters = new tab._Collection();\n    var $enum1 = ss.IEnumerator.getEnumerator(filtersListDict.filters);\n\n    while ($enum1.moveNext()) {\n      var filterPm = $enum1.current;\n\n      var filter = tableauSoftware.Filter._createFilter(worksheetImpl, filterPm);\n\n      filters._add(filterPm.caption, filter);\n    }\n\n    return filters;\n  };\n\n  tableauSoftware.Filter.prototype = {\n    _worksheetImpl: null,\n    _type: null,\n    _caption: null,\n    _field: null,\n    _dataSourceName: null,\n    _fieldRole: null,\n    _fieldAggregation: null,\n    getFilterType: function tableauSoftware_Filter$getFilterType() {\n      return this._type;\n    },\n    getFieldName: function tableauSoftware_Filter$getFieldName() {\n      return this._caption;\n    },\n    getWorksheet: function tableauSoftware_Filter$getWorksheet() {\n      return this._worksheetImpl.get_worksheet();\n    },\n    getFieldAsync: function tableauSoftware_Filter$getFieldAsync() {\n      var deferred = new tab._Deferred();\n\n      if (this._field == null) {\n        var rejected = function rejected(e) {\n          deferred.reject(e);\n          return null;\n        };\n\n        var fulfilled = ss.Delegate.create(this, function (value) {\n          this._field = new tableauSoftware.Field(value, this._caption, this._fieldRole, this._fieldAggregation);\n          deferred.resolve(this._field);\n          return null;\n        });\n\n        this._worksheetImpl._getDataSourceAsync(this._dataSourceName).then(fulfilled, rejected);\n      } else {\n        window.setTimeout(ss.Delegate.create(this, function () {\n          deferred.resolve(this._field);\n        }), 0);\n      }\n\n      return deferred.get_promise();\n    },\n    _update: function tableauSoftware_Filter$_update(pm) {\n      this._initializeFromJson(pm);\n\n      this._updateFromJson(pm);\n    },\n    _addFieldParams: function tableauSoftware_Filter$_addFieldParams(param) {},\n    _initializeFromJson: function tableauSoftware_Filter$_initializeFromJson(pm) {\n      this._caption = pm.caption;\n      this._type = pm.filterType;\n      this._field = null;\n      this._dataSourceName = pm.dataSourceName;\n      this._fieldRole = pm.fieldRole || 0;\n      this._fieldAggregation = pm.fieldAggregation || 0;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.FilterEvent\n\n  };\n\n  tab.FilterEvent = function tab_FilterEvent(eventName, viz, worksheetImpl, fieldName, filterCaption) {\n    tab.FilterEvent.initializeBase(this, [eventName, viz, worksheetImpl]);\n    this._filterCaption$2 = filterCaption;\n    this._context$2 = new tab._filterEventContext(viz._impl.get__workbookImpl(), worksheetImpl, fieldName, filterCaption);\n  };\n\n  tab.FilterEvent.prototype = {\n    _filterCaption$2: null,\n    _context$2: null,\n    getFieldName: function tab_FilterEvent$getFieldName() {\n      return this._filterCaption$2;\n    },\n    getFilterAsync: function tab_FilterEvent$getFilterAsync() {\n      return this._context$2.get__worksheetImpl()._getFilterAsync(this._context$2.get__filterFieldName(), null, null);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._filterEventContext\n\n  };\n\n  tab._filterEventContext = function tab__filterEventContext(workbookImpl, worksheetImpl, fieldFieldName, filterCaption) {\n    tab._filterEventContext.initializeBase(this, [workbookImpl, worksheetImpl]);\n\n    this._fieldFieldName$1 = fieldFieldName;\n    this._filterCaption$1 = filterCaption;\n  };\n\n  tab._filterEventContext.prototype = {\n    _fieldFieldName$1: null,\n    _filterCaption$1: null,\n    get__filterFieldName: function tab__filterEventContext$get__filterFieldName() {\n      return this._fieldFieldName$1;\n    },\n    get__filterCaption: function tab__filterEventContext$get__filterCaption() {\n      return this._filterCaption$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.HierarchicalFilter\n\n  };\n\n  tableauSoftware.HierarchicalFilter = function tableauSoftware_HierarchicalFilter(worksheetImpl, pm) {\n    tableauSoftware.HierarchicalFilter.initializeBase(this, [worksheetImpl, pm]);\n\n    this._initializeFromJson$1(pm);\n  };\n\n  tableauSoftware.HierarchicalFilter.prototype = {\n    _levels$1: 0,\n    _addFieldParams: function tableauSoftware_HierarchicalFilter$_addFieldParams(param) {\n      param['api.filterHierarchicalLevels'] = this._levels$1;\n    },\n    _updateFromJson: function tableauSoftware_HierarchicalFilter$_updateFromJson(pm) {\n      this._initializeFromJson$1(pm);\n    },\n    _initializeFromJson$1: function tableauSoftware_HierarchicalFilter$_initializeFromJson$1(pm) {\n      this._levels$1 = pm.levels;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.QuantitativeFilter\n\n  };\n\n  tableauSoftware.QuantitativeFilter = function tableauSoftware_QuantitativeFilter(worksheetImpl, pm) {\n    tableauSoftware.QuantitativeFilter.initializeBase(this, [worksheetImpl, pm]);\n\n    this._initializeFromJson$1(pm);\n  };\n\n  tableauSoftware.QuantitativeFilter.prototype = {\n    _domainMin$1: null,\n    _domainMax$1: null,\n    _min$1: null,\n    _max$1: null,\n    _includeNullValues$1: false,\n    getMin: function tableauSoftware_QuantitativeFilter$getMin() {\n      return this._min$1;\n    },\n    getMax: function tableauSoftware_QuantitativeFilter$getMax() {\n      return this._max$1;\n    },\n    getIncludeNullValues: function tableauSoftware_QuantitativeFilter$getIncludeNullValues() {\n      return this._includeNullValues$1;\n    },\n    getDomainMin: function tableauSoftware_QuantitativeFilter$getDomainMin() {\n      return this._domainMin$1;\n    },\n    getDomainMax: function tableauSoftware_QuantitativeFilter$getDomainMax() {\n      return this._domainMax$1;\n    },\n    _updateFromJson: function tableauSoftware_QuantitativeFilter$_updateFromJson(pm) {\n      this._initializeFromJson$1(pm);\n    },\n    _initializeFromJson$1: function tableauSoftware_QuantitativeFilter$_initializeFromJson$1(pm) {\n      this._domainMin$1 = tab._Utility.getDataValue(pm.domainMinValue);\n      this._domainMax$1 = tab._Utility.getDataValue(pm.domainMaxValue);\n      this._min$1 = tab._Utility.getDataValue(pm.minValue);\n      this._max$1 = tab._Utility.getDataValue(pm.maxValue);\n      this._includeNullValues$1 = pm.includeNullValues;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.RelativeDateFilter\n\n  };\n\n  tableauSoftware.RelativeDateFilter = function tableauSoftware_RelativeDateFilter(worksheetImpl, pm) {\n    tableauSoftware.RelativeDateFilter.initializeBase(this, [worksheetImpl, pm]);\n\n    this._initializeFromJson$1(pm);\n  };\n\n  tableauSoftware.RelativeDateFilter.prototype = {\n    _periodType$1: null,\n    _rangeType$1: null,\n    _rangeN$1: 0,\n    getPeriod: function tableauSoftware_RelativeDateFilter$getPeriod() {\n      return this._periodType$1;\n    },\n    getRange: function tableauSoftware_RelativeDateFilter$getRange() {\n      return this._rangeType$1;\n    },\n    getRangeN: function tableauSoftware_RelativeDateFilter$getRangeN() {\n      return this._rangeN$1;\n    },\n    _updateFromJson: function tableauSoftware_RelativeDateFilter$_updateFromJson(pm) {\n      this._initializeFromJson$1(pm);\n    },\n    _initializeFromJson$1: function tableauSoftware_RelativeDateFilter$_initializeFromJson$1(pm) {\n      if (ss.isValue(pm.periodType)) {\n        this._periodType$1 = tab._enums._normalizePeriodType(pm.periodType, 'periodType');\n      }\n\n      if (ss.isValue(pm.rangeType)) {\n        this._rangeType$1 = tab._enums._normalizeDateRangeType(pm.rangeType, 'rangeType');\n      }\n\n      if (ss.isValue(pm.rangeN)) {\n        this._rangeN$1 = pm.rangeN;\n      }\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.FirstVizSizeKnownEvent\n\n  };\n\n  tab.FirstVizSizeKnownEvent = function tab_FirstVizSizeKnownEvent(eventName, viz, vizSize) {\n    tab.FirstVizSizeKnownEvent.initializeBase(this, [eventName, viz]);\n    this._vizSize$1 = vizSize;\n  };\n\n  tab.FirstVizSizeKnownEvent.prototype = {\n    _vizSize$1: null,\n    getVizSize: function tab_FirstVizSizeKnownEvent$getVizSize() {\n      return this._vizSize$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Version\n\n  };\n\n  tableauSoftware.Version = function tableauSoftware_Version(major, minor, patch, metadata) {\n    this._major = major;\n    this._minor = minor;\n    this._patch = patch;\n    this._metadata = metadata || null;\n  };\n\n  tableauSoftware.Version.getCurrent = function tableauSoftware_Version$getCurrent() {\n    return tableauSoftware.Version._currentVersion;\n  };\n\n  tableauSoftware.Version.prototype = {\n    _major: 0,\n    _minor: 0,\n    _patch: 0,\n    _metadata: null,\n    getMajor: function tableauSoftware_Version$getMajor() {\n      return this._major;\n    },\n    getMinor: function tableauSoftware_Version$getMinor() {\n      return this._minor;\n    },\n    getPatch: function tableauSoftware_Version$getPatch() {\n      return this._patch;\n    },\n    getMetadata: function tableauSoftware_Version$getMetadata() {\n      return this._metadata;\n    },\n    toString: function tableauSoftware_Version$toString() {\n      var version = this._major + '.' + this._minor + '.' + this._patch;\n\n      if (ss.isValue(this._metadata) && this._metadata.length > 0) {\n        version += '-' + this._metadata;\n      }\n\n      return version;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.VizResizeEvent\n\n  };\n\n  tab.VizResizeEvent = function tab_VizResizeEvent(eventName, viz, availableSize) {\n    tab.VizResizeEvent.initializeBase(this, [eventName, viz]);\n    this._availableSize$1 = availableSize;\n  };\n\n  tab.VizResizeEvent.prototype = {\n    _availableSize$1: null,\n    getAvailableSize: function tab_VizResizeEvent$getAvailableSize() {\n      return this._availableSize$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Mark\n\n  };\n\n  tableauSoftware.Mark = function tableauSoftware_Mark(tupleId) {\n    this._impl = new tab._markImpl(tupleId);\n  };\n\n  tableauSoftware.Mark.prototype = {\n    _impl: null,\n    getPairs: function tableauSoftware_Mark$getPairs() {\n      return this._impl.get__clonedPairs();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.MarksEvent\n\n  };\n\n  tab.MarksEvent = function tab_MarksEvent(eventName, viz, worksheetImpl) {\n    tab.MarksEvent.initializeBase(this, [eventName, viz, worksheetImpl]);\n    this._context$2 = new tab._marksEventContext(viz._impl.get__workbookImpl(), worksheetImpl);\n  };\n\n  tab.MarksEvent.prototype = {\n    _context$2: null,\n    getMarksAsync: function tab_MarksEvent$getMarksAsync() {\n      var worksheetImpl = this._context$2.get__worksheetImpl();\n\n      if (ss.isValue(worksheetImpl.get_selectedMarks())) {\n        var deferred = new tab._Deferred();\n        return deferred.resolve(worksheetImpl.get_selectedMarks()._toApiCollection());\n      }\n\n      return worksheetImpl._getSelectedMarksAsync();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._marksEventContext\n\n  };\n\n  tab._marksEventContext = function tab__marksEventContext(workbookImpl, worksheetImpl) {\n    tab._marksEventContext.initializeBase(this, [workbookImpl, worksheetImpl]);\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tableauSoftware.Pair\n\n\n  tableauSoftware.Pair = function tableauSoftware_Pair(fieldName, value) {\n    this.fieldName = fieldName;\n    this.value = value;\n    this.formattedValue = ss.isValue(value) ? value.toString() : '';\n  };\n\n  tableauSoftware.Pair.prototype = {\n    fieldName: null,\n    value: null,\n    formattedValue: null ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Parameter\n\n  };\n\n  tableauSoftware.Parameter = function tableauSoftware_Parameter(impl) {\n    this._impl = impl;\n  };\n\n  tableauSoftware.Parameter.prototype = {\n    _impl: null,\n    getName: function tableauSoftware_Parameter$getName() {\n      return this._impl.get__name();\n    },\n    getCurrentValue: function tableauSoftware_Parameter$getCurrentValue() {\n      return this._impl.get__currentValue();\n    },\n    getDataType: function tableauSoftware_Parameter$getDataType() {\n      return this._impl.get__dataType();\n    },\n    getAllowableValuesType: function tableauSoftware_Parameter$getAllowableValuesType() {\n      return this._impl.get__allowableValuesType();\n    },\n    getAllowableValues: function tableauSoftware_Parameter$getAllowableValues() {\n      return this._impl.get__allowableValues();\n    },\n    getMinValue: function tableauSoftware_Parameter$getMinValue() {\n      return this._impl.get__minValue();\n    },\n    getMaxValue: function tableauSoftware_Parameter$getMaxValue() {\n      return this._impl.get__maxValue();\n    },\n    getStepSize: function tableauSoftware_Parameter$getStepSize() {\n      return this._impl.get__stepSize();\n    },\n    getDateStepPeriod: function tableauSoftware_Parameter$getDateStepPeriod() {\n      return this._impl.get__dateStepPeriod();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.ParameterEvent\n\n  };\n\n  tab.ParameterEvent = function tab_ParameterEvent(eventName, viz, parameterName) {\n    tab.ParameterEvent.initializeBase(this, [eventName, viz]);\n    this._context$1 = new tab._parameterEventContext(viz._impl.get__workbookImpl(), parameterName);\n  };\n\n  tab.ParameterEvent.prototype = {\n    _context$1: null,\n    getParameterName: function tab_ParameterEvent$getParameterName() {\n      return this._context$1.get__parameterName();\n    },\n    getParameterAsync: function tab_ParameterEvent$getParameterAsync() {\n      return this._context$1.get__workbookImpl()._getSingleParameterAsync(this._context$1.get__parameterName());\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._parameterEventContext\n\n  };\n\n  tab._parameterEventContext = function tab__parameterEventContext(workbookImpl, parameterName) {\n    tab._parameterEventContext.initializeBase(this, [workbookImpl, null]);\n\n    this._parameterName$1 = parameterName;\n  };\n\n  tab._parameterEventContext.prototype = {\n    _parameterName$1: null,\n    get__parameterName: function tab__parameterEventContext$get__parameterName() {\n      return this._parameterName$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Sheet\n\n  };\n\n  tableauSoftware.Sheet = function tableauSoftware_Sheet(sheetImpl) {\n    tab._Param.verifyValue(sheetImpl, 'sheetImpl');\n\n    this._impl = sheetImpl;\n  };\n\n  tableauSoftware.Sheet.prototype = {\n    _impl: null,\n    getName: function tableauSoftware_Sheet$getName() {\n      return this._impl.get_name();\n    },\n    getIndex: function tableauSoftware_Sheet$getIndex() {\n      return this._impl.get_index();\n    },\n    getWorkbook: function tableauSoftware_Sheet$getWorkbook() {\n      return this._impl.get_workbookImpl().get_workbook();\n    },\n    getSize: function tableauSoftware_Sheet$getSize() {\n      return this._impl.get_size();\n    },\n    getIsHidden: function tableauSoftware_Sheet$getIsHidden() {\n      return this._impl.get_isHidden();\n    },\n    getIsActive: function tableauSoftware_Sheet$getIsActive() {\n      return this._impl.get_isActive();\n    },\n    getSheetType: function tableauSoftware_Sheet$getSheetType() {\n      return this._impl.get_sheetType();\n    },\n    getUrl: function tableauSoftware_Sheet$getUrl() {\n      return this._impl.get_url();\n    },\n    changeSizeAsync: function tableauSoftware_Sheet$changeSizeAsync(size) {\n      return this._impl.changeSizeAsync(size);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.SheetInfo\n\n  };\n\n  tableauSoftware.SheetInfo = function tableauSoftware_SheetInfo(impl) {\n    this._impl = impl;\n  };\n\n  tableauSoftware.SheetInfo.prototype = {\n    _impl: null,\n    getName: function tableauSoftware_SheetInfo$getName() {\n      return this._impl.name;\n    },\n    getSheetType: function tableauSoftware_SheetInfo$getSheetType() {\n      return this._impl.sheetType;\n    },\n    getSize: function tableauSoftware_SheetInfo$getSize() {\n      return this._impl.size;\n    },\n    getIndex: function tableauSoftware_SheetInfo$getIndex() {\n      return this._impl.index;\n    },\n    getUrl: function tableauSoftware_SheetInfo$getUrl() {\n      return this._impl.url;\n    },\n    getIsActive: function tableauSoftware_SheetInfo$getIsActive() {\n      return this._impl.isActive;\n    },\n    getIsHidden: function tableauSoftware_SheetInfo$getIsHidden() {\n      return this._impl.isHidden;\n    },\n    getWorkbook: function tableauSoftware_SheetInfo$getWorkbook() {\n      return this._impl.workbook;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.SheetSizeFactory\n\n  };\n\n  tab.SheetSizeFactory = function tab_SheetSizeFactory() {};\n\n  tab.SheetSizeFactory.createAutomatic = function tab_SheetSizeFactory$createAutomatic() {\n    var size = tab.$create_SheetSize('automatic', null, null);\n    return size;\n  };\n\n  tab.SheetSizeFactory.fromSizeConstraints = function tab_SheetSizeFactory$fromSizeConstraints(vizSizePresModel) {\n    var minHeight = vizSizePresModel.minHeight;\n    var minWidth = vizSizePresModel.minWidth;\n    var maxHeight = vizSizePresModel.maxHeight;\n    var maxWidth = vizSizePresModel.maxWidth;\n    var behavior = 'automatic';\n    var minSize = null;\n    var maxSize = null;\n\n    if (!minHeight && !minWidth) {\n      if (!maxHeight && !maxWidth) {} else {\n        behavior = 'atmost';\n        maxSize = tab.$create_Size(maxWidth, maxHeight);\n      }\n    } else if (!maxHeight && !maxWidth) {\n      behavior = 'atleast';\n      minSize = tab.$create_Size(minWidth, minHeight);\n    } else if (maxHeight === minHeight && maxWidth === minWidth) {\n      behavior = 'exactly';\n      minSize = tab.$create_Size(minWidth, minHeight);\n      maxSize = tab.$create_Size(minWidth, minHeight);\n    } else {\n      behavior = 'range';\n      minSize = tab.$create_Size(minWidth, minHeight);\n      maxSize = tab.$create_Size(maxWidth, maxHeight);\n    }\n\n    return tab.$create_SheetSize(behavior, minSize, maxSize);\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tableauSoftware.Story\n\n\n  tableauSoftware.Story = function tableauSoftware_Story(storyImpl) {\n    tableauSoftware.Story.initializeBase(this, [storyImpl]);\n  };\n\n  tableauSoftware.Story.prototype = {\n    _impl: null,\n    getActiveStoryPoint: function tableauSoftware_Story$getActiveStoryPoint() {\n      return this._impl.get_activeStoryPointImpl().get_storyPoint();\n    },\n    getStoryPointsInfo: function tableauSoftware_Story$getStoryPointsInfo() {\n      return this._impl.get_storyPointsInfo();\n    },\n    activatePreviousStoryPointAsync: function tableauSoftware_Story$activatePreviousStoryPointAsync() {\n      return this._impl.activatePreviousStoryPointAsync();\n    },\n    activateNextStoryPointAsync: function tableauSoftware_Story$activateNextStoryPointAsync() {\n      return this._impl.activateNextStoryPointAsync();\n    },\n    activateStoryPointAsync: function tableauSoftware_Story$activateStoryPointAsync(index) {\n      return this._impl.activateStoryPointAsync(index);\n    },\n    revertStoryPointAsync: function tableauSoftware_Story$revertStoryPointAsync(index) {\n      return this._impl.revertStoryPointAsync(index);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.StoryPoint\n\n  };\n\n  tableauSoftware.StoryPoint = function tableauSoftware_StoryPoint(impl) {\n    this._impl = impl;\n  };\n\n  tableauSoftware.StoryPoint.prototype = {\n    _impl: null,\n    getCaption: function tableauSoftware_StoryPoint$getCaption() {\n      return this._impl.get_caption();\n    },\n    getContainedSheet: function tableauSoftware_StoryPoint$getContainedSheet() {\n      return ss.isValue(this._impl.get_containedSheetImpl()) ? this._impl.get_containedSheetImpl().get_sheet() : null;\n    },\n    getIndex: function tableauSoftware_StoryPoint$getIndex() {\n      return this._impl.get_index();\n    },\n    getIsActive: function tableauSoftware_StoryPoint$getIsActive() {\n      return this._impl.get_isActive();\n    },\n    getIsUpdated: function tableauSoftware_StoryPoint$getIsUpdated() {\n      return this._impl.get_isUpdated();\n    },\n    getParentStory: function tableauSoftware_StoryPoint$getParentStory() {\n      return this._impl.get_parentStoryImpl().get_story();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.StoryPointInfo\n\n  };\n\n  tableauSoftware.StoryPointInfo = function tableauSoftware_StoryPointInfo(impl) {\n    this._impl = impl;\n  };\n\n  tableauSoftware.StoryPointInfo.prototype = {\n    _impl: null,\n    getCaption: function tableauSoftware_StoryPointInfo$getCaption() {\n      return this._impl.caption;\n    },\n    getIndex: function tableauSoftware_StoryPointInfo$getIndex() {\n      return this._impl.index;\n    },\n    getIsActive: function tableauSoftware_StoryPointInfo$getIsActive() {\n      return this._impl.isActive;\n    },\n    getIsUpdated: function tableauSoftware_StoryPointInfo$getIsUpdated() {\n      return this._impl.isUpdated;\n    },\n    getParentStory: function tableauSoftware_StoryPointInfo$getParentStory() {\n      return this._impl.parentStoryImpl.get_story();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.StoryPointSwitchEvent\n\n  };\n\n  tab.StoryPointSwitchEvent = function tab_StoryPointSwitchEvent(eventName, viz, oldStoryPointInfo, newStoryPoint) {\n    tab.StoryPointSwitchEvent.initializeBase(this, [eventName, viz]);\n    this._oldStoryPointInfo$1 = oldStoryPointInfo;\n    this._newStoryPoint$1 = newStoryPoint;\n  };\n\n  tab.StoryPointSwitchEvent.prototype = {\n    _oldStoryPointInfo$1: null,\n    _newStoryPoint$1: null,\n    getOldStoryPointInfo: function tab_StoryPointSwitchEvent$getOldStoryPointInfo() {\n      return this._oldStoryPointInfo$1;\n    },\n    getNewStoryPoint: function tab_StoryPointSwitchEvent$getNewStoryPoint() {\n      return this._newStoryPoint$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.TableauEvent\n\n  };\n\n  tab.TableauEvent = function tab_TableauEvent(eventName, viz) {\n    this._viz = viz;\n    this._eventName = eventName;\n  };\n\n  tab.TableauEvent.prototype = {\n    _viz: null,\n    _eventName: null,\n    getViz: function tab_TableauEvent$getViz() {\n      return this._viz;\n    },\n    getEventName: function tab_TableauEvent$getEventName() {\n      return this._eventName;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.EventContext\n\n  };\n\n  tab.EventContext = function tab_EventContext(workbookImpl, worksheetImpl) {\n    this._workbookImpl = workbookImpl;\n    this._worksheetImpl = worksheetImpl;\n  };\n\n  tab.EventContext.prototype = {\n    _workbookImpl: null,\n    _worksheetImpl: null,\n    get__workbookImpl: function tab_EventContext$get__workbookImpl() {\n      return this._workbookImpl;\n    },\n    get__worksheetImpl: function tab_EventContext$get__worksheetImpl() {\n      return this._worksheetImpl;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.TabSwitchEvent\n\n  };\n\n  tab.TabSwitchEvent = function tab_TabSwitchEvent(eventName, viz, oldName, newName) {\n    tab.TabSwitchEvent.initializeBase(this, [eventName, viz]);\n    this._oldName$1 = oldName;\n    this._newName$1 = newName;\n  };\n\n  tab.TabSwitchEvent.prototype = {\n    _oldName$1: null,\n    _newName$1: null,\n    getOldSheetName: function tab_TabSwitchEvent$getOldSheetName() {\n      return this._oldName$1;\n    },\n    getNewSheetName: function tab_TabSwitchEvent$getNewSheetName() {\n      return this._newName$1;\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Viz\n\n  };\n\n  tableauSoftware.Viz = function tableauSoftware_Viz(parentElement, url, options) {\n    var messageRouter = tab._ApiObjectRegistry.getCrossDomainMessageRouter();\n\n    this._impl = new tab.VizImpl(messageRouter, this, parentElement, url, options);\n\n    this._impl._create();\n  };\n\n  tableauSoftware.Viz.getLastRequestMessage = function tableauSoftware_Viz$getLastRequestMessage() {\n    return tab._ApiCommand.lastRequestMessage;\n  };\n\n  tableauSoftware.Viz.getLastResponseMessage = function tableauSoftware_Viz$getLastResponseMessage() {\n    return tab._ApiCommand.lastResponseMessage;\n  };\n\n  tableauSoftware.Viz.getLastClientInfoResponseMessage = function tableauSoftware_Viz$getLastClientInfoResponseMessage() {\n    return tab._ApiCommand.lastClientInfoResponseMessage;\n  };\n\n  tableauSoftware.Viz.prototype = {\n    _impl: null,\n    getAreTabsHidden: function tableauSoftware_Viz$getAreTabsHidden() {\n      return this._impl.get__areTabsHidden();\n    },\n    getIsToolbarHidden: function tableauSoftware_Viz$getIsToolbarHidden() {\n      return this._impl.get__isToolbarHidden();\n    },\n    getIsHidden: function tableauSoftware_Viz$getIsHidden() {\n      return this._impl.get__isHidden();\n    },\n    getInstanceId: function tableauSoftware_Viz$getInstanceId() {\n      return this._impl.get_instanceId();\n    },\n    getParentElement: function tableauSoftware_Viz$getParentElement() {\n      return this._impl.get__parentElement();\n    },\n    getUrl: function tableauSoftware_Viz$getUrl() {\n      return this._impl.get__url();\n    },\n    getVizSize: function tableauSoftware_Viz$getVizSize() {\n      return this._impl.get__vizSize();\n    },\n    getWorkbook: function tableauSoftware_Viz$getWorkbook() {\n      return this._impl.get__workbook();\n    },\n    getAreAutomaticUpdatesPaused: function tableauSoftware_Viz$getAreAutomaticUpdatesPaused() {\n      return this._impl.get__areAutomaticUpdatesPaused();\n    },\n    getCurrentUrlAsync: function tableauSoftware_Viz$getCurrentUrlAsync() {\n      return this._impl.getCurrentUrlAsync();\n    },\n    addEventListener: function tableauSoftware_Viz$addEventListener(eventName, handler) {\n      this._impl.addEventListener(eventName, handler);\n    },\n    removeEventListener: function tableauSoftware_Viz$removeEventListener(eventName, handler) {\n      this._impl.removeEventListener(eventName, handler);\n    },\n    dispose: function tableauSoftware_Viz$dispose() {\n      this._impl._dispose();\n    },\n    show: function tableauSoftware_Viz$show() {\n      this._impl._show();\n    },\n    hide: function tableauSoftware_Viz$hide() {\n      this._impl._hide();\n    },\n    showExportDataDialog: function tableauSoftware_Viz$showExportDataDialog(worksheetWithinDashboard) {\n      this._impl._showExportDataDialog(worksheetWithinDashboard);\n    },\n    showExportCrossTabDialog: function tableauSoftware_Viz$showExportCrossTabDialog(worksheetWithinDashboard) {\n      this._impl._showExportCrossTabDialog(worksheetWithinDashboard);\n    },\n    showExportImageDialog: function tableauSoftware_Viz$showExportImageDialog() {\n      this._impl._showExportImageDialog();\n    },\n    showExportPDFDialog: function tableauSoftware_Viz$showExportPDFDialog() {\n      this._impl._showExportPDFDialog();\n    },\n    revertAllAsync: function tableauSoftware_Viz$revertAllAsync() {\n      return this._impl._revertAllAsync();\n    },\n    refreshDataAsync: function tableauSoftware_Viz$refreshDataAsync() {\n      return this._impl._refreshDataAsync();\n    },\n    showShareDialog: function tableauSoftware_Viz$showShareDialog() {\n      this._impl._showShareDialog();\n    },\n    showDownloadWorkbookDialog: function tableauSoftware_Viz$showDownloadWorkbookDialog() {\n      this._impl._showDownloadWorkbookDialog();\n    },\n    pauseAutomaticUpdatesAsync: function tableauSoftware_Viz$pauseAutomaticUpdatesAsync() {\n      return this._impl._pauseAutomaticUpdatesAsync();\n    },\n    resumeAutomaticUpdatesAsync: function tableauSoftware_Viz$resumeAutomaticUpdatesAsync() {\n      return this._impl._resumeAutomaticUpdatesAsync();\n    },\n    toggleAutomaticUpdatesAsync: function tableauSoftware_Viz$toggleAutomaticUpdatesAsync() {\n      return this._impl._toggleAutomaticUpdatesAsync();\n    },\n    refreshSize: function tableauSoftware_Viz$refreshSize() {\n      this._impl._refreshSize();\n    },\n    setFrameSize: function tableauSoftware_Viz$setFrameSize(width, height) {\n      var widthString = width;\n      var heightString = height;\n\n      if (tab._Utility.isNumber(width)) {\n        widthString = width + 'px';\n      }\n\n      if (tab._Utility.isNumber(height)) {\n        heightString = height + 'px';\n      }\n\n      this._impl._setFrameSizeAndUpdate(widthString, heightString);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.VizManager\n\n  };\n\n  tableauSoftware.VizManager = function tableauSoftware_VizManager() {};\n\n  tableauSoftware.VizManager.getVizs = function tableauSoftware_VizManager$getVizs() {\n    return tab._VizManagerImpl.get__clonedVizs();\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // tableauSoftware.Workbook\n\n\n  tableauSoftware.Workbook = function tableauSoftware_Workbook(workbookImpl) {\n    this._workbookImpl = workbookImpl;\n  };\n\n  tableauSoftware.Workbook.prototype = {\n    _workbookImpl: null,\n    getViz: function tableauSoftware_Workbook$getViz() {\n      return this._workbookImpl.get_viz();\n    },\n    getPublishedSheetsInfo: function tableauSoftware_Workbook$getPublishedSheetsInfo() {\n      return this._workbookImpl.get_publishedSheets()._toApiCollection();\n    },\n    getName: function tableauSoftware_Workbook$getName() {\n      return this._workbookImpl.get_name();\n    },\n    getActiveSheet: function tableauSoftware_Workbook$getActiveSheet() {\n      return this._workbookImpl.get_activeSheetImpl().get_sheet();\n    },\n    getActiveCustomView: function tableauSoftware_Workbook$getActiveCustomView() {\n      return this._workbookImpl.get_activeCustomView();\n    },\n    activateSheetAsync: function tableauSoftware_Workbook$activateSheetAsync(sheetNameOrIndex) {\n      return this._workbookImpl._setActiveSheetAsync(sheetNameOrIndex);\n    },\n    revertAllAsync: function tableauSoftware_Workbook$revertAllAsync() {\n      return this._workbookImpl._revertAllAsync();\n    },\n    getCustomViewsAsync: function tableauSoftware_Workbook$getCustomViewsAsync() {\n      return this._workbookImpl._getCustomViewsAsync();\n    },\n    showCustomViewAsync: function tableauSoftware_Workbook$showCustomViewAsync(customViewName) {\n      return this._workbookImpl._showCustomViewAsync(customViewName);\n    },\n    removeCustomViewAsync: function tableauSoftware_Workbook$removeCustomViewAsync(customViewName) {\n      return this._workbookImpl._removeCustomViewAsync(customViewName);\n    },\n    rememberCustomViewAsync: function tableauSoftware_Workbook$rememberCustomViewAsync(customViewName) {\n      return this._workbookImpl._rememberCustomViewAsync(customViewName);\n    },\n    setActiveCustomViewAsDefaultAsync: function tableauSoftware_Workbook$setActiveCustomViewAsDefaultAsync() {\n      return this._workbookImpl._setActiveCustomViewAsDefaultAsync();\n    },\n    getParametersAsync: function tableauSoftware_Workbook$getParametersAsync() {\n      return this._workbookImpl._getParametersAsync();\n    },\n    changeParameterValueAsync: function tableauSoftware_Workbook$changeParameterValueAsync(parameterName, value) {\n      return this._workbookImpl._changeParameterValueAsync(parameterName, value);\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tableauSoftware.Worksheet\n\n  };\n\n  tableauSoftware.Worksheet = function tableauSoftware_Worksheet(impl) {\n    tableauSoftware.Worksheet.initializeBase(this, [impl]);\n  };\n\n  tableauSoftware.Worksheet.prototype = {\n    _impl: null,\n    getParentDashboard: function tableauSoftware_Worksheet$getParentDashboard() {\n      return this._impl.get_parentDashboard();\n    },\n    getParentStoryPoint: function tableauSoftware_Worksheet$getParentStoryPoint() {\n      return this._impl.get_parentStoryPoint();\n    },\n    getDataSourcesAsync: function tableauSoftware_Worksheet$getDataSourcesAsync() {\n      return this._impl._getDataSourcesAsync();\n    },\n    getFilterAsync: function tableauSoftware_Worksheet$getFilterAsync(fieldName, options) {\n      return this._impl._getFilterAsync(null, fieldName, options);\n    },\n    getFiltersAsync: function tableauSoftware_Worksheet$getFiltersAsync(options) {\n      return this._impl._getFiltersAsync(options);\n    },\n    applyFilterAsync: function tableauSoftware_Worksheet$applyFilterAsync(fieldName, values, updateType, options) {\n      return this._impl._applyFilterAsync(fieldName, values, updateType, options);\n    },\n    clearFilterAsync: function tableauSoftware_Worksheet$clearFilterAsync(fieldName) {\n      return this._impl._clearFilterAsync(fieldName);\n    },\n    applyRangeFilterAsync: function tableauSoftware_Worksheet$applyRangeFilterAsync(fieldName, options) {\n      return this._impl._applyRangeFilterAsync(fieldName, options);\n    },\n    applyRelativeDateFilterAsync: function tableauSoftware_Worksheet$applyRelativeDateFilterAsync(fieldName, options) {\n      return this._impl._applyRelativeDateFilterAsync(fieldName, options);\n    },\n    applyHierarchicalFilterAsync: function tableauSoftware_Worksheet$applyHierarchicalFilterAsync(fieldName, values, updateType, options) {\n      return this._impl._applyHierarchicalFilterAsync(fieldName, values, updateType, options);\n    },\n    clearSelectedMarksAsync: function tableauSoftware_Worksheet$clearSelectedMarksAsync() {\n      return this._impl._clearSelectedMarksAsync();\n    },\n    selectMarksAsync: function tableauSoftware_Worksheet$selectMarksAsync(fieldNameOrFieldValuesMap, valueOrUpdateType, updateType) {\n      return this._impl._selectMarksAsync(fieldNameOrFieldValuesMap, valueOrUpdateType, updateType);\n    },\n    getSelectedMarksAsync: function tableauSoftware_Worksheet$getSelectedMarksAsync() {\n      return this._impl._getSelectedMarksAsync();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab.WorksheetEvent\n\n  };\n\n  tab.WorksheetEvent = function tab_WorksheetEvent(eventName, viz, worksheetImpl) {\n    tab.WorksheetEvent.initializeBase(this, [eventName, viz]);\n    this._worksheetImpl$1 = worksheetImpl;\n  };\n\n  tab.WorksheetEvent.prototype = {\n    _worksheetImpl$1: null,\n    getWorksheet: function tab_WorksheetEvent$getWorksheet() {\n      return this._worksheetImpl$1.get_worksheet();\n    } ////////////////////////////////////////////////////////////////////////////////\n    // tab._jQueryShim\n\n  };\n\n  tab._jQueryShim = function tab__jQueryShim() {};\n\n  tab._jQueryShim.isFunction = function tab__jQueryShim$isFunction(obj) {\n    return tab._jQueryShim.type(obj) === 'function';\n  };\n\n  tab._jQueryShim.isArray = function tab__jQueryShim$isArray(obj) {\n    if (ss.isValue(Array.isArray)) {\n      return Array.isArray(obj);\n    }\n\n    return tab._jQueryShim.type(obj) === 'array';\n  };\n\n  tab._jQueryShim.type = function tab__jQueryShim$type(obj) {\n    return obj == null ? String(obj) : tab._jQueryShim._class2type[tab._jQueryShim._toString.call(obj)] || 'object';\n  };\n\n  tab._jQueryShim.trim = function tab__jQueryShim$trim(text) {\n    if (ss.isValue(tab._jQueryShim._trim)) {\n      return text == null ? '' : tab._jQueryShim._trim.call(text);\n    }\n\n    return text == null ? '' : text.replace(tab._jQueryShim._trimLeft, '').replace(tab._jQueryShim._trimRight, '');\n  };\n\n  tab._jQueryShim.parseJSON = function tab__jQueryShim$parseJSON(data) {\n    if (typeof data !== 'string' || ss.isNullOrUndefined(data)) {\n      return null;\n    }\n\n    data = tab._jQueryShim.trim(data);\n\n    if (window.JSON && window.JSON.parse) {\n      return window.JSON.parse(data);\n    }\n\n    if (tab._jQueryShim._rvalidchars.test(data.replace(tab._jQueryShim._rvalidescape, '@').replace(tab._jQueryShim._rvalidtokens, ']').replace(tab._jQueryShim._rvalidbraces, ''))) {\n      return new Function(\"return \" + data)();\n    }\n\n    throw new Error('Invalid JSON: ' + data);\n  };\n\n  tab._ApiCommand.registerClass('tab._ApiCommand');\n\n  tab._ApiServerResultParser.registerClass('tab._ApiServerResultParser');\n\n  tab._ApiServerNotification.registerClass('tab._ApiServerNotification');\n\n  tab._CommandReturnHandler.registerClass('tab._CommandReturnHandler');\n\n  tab._crossDomainMessageRouter.registerClass('tab._crossDomainMessageRouter', null, tab.ICrossDomainMessageRouter);\n\n  tab._doNothingCrossDomainHandler.registerClass('tab._doNothingCrossDomainHandler', null, tab.ICrossDomainMessageHandler);\n\n  tab.CrossDomainMessagingOptions.registerClass('tab.CrossDomainMessagingOptions');\n\n  tab._enums.registerClass('tab._enums');\n\n  tab._ApiBootstrap.registerClass('tab._ApiBootstrap');\n\n  tab._ApiObjectRegistry.registerClass('tab._ApiObjectRegistry');\n\n  tab._CustomViewImpl.registerClass('tab._CustomViewImpl');\n\n  tab._SheetImpl.registerClass('tab._SheetImpl');\n\n  tab._DashboardImpl.registerClass('tab._DashboardImpl', tab._SheetImpl);\n\n  tab._DataSourceImpl.registerClass('tab._DataSourceImpl');\n\n  tab._deferredUtil.registerClass('tab._deferredUtil');\n\n  tab._CollectionImpl.registerClass('tab._CollectionImpl');\n\n  tab._DeferredImpl.registerClass('tab._DeferredImpl');\n\n  tab._PromiseImpl.registerClass('tab._PromiseImpl');\n\n  tab._markImpl.registerClass('tab._markImpl');\n\n  tab._Param.registerClass('tab._Param');\n\n  tab._parameterImpl.registerClass('tab._parameterImpl');\n\n  tab._StoryImpl.registerClass('tab._StoryImpl', tab._SheetImpl);\n\n  tab._StoryPointImpl.registerClass('tab._StoryPointImpl');\n\n  tab.StoryPointInfoImplUtil.registerClass('tab.StoryPointInfoImplUtil');\n\n  tab._TableauException.registerClass('tab._TableauException');\n\n  tab._Utility.registerClass('tab._Utility');\n\n  tab.VizImpl.registerClass('tab.VizImpl', null, tab.ICrossDomainMessageHandler);\n\n  tab._VizManagerImpl.registerClass('tab._VizManagerImpl');\n\n  tab._VizParameters.registerClass('tab._VizParameters');\n\n  tab._WorkbookImpl.registerClass('tab._WorkbookImpl');\n\n  tab._WorksheetImpl.registerClass('tab._WorksheetImpl', tab._SheetImpl);\n\n  tab.JsonUtil.registerClass('tab.JsonUtil');\n  tableauSoftware.CustomView.registerClass('tableauSoftware.CustomView');\n  tab.TableauEvent.registerClass('tab.TableauEvent');\n  tab.CustomViewEvent.registerClass('tab.CustomViewEvent', tab.TableauEvent);\n  tab.EventContext.registerClass('tab.EventContext');\n\n  tab._customViewEventContext.registerClass('tab._customViewEventContext', tab.EventContext);\n\n  tableauSoftware.Sheet.registerClass('tableauSoftware.Sheet');\n  tableauSoftware.Dashboard.registerClass('tableauSoftware.Dashboard', tableauSoftware.Sheet);\n  tableauSoftware.DashboardObject.registerClass('tableauSoftware.DashboardObject');\n  tableauSoftware.DataSource.registerClass('tableauSoftware.DataSource');\n  tableauSoftware.Field.registerClass('tableauSoftware.Field');\n  tableauSoftware.Filter.registerClass('tableauSoftware.Filter');\n  tableauSoftware.CategoricalFilter.registerClass('tableauSoftware.CategoricalFilter', tableauSoftware.Filter);\n  tab.WorksheetEvent.registerClass('tab.WorksheetEvent', tab.TableauEvent);\n  tab.FilterEvent.registerClass('tab.FilterEvent', tab.WorksheetEvent);\n\n  tab._filterEventContext.registerClass('tab._filterEventContext', tab.EventContext);\n\n  tableauSoftware.HierarchicalFilter.registerClass('tableauSoftware.HierarchicalFilter', tableauSoftware.Filter);\n  tableauSoftware.QuantitativeFilter.registerClass('tableauSoftware.QuantitativeFilter', tableauSoftware.Filter);\n  tableauSoftware.RelativeDateFilter.registerClass('tableauSoftware.RelativeDateFilter', tableauSoftware.Filter);\n  tab.FirstVizSizeKnownEvent.registerClass('tab.FirstVizSizeKnownEvent', tab.TableauEvent);\n  tableauSoftware.Version.registerClass('tableauSoftware.Version');\n  tab.VizResizeEvent.registerClass('tab.VizResizeEvent', tab.TableauEvent);\n  tableauSoftware.Mark.registerClass('tableauSoftware.Mark');\n  tab.MarksEvent.registerClass('tab.MarksEvent', tab.WorksheetEvent);\n\n  tab._marksEventContext.registerClass('tab._marksEventContext', tab.EventContext);\n\n  tableauSoftware.Pair.registerClass('tableauSoftware.Pair');\n  tableauSoftware.Parameter.registerClass('tableauSoftware.Parameter');\n  tab.ParameterEvent.registerClass('tab.ParameterEvent', tab.TableauEvent);\n\n  tab._parameterEventContext.registerClass('tab._parameterEventContext', tab.EventContext);\n\n  tableauSoftware.SheetInfo.registerClass('tableauSoftware.SheetInfo');\n  tab.SheetSizeFactory.registerClass('tab.SheetSizeFactory');\n  tableauSoftware.Story.registerClass('tableauSoftware.Story', tableauSoftware.Sheet);\n  tableauSoftware.StoryPoint.registerClass('tableauSoftware.StoryPoint');\n  tableauSoftware.StoryPointInfo.registerClass('tableauSoftware.StoryPointInfo');\n  tab.StoryPointSwitchEvent.registerClass('tab.StoryPointSwitchEvent', tab.TableauEvent);\n  tab.TabSwitchEvent.registerClass('tab.TabSwitchEvent', tab.TableauEvent);\n  tableauSoftware.Viz.registerClass('tableauSoftware.Viz');\n  tableauSoftware.VizManager.registerClass('tableauSoftware.VizManager');\n  tableauSoftware.Workbook.registerClass('tableauSoftware.Workbook');\n  tableauSoftware.Worksheet.registerClass('tableauSoftware.Worksheet', tableauSoftware.Sheet);\n\n  tab._jQueryShim.registerClass('tab._jQueryShim');\n\n  tab._ApiCommand.crossDomainEventNotificationId = 'xdomainSourceId';\n  tab._ApiCommand.lastRequestMessage = null;\n  tab._ApiCommand.lastResponseMessage = null;\n  tab._ApiCommand.lastClientInfoResponseMessage = null;\n  tab._ApiObjectRegistry._creationRegistry = null;\n  tab._ApiObjectRegistry._singletonInstanceRegistry = null;\n  tab._SheetImpl.noZoneId = 4294967295;\n  tab._VizManagerImpl._vizs = [];\n  tab._WorksheetImpl._regexHierarchicalFieldName$1 = new RegExp('\\\\[[^\\\\]]+\\\\]\\\\.', 'g');\n  tableauSoftware.Version._currentVersion = new tableauSoftware.Version(2, 0, 0, null);\n  tab._jQueryShim._class2type = {\n    '[object Boolean]': 'boolean',\n    '[object Number]': 'number',\n    '[object String]': 'string',\n    '[object Function]': 'function',\n    '[object Array]': 'array',\n    '[object Date]': 'date',\n    '[object RegExp]': 'regexp',\n    '[object Object]': 'object'\n  };\n  tab._jQueryShim._trim = String.prototype.trim;\n  tab._jQueryShim._toString = Object.prototype.toString;\n  tab._jQueryShim._trimLeft = new RegExp('^[\\\\s\\\\xA0]+');\n  tab._jQueryShim._trimRight = new RegExp('[\\\\s\\\\xA0]+$');\n  tab._jQueryShim._rvalidchars = new RegExp('^[\\\\],:{}\\\\s]*$');\n  tab._jQueryShim._rvalidescape = new RegExp('\\\\\\\\(?:[\"\\\\\\\\\\\\/bfnrt]|u[0-9a-fA-F]{4})', 'g');\n  tab._jQueryShim._rvalidtokens = new RegExp('\"[^\"\\\\\\\\\\\\n\\\\r]*\"|true|false|null|-?\\\\d+(?:\\\\.\\\\d*)?(?:[eE][+\\\\-]?\\\\d+)?', 'g');\n  tab._jQueryShim._rvalidbraces = new RegExp('(?:^|:|,)(?:\\\\s*\\\\[)+', 'g');\n  tableauSoftware.Promise = tab._PromiseImpl;\n  tab._Deferred = tab._DeferredImpl;\n  tab._Collection = tab._CollectionImpl; ////////////////////////////////////////////////////////////////////////////////\n  // Enums\n  ////////////////////////////////////////////////////////////////////////////////\n\n  tableauSoftware.DashboardObjectType = {\n    BLANK: 'blank',\n    WORKSHEET: 'worksheet',\n    QUICK_FILTER: 'quickFilter',\n    PARAMETER_CONTROL: 'parameterControl',\n    PAGE_FILTER: 'pageFilter',\n    LEGEND: 'legend',\n    TITLE: 'title',\n    TEXT: 'text',\n    IMAGE: 'image',\n    WEB_PAGE: 'webPage'\n  };\n  tableauSoftware.FilterType = {\n    CATEGORICAL: 'categorical',\n    QUANTITATIVE: 'quantitative',\n    HIERARCHICAL: 'hierarchical',\n    RELATIVEDATE: 'relativedate'\n  };\n  tableauSoftware.ParameterDataType = {\n    FLOAT: 'float',\n    INTEGER: 'integer',\n    STRING: 'string',\n    BOOLEAN: 'boolean',\n    DATE: 'date',\n    DATETIME: 'datetime'\n  };\n  tableauSoftware.ParameterAllowableValuesType = {\n    ALL: 'all',\n    LIST: 'list',\n    RANGE: 'range'\n  };\n  tableauSoftware.PeriodType = {\n    YEAR: 'year',\n    QUARTER: 'quarter',\n    MONTH: 'month',\n    WEEK: 'week',\n    DAY: 'day',\n    HOUR: 'hour',\n    MINUTE: 'minute',\n    SECOND: 'second'\n  };\n  tableauSoftware.DateRangeType = {\n    LAST: 'last',\n    LASTN: 'lastn',\n    NEXT: 'next',\n    NEXTN: 'nextn',\n    CURR: 'curr',\n    TODATE: 'todate'\n  };\n  tableauSoftware.SheetSizeBehavior = {\n    AUTOMATIC: 'automatic',\n    EXACTLY: 'exactly',\n    RANGE: 'range',\n    ATLEAST: 'atleast',\n    ATMOST: 'atmost'\n  };\n  tableauSoftware.SheetType = {\n    WORKSHEET: 'worksheet',\n    DASHBOARD: 'dashboard',\n    STORY: 'story'\n  };\n  tableauSoftware.FilterUpdateType = {\n    ALL: 'all',\n    REPLACE: 'replace',\n    ADD: 'add',\n    REMOVE: 'remove'\n  };\n  tableauSoftware.SelectionUpdateType = {\n    REPLACE: 'replace',\n    ADD: 'add',\n    REMOVE: 'remove'\n  };\n  tableauSoftware.NullOption = {\n    NULL_VALUES: 'nullValues',\n    NON_NULL_VALUES: 'nonNullValues',\n    ALL_VALUES: 'allValues'\n  };\n  tableauSoftware.ErrorCode = {\n    INTERNAL_ERROR: 'internalError',\n    SERVER_ERROR: 'serverError',\n    INVALID_AGGREGATION_FIELD_NAME: 'invalidAggregationFieldName',\n    INVALID_PARAMETER: 'invalidParameter',\n    INVALID_URL: 'invalidUrl',\n    STALE_DATA_REFERENCE: 'staleDataReference',\n    VIZ_ALREADY_IN_MANAGER: 'vizAlreadyInManager',\n    NO_URL_OR_PARENT_ELEMENT_NOT_FOUND: 'noUrlOrParentElementNotFound',\n    INVALID_FILTER_FIELDNAME: 'invalidFilterFieldName',\n    INVALID_FILTER_FIELDVALUE: 'invalidFilterFieldValue',\n    INVALID_FILTER_FIELDNAME_OR_VALUE: 'invalidFilterFieldNameOrValue',\n    FILTER_CANNOT_BE_PERFORMED: 'filterCannotBePerformed',\n    NOT_ACTIVE_SHEET: 'notActiveSheet',\n    INVALID_CUSTOM_VIEW_NAME: 'invalidCustomViewName',\n    MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS: 'missingRangeNForRelativeDateFilters',\n    MISSING_MAX_SIZE: 'missingMaxSize',\n    MISSING_MIN_SIZE: 'missingMinSize',\n    MISSING_MINMAX_SIZE: 'missingMinMaxSize',\n    INVALID_SIZE: 'invalidSize',\n    INVALID_SIZE_BEHAVIOR_ON_WORKSHEET: 'invalidSizeBehaviorOnWorksheet',\n    SHEET_NOT_IN_WORKBOOK: 'sheetNotInWorkbook',\n    INDEX_OUT_OF_RANGE: 'indexOutOfRange',\n    DOWNLOAD_WORKBOOK_NOT_ALLOWED: 'downloadWorkbookNotAllowed',\n    NULL_OR_EMPTY_PARAMETER: 'nullOrEmptyParameter',\n    BROWSER_NOT_CAPABLE: 'browserNotCapable',\n    UNSUPPORTED_EVENT_NAME: 'unsupportedEventName',\n    INVALID_DATE_PARAMETER: 'invalidDateParameter',\n    INVALID_SELECTION_FIELDNAME: 'invalidSelectionFieldName',\n    INVALID_SELECTION_VALUE: 'invalidSelectionValue',\n    INVALID_SELECTION_DATE: 'invalidSelectionDate',\n    NO_URL_FOR_HIDDEN_WORKSHEET: 'noUrlForHiddenWorksheet',\n    MAX_VIZ_RESIZE_ATTEMPTS: 'maxVizResizeAttempts'\n  };\n  tableauSoftware.TableauEventName = {\n    CUSTOM_VIEW_LOAD: 'customviewload',\n    CUSTOM_VIEW_REMOVE: 'customviewremove',\n    CUSTOM_VIEW_SAVE: 'customviewsave',\n    CUSTOM_VIEW_SET_DEFAULT: 'customviewsetdefault',\n    FILTER_CHANGE: 'filterchange',\n    FIRST_INTERACTIVE: 'firstinteractive',\n    FIRST_VIZ_SIZE_KNOWN: 'firstvizsizeknown',\n    MARKS_SELECTION: 'marksselection',\n    PARAMETER_VALUE_CHANGE: 'parametervaluechange',\n    STORY_POINT_SWITCH: 'storypointswitch',\n    TAB_SWITCH: 'tabswitch',\n    VIZ_RESIZE: 'vizresize'\n  };\n  tableauSoftware.FieldRoleType = {\n    DIMENSION: 'dimension',\n    MEASURE: 'measure',\n    UNKNOWN: 'unknown'\n  };\n  tableauSoftware.FieldAggregationType = {\n    SUM: 'SUM',\n    AVG: 'AVG',\n    MIN: 'MIN',\n    MAX: 'MAX',\n    STDEV: 'STDEV',\n    STDEVP: 'STDEVP',\n    VAR: 'VAR',\n    VARP: 'VARP',\n    COUNT: 'COUNT',\n    COUNTD: 'COUNTD',\n    MEDIAN: 'MEDIAN',\n    ATTR: 'ATTR',\n    NONE: 'NONE',\n    PERCENTILE: 'PERCENTILE',\n    YEAR: 'YEAR',\n    QTR: 'QTR',\n    MONTH: 'MONTH',\n    DAY: 'DAY',\n    HOUR: 'HOUR',\n    MINUTE: 'MINUTE',\n    SECOND: 'SECOND',\n    WEEK: 'WEEK',\n    WEEKDAY: 'WEEKDAY',\n    MONTHYEAR: 'MONTHYEAR',\n    MDY: 'MDY',\n    END: 'END',\n    TRUNC_YEAR: 'TRUNC_YEAR',\n    TRUNC_QTR: 'TRUNC_QTR',\n    TRUNC_MONTH: 'TRUNC_MONTH',\n    TRUNC_WEEK: 'TRUNC_WEEK',\n    TRUNC_DAY: 'TRUNC_DAY',\n    TRUNC_HOUR: 'TRUNC_HOUR',\n    TRUNC_MINUTE: 'TRUNC_MINUTE',\n    TRUNC_SECOND: 'TRUNC_SECOND',\n    QUART1: 'QUART1',\n    QUART3: 'QUART3',\n    SKEWNESS: 'SKEWNESS',\n    KURTOSIS: 'KURTOSIS',\n    INOUT: 'INOUT',\n    SUM_XSQR: 'SUM_XSQR',\n    USER: 'USER'\n  };\n  tableauSoftware.ToolbarPosition = {\n    TOP: 'top',\n    BOTTOM: 'bottom'\n  }; ////////////////////////////////////////////////////////////////////////////////\n  // API Initialization\n  ////////////////////////////////////////////////////////////////////////////////\n  // Clean up the mscorlib stuff.\n\n  restoreTypeSystem();\n\n  tab._ApiBootstrap.initialize();\n})();\n\nmodule.exports = tableauSoftware;","map":null,"metadata":{},"sourceType":"script"}